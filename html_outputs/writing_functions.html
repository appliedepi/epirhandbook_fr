<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>45 Fonctions d’écriture | The Epidemiologist R Handbook</title>

    <meta name="author" content="the handbook team" />
  
   <meta name="description" content="The Epi R Handbook est un manuel de référence sur l’utilisation de R en épidémiologie appliquée et santé publique." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="45 Fonctions d’écriture | The Epidemiologist R Handbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Epi R Handbook est un manuel de référence sur l’utilisation de R en épidémiologie appliquée et santé publique." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="45 Fonctions d’écriture | The Epidemiologist R Handbook" />
  
  <meta name="twitter:description" content="The Epi R Handbook est un manuel de référence sur l’utilisation de R en épidémiologie appliquée et santé publique." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.27/datatables.js"></script>
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
    <link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="libs/selectize-0.12.0/selectize.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
    <script src="libs/tabwid-1.1.3/tabwid.js"></script>
    <link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-1.3.1/leaflet.js"></script>
    <link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4-2.6.2/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
    <script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
    <script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
    <script src="libs/viz-1.8.2/viz.js"></script>
    <link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding-1.0.9/grViz.js"></script>
    <script src="libs/d3-4.5.0/d3.min.js"></script>
    <script src="libs/sankey-1/sankey.js"></script>
    <script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
    <script src="libs/plotly-binding-4.10.1/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
    <link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
    <script src="libs/vis-9.1.0/vis-network.min.js"></script>
    <script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
    <link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script src="libs/plotly-basic-2.11.1/plotly-basic-2.11.1.min.js"></script>
    <script src="libs/plotly-cartesian-2.11.1/plotly-cartesian-2.11.1.min.js"></script>
    <script src="libs/proj4js-2.3.15/proj4.js"></script>
    <link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
    <script src="libs/highcharts-9.3.1/highcharts.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
    <script src="libs/highcharts-9.3.1/modules/stock.js"></script>
    <script src="libs/highcharts-9.3.1/modules/map.js"></script>
    <script src="libs/highcharts-9.3.1/modules/data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
    <script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
    <script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
    <script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
    <script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/organization.js"></script>
    <script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
    <script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
    <script src="libs/highcharts-9.3.1/modules/vector.js"></script>
    <script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
    <script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
    <script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/venn.js"></script>
    <script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
    <script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
    <script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
    <script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
    <script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
    <script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
    <script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
    <script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
    <script src="libs/highcharts-9.3.1/custom/reset.js"></script>
    <script src="libs/highcharts-9.3.1/modules/boost.js"></script>
    <script src="libs/highchart-binding-0.9.4/highchart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style_bs4.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="writing_functions" class="section level1" number="45">
<h1><span class="header-section-number">45</span> Fonctions d’écriture</h1>
<!-- ======================================================= -->
<div id="préparation-29" class="section level2" number="45.1">
<h2><span class="header-section-number">45.1</span> Préparation</h2>
<div id="load-packages" class="section level3 unnumbered">
<h3>Load packages</h3>
<p>Ce morceau de code montre le chargement des paquets nécessaires aux analyses. Dans ce manuel, nous mettons l’accent sur <code>p_load()</code> de <strong>pacman</strong>, qui installe le paquet si nécessaire <em>et</em> le charge pour l’utiliser. Vous pouvez aussi charger les paquets installés avec <code>library()</code> de <strong>base</strong> R. Voir la page sur [R basics] pour plus d’informations sur les paquets R.</p>
</div>
<div id="importer-des-données-11" class="section level3 unnumbered">
<h3>Importer des données</h3>
<p>Nous importons le jeu de données des cas d’une épidémie d’Ebola simulée. Si vous souhaitez télécharger les données pour les suivre pas à pas, consultez les instructions de la page <a href="download_book_data.html#download_book_data">Télécharger le manuel et les données</a>. Le jeu de données est importé à l’aide de la fonction <code>import()</code> du paquet <strong>rio</strong>. Voir la page <a href="import_export.html#import_export">Importer et exporter des données</a> pour les différentes manières d’importer des données.</p>
<p>Nous utiliserons également dans la dernière partie de cette page des données sur la grippe H7N9 de 2013.</p>
</div>
</div>
<div id="fonctions" class="section level2" number="45.2">
<h2><span class="header-section-number">45.2</span> Fonctions</h2>
<p>Les fonctions sont utiles en programmation car elles permettent de rendre les codes plus faciles à comprendre, plus courts et moins sujets aux erreurs (à condition qu’il n’y ait pas d’erreurs dans la fonction elle-même).</p>
<p>Si vous êtes arrivé jusqu’à ce manuel, cela signifie que vous avez rencontré d’innombrables fonctions, car en R, chaque opération est un appel de fonction.
<code>+, for, if, [, $, { â¦</code>. Par exemple, <code>x + y</code> est la même chose que <code>'+'(x, y)</code>.</p>
<p>R est l’un des langages qui offre le plus de possibilités de travailler avec des fonctions et qui donne suffisamment d’outils à l’utilisateur pour les écrire facilement. Nous ne devrions pas penser aux fonctions comme étant fixées au sommet ou à la fin de la chaîne de programmation, R offre la possibilité de les utiliser comme s’il s’agissait de vecteurs et même de les utiliser à l’intérieur d’autres fonctions, listes…</p>
<p>Il existe de nombreuses ressources très avancées sur la programmation fonctionnelle et nous ne donnerons ici qu’un aperçu pour vous aider à démarrer avec la programmation fonctionnelle avec de courts exemples pratiques. Nous vous encourageons ensuite à visiter les liens sur les références pour en savoir plus.</p>
</div>
<div id="pourquoi-utiliser-une-fonction" class="section level2" number="45.3">
<h2><span class="header-section-number">45.3</span> Pourquoi utiliser une fonction ?</h2>
<p>Avant de répondre à cette question, il est important de noter que vous avez déjà eu des conseils pour écrire vos toutes premières fonctions R dans la page sur [l’itération, les boucles et les listes] de ce manuel. En fait, l’utilisation de “if/else” et de boucles est souvent au cour de bon nombre de nos fonctions car elles permettent d’élargir l’application de notre code en autorisant des conditions multiples ou d’itérer des codes pour des tâches répétitives.</p>
<ul>
<li><p>Je répète plusieurs fois le même bloc de code pour l’appliquer à une variable ou à des données différentes ?</p></li>
<li><p>Si je m’en débarrasse, cela raccourcira-t-il considérablement mon code global et le rendra-t-il plus rapide ?</p></li>
<li><p>Est-il possible que le code que j’ai écrit soit réutilisé mais avec une valeur différente à plusieurs endroits du code ?</p></li>
</ul>
<p>Si la réponse à l’une des questions précédentes est “OUI”, alors vous avez probablement besoin d’écrire une fonction</p>
</div>
<div id="comment-r-construit-il-les-fonctions" class="section level2" number="45.4">
<h2><span class="header-section-number">45.4</span> Comment R construit-il les fonctions ?</h2>
<p>Les fonctions dans R ont trois composants principaux :</p>
<ul>
<li><p>le <code>formals()</code> qui est la liste d’arguments qui contrôle la façon dont nous pouvons appeler la fonction.</p></li>
<li><p>le <code>body()</code> qui est le code à l’intérieur de la fonction, c’est-à-dire entre les parenthèses ou à la suite des parenthèses, selon la façon dont on l’écrit.</p></li>
</ul>
<p>et,</p>
<ul>
<li>l’ <code>environnement()</code> qui aide à localiser les variables de la fonction et détermine comment la fonction trouve sa valeur.</li>
</ul>
<p>Une fois que vous avez créé votre fonction, vous pouvez vérifier chacun de ces composants en appelant la fonction associée.</p>
</div>
<div id="syntaxe-et-structure-de-base" class="section level2" number="45.5">
<h2><span class="header-section-number">45.5</span> Syntaxe et structure de base</h2>
<ul>
<li><p>Une fonction devra être nommée correctement afin que son travail soit facilement compréhensible dès que l’on lit son nom. En fait, c’est déjà le cas avec la majorité de l’architecture R de base. Des fonctions comme <code>mean()</code>, <code>print()</code>, <code>summary()</code> ont des noms qui sont très simples.</p></li>
<li><p>Une fonction a besoin d’arguments, comme les données sur lesquelles elle travaille et d’autres objets qui peuvent être des valeurs statiques, entre autres options.</p></li>
<li><p>Et enfin, une fonction donnera une sortie basée sur sa tâche principale et les arguments qui lui ont été donnés. Habituellement, nous utilisons les fonctions intégrées telles que <code>print()</code>, <code>return()</code>… pour produire la sortie. La sortie peut être une valeur logique, un nombre, un caractère, un cadre de données… en bref, tout type d’objet R.</p></li>
</ul>
<p>En gros, c’est la composition d’une fonction :</p>
<div class="sourceCode" id="cb1907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1907-1"><a href="writing_functions.html#cb1907-1" aria-hidden="true" tabindex="-1"></a>nom_fonction <span class="ot">&lt;-</span> <span class="cf">function</span>(argument_1, argument_2, argument_3){</span>
<span id="cb1907-2"><a href="writing_functions.html#cb1907-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1907-3"><a href="writing_functions.html#cb1907-3" aria-hidden="true" tabindex="-1"></a>           function_task</span>
<span id="cb1907-4"><a href="writing_functions.html#cb1907-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1907-5"><a href="writing_functions.html#cb1907-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">return</span>(output)</span>
<span id="cb1907-6"><a href="writing_functions.html#cb1907-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nous pouvons créer notre première fonction qui sera appelée `contain_covid19()``.</p>
<div class="sourceCode" id="cb1908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1908-1"><a href="writing_functions.html#cb1908-1" aria-hidden="true" tabindex="-1"></a>contain_covid19 <span class="ot">&lt;-</span> <span class="cf">function</span>(barrier_gest, wear_mask, get_vaccine){</span>
<span id="cb1908-2"><a href="writing_functions.html#cb1908-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1908-3"><a href="writing_functions.html#cb1908-3" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span>(barrier_gest <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> wear_mask <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> get_vaccine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> ) </span>
<span id="cb1908-4"><a href="writing_functions.html#cb1908-4" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb1908-5"><a href="writing_functions.html#cb1908-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">return</span>(<span class="st">&quot;success&quot;</span>)</span>
<span id="cb1908-6"><a href="writing_functions.html#cb1908-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1908-7"><a href="writing_functions.html#cb1908-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="st">&quot;please make sure all are yes, this pandemic has to end!&quot;</span>)</span>
<span id="cb1908-8"><a href="writing_functions.html#cb1908-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nous pouvons ensuite vérifier les composants de notre fonction nouvellement créée.</p>
<div class="sourceCode" id="cb1909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1909-1"><a href="writing_functions.html#cb1909-1" aria-hidden="true" tabindex="-1"></a><span class="fu">formals</span>(contain_covid19)</span></code></pre></div>
<pre><code>## $barrier_gest
## 
## 
## $wear_mask
## 
## 
## $get_vaccine</code></pre>
<div class="sourceCode" id="cb1911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1911-1"><a href="writing_functions.html#cb1911-1" aria-hidden="true" tabindex="-1"></a><span class="fu">body</span>(contain_covid19)</span></code></pre></div>
<pre><code>## {
##     if (barrier_gest == &quot;yes&quot; &amp; wear_mask == &quot;yes&quot; &amp; get_vaccine == 
##         &quot;yes&quot;) 
##         return(&quot;success&quot;)
##     else (&quot;please make sure all are yes, this pandemic has to end!&quot;)
## }</code></pre>
<div class="sourceCode" id="cb1913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1913-1"><a href="writing_functions.html#cb1913-1" aria-hidden="true" tabindex="-1"></a><span class="fu">environment</span>(contain_covid19)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Maintenant, nous allons tester notre fonction. Pour appeler notre fonction écrite, vous l’utilisez comme vous utilisez toutes les fonctions R, c’est-à-dire en écrivant le nom de la fonction et en ajoutant les arguments requis.</p>
<div class="sourceCode" id="cb1915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1915-1"><a href="writing_functions.html#cb1915-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="at">barrier_gest =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">wear_mask =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;success&quot;</code></pre>
<p>Par précaution, nous pouvons réécrire le nom de chaque argument. Mais sans les préciser, le code devrait fonctionner puisque R a en mémoire le positionnement de chaque argument. Ainsi, tant que vous mettez les valeurs des arguments dans le bon ordre, vous pouvez éviter d’écrire les noms des arguments lors de l’appel des fonctions.</p>
<div class="sourceCode" id="cb1917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1917-1"><a href="writing_functions.html#cb1917-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;success&quot;</code></pre>
<p>Voyons ensuite ce qui se passe si l’une des valeurs est <code>"no"</code> ou <strong>pas</strong> <code>"yes"</code>.</p>
<div class="sourceCode" id="cb1919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1919-1"><a href="writing_functions.html#cb1919-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="at">barrier_gest =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">wear_mask =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;please make sure all are yes, this pandemic has to end!&quot;</code></pre>
<p>Si nous fournissons un argument qui n’est pas reconnu, nous obtenons une erreur:</p>
<div class="sourceCode" id="cb1921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1921-1"><a href="writing_functions.html#cb1921-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="at">barrier_gest =</span> <span class="st">&quot;sometimes&quot;</span>, <span class="at">wear_mask =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<p>`Erreur dans contain_covid19(barrier_gest = “sometimes”, wear_mask = “yes”, :
Impossible de trouver la fonction “contain_covid19”``.</p>
<p><span style="color : black ;"><strong><em>NOTE:</em></strong> Certaines fonctions (la plupart du temps très courtes et simples) peuvent ne pas avoir besoin de nom et peuvent être utilisées directement sur une ligne de code ou à l’intérieur d’une autre fonction pour effectuer une tâche rapide. Elles sont appelées <strong>fonctions anonymes</strong> .</span></p>
<p>Par exemple ci-dessous est une première fonction anonyme qui ne garde que les variables de caractères le jeu de données.</p>
<div class="sourceCode" id="cb1922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1922-1"><a href="writing_functions.html#cb1922-1" aria-hidden="true" tabindex="-1"></a>linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1922-2"><a href="writing_functions.html#cb1922-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co">#équivalent à la fonction &quot;head&quot; de base de R et qui renvoie les n premières observations de l&#39;ensemble de données.</span></span>
<span id="cb1922-3"><a href="writing_functions.html#cb1922-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="cf">function</span>(x) <span class="fu">is.character</span>(x)) </span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c56831e76d4c2591758c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c56831e76d4c2591758c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca"],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death"],["m","f","m","f","m","f","f","f","m","f"],["years","years","years","years","years","years","years","years","years","years"],["Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital","Missing","Missing","Missing","Missing"],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null],["other",null,null,"other","other","other","other","other",null,null],["no",null,null,"no","no","no",null,"no","no","no"],["no",null,null,"no","no","no",null,"no","no","no"],["yes",null,null,"no","yes","yes",null,"yes","yes","yes"],["no",null,null,"no","no","no",null,"no","no","no"],["yes",null,null,"no","yes","yes",null,"yes","yes","no"],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age_unit<\/th>\n      <th>hospital<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>time_admission<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Ensuite, une autre fonction qui sélectionne une observation sur deux de notre ensemble de données (cela peut être utile lorsque nous avons des données longitudinales avec de nombreux enregistrements par patient, par exemple après avoir été classés par date ou par visite).
Dans ce cas, la fonction à écrire en dehors de dplyr serait <code>function (x) (x%%2 == 0)</code> pour s’appliquer au vecteur contenant tous les numéros de ligne.</p>
<div class="sourceCode" id="cb1923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1923-1"><a href="writing_functions.html#cb1923-1" aria-hidden="true" tabindex="-1"></a>linelist <span class="sc">%&gt;%</span>   </span>
<span id="cb1923-2"><a href="writing_functions.html#cb1923-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1923-3"><a href="writing_functions.html#cb1923-3" aria-hidden="true" tabindex="-1"></a>   tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> <span class="co"># ajoute les indices de chaque obs comme rownames pour voir clairement la sélection finale</span></span>
<span id="cb1923-4"><a href="writing_functions.html#cb1923-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-bc8951559f2c637814e6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bc8951559f2c637814e6">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3\" data-max=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399075200000\" data-max=\"1403049600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399939200000\" data-max=\"1403740800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400025600000\" data-max=\"1403913600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400371200000\" data-max=\"1405036800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-13.2572163655863\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48528034195779\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"84\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"11\" data-max=\"186\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"21\" data-max=\"23\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"71.8184429761563\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["2","4","6","8","10","12","14","16","18","20"],["8689b7","b8812a","be99c8","369449","1389ca","57a565","2eaa9a","c97dd9","3a7673","ddddee"],[4,3,3,4,4,4,5,9,8,6],[null,"2014-05-04","2014-05-03","2014-05-28",null,"2014-05-28","2014-06-07",null,null,"2014-06-18"],["2014-05-13","2014-05-18","2014-05-22","2014-06-02","2014-06-05","2014-06-13","2014-06-17","2014-06-19","2014-06-23","2014-06-26"],["2014-05-14","2014-05-20","2014-05-23","2014-06-03","2014-06-07","2014-06-15","2014-06-17","2014-06-19","2014-06-24","2014-06-28"],["2014-05-18",null,"2014-05-24","2014-06-07","2014-06-09",null,null,"2014-07-11","2014-06-25","2014-07-02"],["Recover",null,"Recover","Death","Death","Death","Recover","Recover",null,"Death"],["f","f","f","f","f","m","f","m","f","f"],[3,18,16,0,27,42,7,13,17,11],["years","years","years","years","years","years","years","years","years","years"],[3,18,16,0,27,42,7,13,17,11],["0-4","15-19","15-19","0-4","20-29","30-49","5-9","10-14","15-19","10-14"],["0-4","15-19","15-19","0-4","25-29","40-44","5-9","10-14","15-19","10-14"],["Missing","Port Hospital","Port Hospital","Missing","Missing","Military Hospital","Missing","Port Hospital","Port Hospital","Other"],[-13.2152339775486,-13.2363711169728,-13.222625321098,-13.2320975453153,-13.2572163655863,-13.253989309478,-13.209391925612,-13.2243437095992,-13.21422143145,-13.2535640411465],[8.45171855856465,8.4754761613651,8.46183062600728,8.46144367534271,8.47292327643506,8.45837125340844,8.47570184950483,8.47145134147474,8.48528034195779,8.45957352078114],[null,"f90f5f","aec8ec","133ee7",null,"133ee7","9f6884",null,null,"8e104d"],[null,"other","other","other",null,"other","other",null,null,"other"],[25,41,56,0,69,84,44,66,47,47],[59,135,116,11,174,186,90,152,137,131],[22,23,21,22,22,22,21,22,21,23],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","yes","yes","yes","yes","yes","yes","yes","yes"],[null,"no","no","no","no","no","no","yes","no","no"],[null,"no","yes","yes","no","no","no","no","no","no"],[36.9,36.8,37.6,37,35.9,36.9,37.1,37.3,38,36],["09:36","11:22","14:13","09:25","10:55","11:14","11:06","08:45","15:41","18:58"],[71.8184429761563,22.4965706447188,41.6171224732461,0,22.7903289734443,24.2802636142907,54.320987654321,28.5664819944598,25.0412914912888,27.3876813705495],[1,2,1,1,2,2,0,0,1,2]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>rowname<\/th>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,9,11,15,16,19,20,21,27,29,30]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Un code R de base possible pour la même tâche serait le suivant :</p>
<div class="sourceCode" id="cb1924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1924-1"><a href="writing_functions.html#cb1924-1" aria-hidden="true" tabindex="-1"></a>linelist_firstobs <span class="ot">&lt;-</span> <span class="fu">head</span>(linelist, <span class="dv">20</span>)</span>
<span id="cb1924-2"><a href="writing_functions.html#cb1924-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1924-3"><a href="writing_functions.html#cb1924-3" aria-hidden="true" tabindex="-1"></a>linelist_firstobs[base<span class="sc">::</span><span class="fu">Filter</span>(<span class="cf">function</span>(x) (x<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">seq</span>(<span class="fu">nrow</span>(linelist_firstobs))),]</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0313f81d10da21a1d994" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0313f81d10da21a1d994">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3\" data-max=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399075200000\" data-max=\"1403049600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399939200000\" data-max=\"1403740800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400025600000\" data-max=\"1403913600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1400371200000\" data-max=\"1405036800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-13.2572163655863\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48528034195779\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"84\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"11\" data-max=\"186\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"21\" data-max=\"23\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"71.8184429761563\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["8689b7","b8812a","be99c8","369449","1389ca","57a565","2eaa9a","c97dd9","3a7673","ddddee"],[4,3,3,4,4,4,5,9,8,6],[null,"2014-05-04","2014-05-03","2014-05-28",null,"2014-05-28","2014-06-07",null,null,"2014-06-18"],["2014-05-13","2014-05-18","2014-05-22","2014-06-02","2014-06-05","2014-06-13","2014-06-17","2014-06-19","2014-06-23","2014-06-26"],["2014-05-14","2014-05-20","2014-05-23","2014-06-03","2014-06-07","2014-06-15","2014-06-17","2014-06-19","2014-06-24","2014-06-28"],["2014-05-18",null,"2014-05-24","2014-06-07","2014-06-09",null,null,"2014-07-11","2014-06-25","2014-07-02"],["Recover",null,"Recover","Death","Death","Death","Recover","Recover",null,"Death"],["f","f","f","f","f","m","f","m","f","f"],[3,18,16,0,27,42,7,13,17,11],["years","years","years","years","years","years","years","years","years","years"],[3,18,16,0,27,42,7,13,17,11],["0-4","15-19","15-19","0-4","20-29","30-49","5-9","10-14","15-19","10-14"],["0-4","15-19","15-19","0-4","25-29","40-44","5-9","10-14","15-19","10-14"],["Missing","Port Hospital","Port Hospital","Missing","Missing","Military Hospital","Missing","Port Hospital","Port Hospital","Other"],[-13.2152339775486,-13.2363711169728,-13.222625321098,-13.2320975453153,-13.2572163655863,-13.253989309478,-13.209391925612,-13.2243437095992,-13.21422143145,-13.2535640411465],[8.45171855856465,8.4754761613651,8.46183062600728,8.46144367534271,8.47292327643506,8.45837125340844,8.47570184950483,8.47145134147474,8.48528034195779,8.45957352078114],[null,"f90f5f","aec8ec","133ee7",null,"133ee7","9f6884",null,null,"8e104d"],[null,"other","other","other",null,"other","other",null,null,"other"],[25,41,56,0,69,84,44,66,47,47],[59,135,116,11,174,186,90,152,137,131],[22,23,21,22,22,22,21,22,21,23],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","yes","yes","yes","yes","yes","yes","yes","yes"],[null,"no","no","no","no","no","no","yes","no","no"],[null,"no","yes","yes","no","no","no","no","no","no"],[36.9,36.8,37.6,37,35.9,36.9,37.1,37.3,38,36],["09:36","11:22","14:13","09:25","10:55","11:14","11:06","08:45","15:41","18:58"],[71.8184429761563,22.4965706447188,41.6171224732461,0,22.7903289734443,24.2802636142907,54.320987654321,28.5664819944598,25.0412914912888,27.3876813705495],[1,2,1,1,2,2,0,0,1,2]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p><span style="color : orange ;"><strong><em>CAUTION:</em></strong> S’il est vrai que l’utilisation de fonctions peut nous aider dans notre code, il peut néanmoins être long d’écrire certaines fonctions ou d’en corriger une si elle n’a pas été pensée en profondeur, écrite de manière adéquate et qu’elle renvoie des erreurs en conséquence. C’est pour cette raison qu’il est souvent recommandé d’écrire d’abord le code R, de s’assurer qu’il fait ce que nous voulons qu’il fasse, puis de le transformer en une fonction avec ses trois composants principaux tels que listés ci-dessus. </span></p>
</div>
<div id="exemples-2" class="section level2" number="45.6">
<h2><span class="header-section-number">45.6</span> Exemples</h2>
<div id="retourner-les-tableaux-de-proportion-pour-plusieurs-colonnes" class="section level3 unnumbered">
<h3>Retourner les tableaux de proportion pour plusieurs colonnes</h3>
<p>Oui, nous avons déjà de belles fonctions dans de nombreux paquets permettant de résumer des informations d’une manière très simple et agréable. Mais nous allons tout de même essayer de créer nos propres fonctions, lors de nos premiers pas dans l’écriture de fonctions.</p>
<p>Dans cet exemple, nous voulons montrer comment l’écriture d’une simple fonction vous évitera de copier-coller le même code plusieurs fois.</p>
<div class="sourceCode" id="cb1925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1925-1"><a href="writing_functions.html#cb1925-1" aria-hidden="true" tabindex="-1"></a>proptab_multiple <span class="ot">&lt;-</span> <span class="cf">function</span>(my_data, var_to_tab){</span>
<span id="cb1925-2"><a href="writing_functions.html#cb1925-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1925-3"><a href="writing_functions.html#cb1925-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#imprimez le nom de chaque variable d&#39;intérêt avant de faire la tabulation</span></span>
<span id="cb1925-4"><a href="writing_functions.html#cb1925-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(var_to_tab)</span>
<span id="cb1925-5"><a href="writing_functions.html#cb1925-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1925-6"><a href="writing_functions.html#cb1925-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(my_data,</span>
<span id="cb1925-7"><a href="writing_functions.html#cb1925-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rbind</span>( <span class="co">#liez les résultats des deux fonctions suivantes par ligne</span></span>
<span id="cb1925-8"><a href="writing_functions.html#cb1925-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">#tabuler la variable d&#39;intérêt: ne donne que des nombres</span></span>
<span id="cb1925-9"><a href="writing_functions.html#cb1925-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">table</span>(my_data[[var_to_tab]], <span class="at">useNA =</span> <span class="st">&quot;no&quot;</span>),</span>
<span id="cb1925-10"><a href="writing_functions.html#cb1925-10" aria-hidden="true" tabindex="-1"></a>          <span class="co">#calculer les proportions pour chaque variable d&#39;intérêt et arrondir la valeur à 2 décimales</span></span>
<span id="cb1925-11"><a href="writing_functions.html#cb1925-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(my_data[[var_to_tab]]))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb1925-12"><a href="writing_functions.html#cb1925-12" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb1925-13"><a href="writing_functions.html#cb1925-13" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb1925-14"><a href="writing_functions.html#cb1925-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1925-15"><a href="writing_functions.html#cb1925-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1925-16"><a href="writing_functions.html#cb1925-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1925-17"><a href="writing_functions.html#cb1925-17" aria-hidden="true" tabindex="-1"></a><span class="fu">proptab_multiple</span>(linelist, <span class="st">&quot;gender&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;gender&quot;</code></pre>
<pre><code>##            f       m
## [1,] 2807.00 2803.00
## [2,]   50.04   49.96</code></pre>
<div class="sourceCode" id="cb1928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1928-1"><a href="writing_functions.html#cb1928-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proptab_multiple</span>(linelist, <span class="st">&quot;age_cat&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;age_cat&quot;</code></pre>
<pre><code>##          0-4     5-9  10-14  15-19   20-29 30-49 50-69 70+
## [1,] 1095.00 1095.00 941.00 743.00 1073.00   754 95.00 6.0
## [2,]   18.87   18.87  16.22  12.81   18.49    13  1.64 0.1</code></pre>
<div class="sourceCode" id="cb1931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1931-1"><a href="writing_functions.html#cb1931-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proptab_multiple</span>(linelist, <span class="st">&quot;outcome&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;outcome&quot;</code></pre>
<pre><code>##        Death Recover
## [1,] 2582.00 1983.00
## [2,]   56.56   43.44</code></pre>
<p><span style="color : darkgreen ;"><strong><em>TIP:</em></strong> Comme indiqué ci-dessus, il est très important de commenter vos fonctions comme vous le feriez pour la programmation générale. Gardez à l’esprit que le but d’une fonction est de rendre un code facile à lire, plus court et plus efficace. Alors on devrait être capable de comprendre ce que fait la fonction juste en lisant son nom et avoir plus de détails en lisant les commentaires.</span></p>
<p>Une deuxième option est d’utiliser cette fonction dans une autre via une boucle pour faire le processus en une fois :</p>
<div class="sourceCode" id="cb1934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1934-1"><a href="writing_functions.html#cb1934-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var_to_tab <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age_cat&quot;</span>, <span class="st">&quot;outcome&quot;</span>)){</span>
<span id="cb1934-2"><a href="writing_functions.html#cb1934-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1934-3"><a href="writing_functions.html#cb1934-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">proptab_multiple</span>(linelist, var_to_tab))</span>
<span id="cb1934-4"><a href="writing_functions.html#cb1934-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1934-5"><a href="writing_functions.html#cb1934-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;gender&quot;
##            f       m
## [1,] 2807.00 2803.00
## [2,]   50.04   49.96
## [1] &quot;age_cat&quot;
##          0-4     5-9  10-14  15-19   20-29 30-49 50-69 70+
## [1,] 1095.00 1095.00 941.00 743.00 1073.00   754 95.00 6.0
## [2,]   18.87   18.87  16.22  12.81   18.49    13  1.64 0.1
## [1] &quot;outcome&quot;
##        Death Recover
## [1,] 2582.00 1983.00
## [2,]   56.56   43.44</code></pre>
<p>Une manière plus simple serait d’utiliser la base R “appliquer” au lieu d’une “boucle for” comme exprimé ci-dessous :</p>
<p><span style="color : darkgreen ;"><strong><em>TIP:</em></strong> R est souvent défini comme un langage de programmation fonctionnel et presque chaque fois que vous exécutez une ligne de code, vous utilisez certaines fonctions intégrées. Une bonne habitude pour être plus à l’aise avec l’écriture de fonctions est d’avoir souvent un regard interne sur la façon dont les fonctions de base que vous utilisez quotidiennement sont construites. Le raccourci pour le faire est de sélectionner le nom de la fonction puis de cliquer sur <code>Ctrl+F2</code> ou <code>fn+F2</code> ou <code>Cmd+F2</code> (selon votre ordinateur) .</span></p>
</div>
<div id="utilisation-de-purrr-écrire-des-fonctions-qui-peuvent-être-appliquées-de-manière-itérative." class="section level3" number="45.6.1">
<h3><span class="header-section-number">45.6.1</span> Utilisation de <strong>purrr</strong> : écrire des fonctions qui peuvent être appliquées de manière itérative.</h3>
</div>
<div id="modifier-la-classe-de-plusieurs-colonnes-dans-un-ensemble-de-données" class="section level3 unnumbered">
<h3>Modifier la classe de plusieurs colonnes dans un ensemble de données</h3>
<p>Disons que de nombreuses variables de caractère dans les données originales <code>linelist</code> doivent être changées en “factor” pour des raisons d’analyse et de traçage. Au lieu de répéter l’étape plusieurs fois, nous pouvons juste utiliser <code>lapply()</code> pour faire la transformation de toutes les variables concernées sur une seule ligne de code.</p>
<p><span style="color : orange ;"><strong><em>CAUTION:</em></strong> <code>lapply()</code> renvoie une liste, donc son utilisation peut nécessiter une modification supplémentaire en dernière étape.</span></p>
<p>La même étape peut être effectuée en utilisant la fonction <code>map_if()</code> du paquet <strong>purrr</strong>.</p>
<div class="sourceCode" id="cb1936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1936-1"><a href="writing_functions.html#cb1936-1" aria-hidden="true" tabindex="-1"></a>linelist_factor2 <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span></span>
<span id="cb1936-2"><a href="writing_functions.html#cb1936-2" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_if</span>(is.character, as.factor)</span>
<span id="cb1936-3"><a href="writing_functions.html#cb1936-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1936-4"><a href="writing_functions.html#cb1936-4" aria-hidden="true" tabindex="-1"></a>linelist_factor2 <span class="sc">%&gt;%</span></span>
<span id="cb1936-5"><a href="writing_functions.html#cb1936-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## List of 30
##  $ case_id             : Factor w/ 5888 levels &quot;00031d&quot;,&quot;00086d&quot;,..: 2134 3022 396 4203 3084 4347 179 1241 5594 430 ...
##  $ generation          : num [1:5888] 4 4 2 3 3 3 4 4 4 4 ...
##  $ date_infection      : Date[1:5888], format: &quot;2014-05-08&quot; NA NA &quot;2014-05-04&quot; ...
##  $ date_onset          : Date[1:5888], format: &quot;2014-05-13&quot; &quot;2014-05-13&quot; &quot;2014-05-16&quot; &quot;2014-05-18&quot; ...
##  $ date_hospitalisation: Date[1:5888], format: &quot;2014-05-15&quot; &quot;2014-05-14&quot; &quot;2014-05-18&quot; &quot;2014-05-20&quot; ...
##  $ date_outcome        : Date[1:5888], format: NA &quot;2014-05-18&quot; &quot;2014-05-30&quot; NA ...
##  $ outcome             : Factor w/ 2 levels &quot;Death&quot;,&quot;Recover&quot;: NA 2 2 NA 2 2 2 1 2 1 ...
##  $ gender              : Factor w/ 2 levels &quot;f&quot;,&quot;m&quot;: 2 1 2 1 2 1 1 1 2 1 ...
##  $ age                 : num [1:5888] 2 3 56 18 3 16 16 0 61 27 ...
##  $ age_unit            : Factor w/ 2 levels &quot;months&quot;,&quot;years&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ age_years           : num [1:5888] 2 3 56 18 3 16 16 0 61 27 ...
##  $ age_cat             : Factor w/ 8 levels &quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,..: 1 1 7 4 1 4 4 1 7 5 ...
##  $ age_cat5            : Factor w/ 18 levels &quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,..: 1 1 12 4 1 4 4 1 13 6 ...
##  $ hospital            : Factor w/ 6 levels &quot;Central Hospital&quot;,..: 4 3 6 5 2 5 3 3 3 3 ...
##  $ lon                 : num [1:5888] -13.2 -13.2 -13.2 -13.2 -13.2 ...
##  $ lat                 : num [1:5888] 8.47 8.45 8.46 8.48 8.46 ...
##  $ infector            : Factor w/ 2697 levels &quot;00031d&quot;,&quot;002e6c&quot;,..: 2594 NA NA 2635 180 1799 1407 195 NA NA ...
##  $ source              : Factor w/ 2 levels &quot;funeral&quot;,&quot;other&quot;: 2 NA NA 2 2 2 2 2 NA NA ...
##  $ wt_kg               : num [1:5888] 27 25 91 41 36 56 47 0 86 69 ...
##  $ ht_cm               : num [1:5888] 48 59 238 135 71 116 87 11 226 174 ...
##  $ ct_blood            : num [1:5888] 22 22 21 23 23 21 21 22 22 22 ...
##  $ fever               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 NA NA 1 1 1 NA 1 1 1 ...
##  $ chills              : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 NA NA 1 1 1 NA 1 1 1 ...
##  $ cough               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 NA NA 1 2 2 NA 2 2 2 ...
##  $ aches               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 NA NA 1 1 1 NA 1 1 1 ...
##  $ vomit               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 NA NA 1 2 2 NA 2 2 1 ...
##  $ temp                : num [1:5888] 36.8 36.9 36.9 36.8 36.9 37.6 37.3 37 36.4 35.9 ...
##  $ time_admission      : Factor w/ 1072 levels &quot;00:10&quot;,&quot;00:29&quot;,..: NA 308 746 415 514 589 609 297 409 387 ...
##  $ bmi                 : num [1:5888] 117.2 71.8 16.1 22.5 71.4 ...
##  $ days_onset_hosp     : num [1:5888] 2 1 2 2 1 1 2 1 1 2 ...</code></pre>
</div>
<div id="produire-itérativement-des-graphiques-pour-différents-niveaux-dune-variable" class="section level3 unnumbered">
<h3>Produire itérativement des graphiques pour différents niveaux d’une variable</h3>
<p>Nous allons produire ici un graphique circulaire pour examiner la distribution des résultats des patients en Chine pendant l’épidémie de H7N9 pour chaque province. Au lieu de répéter le code pour chacun d’entre eux, nous allons simplement appliquer une fonction que nous allons créer.</p>
<div class="sourceCode" id="cb1938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1938-1"><a href="writing_functions.html#cb1938-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Préciser les options pour l&#39;utilisation de highchart</span></span>
<span id="cb1938-2"><a href="writing_functions.html#cb1938-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">highcharter.theme =</span>  highcharter<span class="sc">::</span><span class="fu">hc_theme_smpl</span>(<span class="at">tooltip =</span> <span class="fu">list</span>(<span class="at">valueDecimals =</span> <span class="dv">2</span>)))</span>
<span id="cb1938-3"><a href="writing_functions.html#cb1938-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-4"><a href="writing_functions.html#cb1938-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-5"><a href="writing_functions.html#cb1938-5" aria-hidden="true" tabindex="-1"></a><span class="co">#créer une fonction appelée &quot;chart_outcome_province&quot; qui prend comme argument l&#39;ensemble de données et le nom de la province pour laquelle on veut tracer la distribution du résultat.</span></span>
<span id="cb1938-6"><a href="writing_functions.html#cb1938-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-7"><a href="writing_functions.html#cb1938-7" aria-hidden="true" tabindex="-1"></a>chart_outcome_province <span class="ot">&lt;-</span> <span class="cf">function</span>(data_used, prov){</span>
<span id="cb1938-8"><a href="writing_functions.html#cb1938-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-9"><a href="writing_functions.html#cb1938-9" aria-hidden="true" tabindex="-1"></a>  tab_prov <span class="ot">&lt;-</span> data_used <span class="sc">%&gt;%</span> </span>
<span id="cb1938-10"><a href="writing_functions.html#cb1938-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(province <span class="sc">==</span> prov,</span>
<span id="cb1938-11"><a href="writing_functions.html#cb1938-11" aria-hidden="true" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">is.na</span>(outcome))<span class="sc">%&gt;%</span> </span>
<span id="cb1938-12"><a href="writing_functions.html#cb1938-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb1938-13"><a href="writing_functions.html#cb1938-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1938-14"><a href="writing_functions.html#cb1938-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1938-15"><a href="writing_functions.html#cb1938-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">&quot;col&quot;</span>, )<span class="sc">%&gt;%</span></span>
<span id="cb1938-16"><a href="writing_functions.html#cb1938-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1938-17"><a href="writing_functions.html#cb1938-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">perc_outcome=</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))</span>
<span id="cb1938-18"><a href="writing_functions.html#cb1938-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-19"><a href="writing_functions.html#cb1938-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-20"><a href="writing_functions.html#cb1938-20" aria-hidden="true" tabindex="-1"></a>  tab_prov <span class="sc">%&gt;%</span></span>
<span id="cb1938-21"><a href="writing_functions.html#cb1938-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(outcome <span class="sc">!=</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1938-22"><a href="writing_functions.html#cb1938-22" aria-hidden="true" tabindex="-1"></a>  highcharter<span class="sc">::</span><span class="fu">hchart</span>(</span>
<span id="cb1938-23"><a href="writing_functions.html#cb1938-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;pie&quot;</span>, <span class="fu">hcaes</span>(<span class="at">x =</span> outcome, <span class="at">y =</span> perc_outcome),</span>
<span id="cb1938-24"><a href="writing_functions.html#cb1938-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distribution du résultat en :&quot;</span>, prov)</span>
<span id="cb1938-25"><a href="writing_functions.html#cb1938-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1938-26"><a href="writing_functions.html#cb1938-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-27"><a href="writing_functions.html#cb1938-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1938-28"><a href="writing_functions.html#cb1938-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-29"><a href="writing_functions.html#cb1938-29" aria-hidden="true" tabindex="-1"></a><span class="fu">chart_outcome_province</span>(flu_china, <span class="st">&quot;Shanghai&quot;</span>)</span></code></pre></div>
<div class="highchart html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d766d3c7b99574758477" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d766d3c7b99574758477">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"perc_outcome"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"outcome":"Death","n":0.533333333333333,"perc_outcome":53.33,"y":53.33,"name":"Death"},{"outcome":"Recover","n":0.466666666666667,"perc_outcome":46.67,"y":46.67,"name":"Recover"}],"type":"pie","name":"Distribution du résultat en :Shanghai"}],"xAxis":{"type":"category","title":{"text":"outcome"},"categories":null}},"theme":{"colors":["#d35400","#2980b9","#2ecc71","#f1c40f","#2c3e50","#7f8c8d"],"chart":{"style":{"fontFamily":"Roboto","color":"#666666"}},"title":{"align":"left","style":{"fontFamily":"Roboto Condensed","fontWeight":"bold"}},"subtitle":{"align":"left","style":{"fontFamily":"Roboto Condensed"}},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"plotOptions":{"line":{"marker":{"enabled":false}},"spline":{"marker":{"enabled":false}},"area":{"marker":{"enabled":false}},"areaspline":{"marker":{"enabled":false}},"arearange":{"marker":{"enabled":false}},"bubble":{"maxSize":"10%"}},"tooltip":{"valueDecimals":2}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":["Roboto","Roboto+Condensed"],"debug":false},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb1939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1939-1"><a href="writing_functions.html#cb1939-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chart_outcome_province</span>(flu_china, <span class="st">&quot;Zhejiang&quot;</span>)</span></code></pre></div>
<div class="highchart html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-32bd746f8ef773a5ae04" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-32bd746f8ef773a5ae04">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"perc_outcome"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"outcome":"Death","n":0.428571428571429,"perc_outcome":42.86,"y":42.86,"name":"Death"},{"outcome":"Recover","n":0.571428571428571,"perc_outcome":57.14,"y":57.14,"name":"Recover"}],"type":"pie","name":"Distribution du résultat en :Zhejiang"}],"xAxis":{"type":"category","title":{"text":"outcome"},"categories":null}},"theme":{"colors":["#d35400","#2980b9","#2ecc71","#f1c40f","#2c3e50","#7f8c8d"],"chart":{"style":{"fontFamily":"Roboto","color":"#666666"}},"title":{"align":"left","style":{"fontFamily":"Roboto Condensed","fontWeight":"bold"}},"subtitle":{"align":"left","style":{"fontFamily":"Roboto Condensed"}},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"plotOptions":{"line":{"marker":{"enabled":false}},"spline":{"marker":{"enabled":false}},"area":{"marker":{"enabled":false}},"areaspline":{"marker":{"enabled":false}},"arearange":{"marker":{"enabled":false}},"bubble":{"maxSize":"10%"}},"tooltip":{"valueDecimals":2}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":["Roboto","Roboto+Condensed"],"debug":false},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb1940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1940-1"><a href="writing_functions.html#cb1940-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chart_outcome_province</span>(flu_china, <span class="st">&quot;Jiangsu&quot;</span>)</span></code></pre></div>
<div class="highchart html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2ee3efe007900e10c5f0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2ee3efe007900e10c5f0">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"perc_outcome"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"outcome":"Death","n":0.285714285714286,"perc_outcome":28.57,"y":28.57,"name":"Death"},{"outcome":"Recover","n":0.714285714285714,"perc_outcome":71.43,"y":71.43,"name":"Recover"}],"type":"pie","name":"Distribution du résultat en :Jiangsu"}],"xAxis":{"type":"category","title":{"text":"outcome"},"categories":null}},"theme":{"colors":["#d35400","#2980b9","#2ecc71","#f1c40f","#2c3e50","#7f8c8d"],"chart":{"style":{"fontFamily":"Roboto","color":"#666666"}},"title":{"align":"left","style":{"fontFamily":"Roboto Condensed","fontWeight":"bold"}},"subtitle":{"align":"left","style":{"fontFamily":"Roboto Condensed"}},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"plotOptions":{"line":{"marker":{"enabled":false}},"spline":{"marker":{"enabled":false}},"area":{"marker":{"enabled":false}},"areaspline":{"marker":{"enabled":false}},"arearange":{"marker":{"enabled":false}},"bubble":{"maxSize":"10%"}},"tooltip":{"valueDecimals":2}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":["Roboto","Roboto+Condensed"],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="produire-itérativement-des-tableaux-pour-différents-niveaux-dune-variable" class="section level3 unnumbered">
<h3>Produire itérativement des tableaux pour différents niveaux d’une variable</h3>
<p>Ici, nous allons créer trois indicateurs à résumer dans un tableau et nous voudrions produire ce tableau pour chacune des provinces. Nos indicateurs sont le délai entre l’apparition et l’hospitalisation, le pourcentage de guérison et l’âge médian des cas.</p>
<div class="sourceCode" id="cb1941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1941-1"><a href="writing_functions.html#cb1941-1" aria-hidden="true" tabindex="-1"></a>indic_1 <span class="ot">&lt;-</span> flu_china <span class="sc">%&gt;%</span> </span>
<span id="cb1941-2"><a href="writing_functions.html#cb1941-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-3"><a href="writing_functions.html#cb1941-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1941-4"><a href="writing_functions.html#cb1941-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_hosp=</span> <span class="fu">strptime</span>(date_of_hospitalisation, <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>),</span>
<span id="cb1941-5"><a href="writing_functions.html#cb1941-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_ons=</span> <span class="fu">strptime</span>(date_of_onset, <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>), </span>
<span id="cb1941-6"><a href="writing_functions.html#cb1941-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay_onset_hosp=</span> <span class="fu">as.numeric</span>(date_hosp <span class="sc">-</span> date_ons)<span class="sc">/</span><span class="dv">86400</span>,</span>
<span id="cb1941-7"><a href="writing_functions.html#cb1941-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_delay_onset_hosp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(delay_onset_hosp, <span class="at">na.rm=</span><span class="cn">TRUE</span> ), <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1941-8"><a href="writing_functions.html#cb1941-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province, mean_delay_onset_hosp) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-9"><a href="writing_functions.html#cb1941-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb1941-10"><a href="writing_functions.html#cb1941-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1941-11"><a href="writing_functions.html#cb1941-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1941-12"><a href="writing_functions.html#cb1941-12" aria-hidden="true" tabindex="-1"></a>indic_2 <span class="ot">&lt;-</span> flu_china <span class="sc">%&gt;%</span> </span>
<span id="cb1941-13"><a href="writing_functions.html#cb1941-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-14"><a href="writing_functions.html#cb1941-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(province, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-15"><a href="writing_functions.html#cb1941-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1941-16"><a href="writing_functions.html#cb1941-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> outcome, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-17"><a href="writing_functions.html#cb1941-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">&quot;col&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-18"><a href="writing_functions.html#cb1941-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1941-19"><a href="writing_functions.html#cb1941-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">perc_recovery=</span> <span class="fu">round</span>((Recover<span class="sc">/</span>Total)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb1941-20"><a href="writing_functions.html#cb1941-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province, perc_recovery)</span>
<span id="cb1941-21"><a href="writing_functions.html#cb1941-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1941-22"><a href="writing_functions.html#cb1941-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1941-23"><a href="writing_functions.html#cb1941-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1941-24"><a href="writing_functions.html#cb1941-24" aria-hidden="true" tabindex="-1"></a>indic_3 <span class="ot">&lt;-</span> flu_china <span class="sc">%&gt;%</span> </span>
<span id="cb1941-25"><a href="writing_functions.html#cb1941-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(province) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-26"><a href="writing_functions.html#cb1941-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(</span>
<span id="cb1941-27"><a href="writing_functions.html#cb1941-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">median_age_cases =</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(age), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1941-28"><a href="writing_functions.html#cb1941-28" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-29"><a href="writing_functions.html#cb1941-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province, median_age_cases) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-30"><a href="writing_functions.html#cb1941-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `median_age_cases = median(as.numeric(age), na.rm = TRUE)`.
## ℹ In group 11: `province = &quot;Shanghai&quot;`.
## Caused by warning in `median()`:
## ! NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb1943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1943-1"><a href="writing_functions.html#cb1943-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Joindre les trois ensembles de données d&#39;indicateurs</span></span>
<span id="cb1943-2"><a href="writing_functions.html#cb1943-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-3"><a href="writing_functions.html#cb1943-3" aria-hidden="true" tabindex="-1"></a>table_indic_all <span class="ot">&lt;-</span> indic_1 <span class="sc">%&gt;%</span> </span>
<span id="cb1943-4"><a href="writing_functions.html#cb1943-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(indic_2, <span class="at">by =</span> <span class="st">&quot;province&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1943-5"><a href="writing_functions.html#cb1943-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">left_join</span>(indic_3, <span class="at">by =</span> <span class="st">&quot;province&quot;</span>)</span>
<span id="cb1943-6"><a href="writing_functions.html#cb1943-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-7"><a href="writing_functions.html#cb1943-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-8"><a href="writing_functions.html#cb1943-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Imprimez les indicateurs dans un tableau mobile</span></span>
<span id="cb1943-9"><a href="writing_functions.html#cb1943-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-10"><a href="writing_functions.html#cb1943-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-11"><a href="writing_functions.html#cb1943-11" aria-hidden="true" tabindex="-1"></a>print_indic_prov <span class="ot">&lt;-</span> <span class="cf">function</span>(table_used, prov){</span>
<span id="cb1943-12"><a href="writing_functions.html#cb1943-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1943-13"><a href="writing_functions.html#cb1943-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#d&#39;abord transformer un peu le dataframe pour faciliter l&#39;impression.</span></span>
<span id="cb1943-14"><a href="writing_functions.html#cb1943-14" aria-hidden="true" tabindex="-1"></a>  indic_prov <span class="ot">&lt;-</span> table_used <span class="sc">%&gt;%</span></span>
<span id="cb1943-15"><a href="writing_functions.html#cb1943-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(province<span class="sc">==</span>prov) <span class="sc">%&gt;%</span></span>
<span id="cb1943-16"><a href="writing_functions.html#cb1943-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;Indicateurs&quot;</span>, <span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1943-17"><a href="writing_functions.html#cb1943-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>( <span class="at">indic_label =</span> <span class="fu">factor</span>(Indicateurs,</span>
<span id="cb1943-18"><a href="writing_functions.html#cb1943-18" aria-hidden="true" tabindex="-1"></a>   <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">&quot;mean_delay_onset_hosp&quot;</span>, <span class="st">&quot;perc_recovery&quot;</span>, <span class="st">&quot;median_age_cases&quot;</span>),</span>
<span id="cb1943-19"><a href="writing_functions.html#cb1943-19" aria-hidden="true" tabindex="-1"></a>   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Délai moyen d&#39;apparition hôpital&quot;</span>, <span class="st">&quot;Pourcentage de récupération&quot;</span>, <span class="st">&quot;Âge médian des cas&quot;</span>))</span>
<span id="cb1943-20"><a href="writing_functions.html#cb1943-20" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span> </span>
<span id="cb1943-21"><a href="writing_functions.html#cb1943-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>(province) <span class="sc">%&gt;%</span> </span>
<span id="cb1943-22"><a href="writing_functions.html#cb1943-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(indic_label, value)</span>
<span id="cb1943-23"><a href="writing_functions.html#cb1943-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1943-24"><a href="writing_functions.html#cb1943-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-25"><a href="writing_functions.html#cb1943-25" aria-hidden="true" tabindex="-1"></a>    tab_print <span class="ot">&lt;-</span> <span class="fu">flextable</span>(indic_prov) <span class="sc">%&gt;%</span></span>
<span id="cb1943-26"><a href="writing_functions.html#cb1943-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_vanilla</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1943-27"><a href="writing_functions.html#cb1943-27" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>) </span>
<span id="cb1943-28"><a href="writing_functions.html#cb1943-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1943-29"><a href="writing_functions.html#cb1943-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1943-30"><a href="writing_functions.html#cb1943-30" aria-hidden="true" tabindex="-1"></a>     tab_print <span class="ot">&lt;-</span> tab_print <span class="sc">%&gt;%</span> </span>
<span id="cb1943-31"><a href="writing_functions.html#cb1943-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1943-32"><a href="writing_functions.html#cb1943-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">set_header_labels</span>( </span>
<span id="cb1943-33"><a href="writing_functions.html#cb1943-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">indic_label=</span> <span class="st">&quot;Indicateurs&quot;</span>, <span class="at">value=</span> <span class="st">&quot;Estimation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1943-34"><a href="writing_functions.html#cb1943-34" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">bg</span>( <span class="at">bg =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1943-35"><a href="writing_functions.html#cb1943-35" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1943-36"><a href="writing_functions.html#cb1943-36" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">color</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1943-37"><a href="writing_functions.html#cb1943-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_header_lines</span>(<span class="at">values =</span> <span class="fu">paste0</span>(<span class="st">&quot;Indicateurs pour la province de : &quot;</span>, prov)) <span class="sc">%&gt;%</span> </span>
<span id="cb1943-38"><a href="writing_functions.html#cb1943-38" aria-hidden="true" tabindex="-1"></a><span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>)</span>
<span id="cb1943-39"><a href="writing_functions.html#cb1943-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1943-40"><a href="writing_functions.html#cb1943-40" aria-hidden="true" tabindex="-1"></a> tab_print <span class="ot">&lt;-</span> <span class="fu">set_formatter_type</span>(tab_print,</span>
<span id="cb1943-41"><a href="writing_functions.html#cb1943-41" aria-hidden="true" tabindex="-1"></a>   <span class="at">fmt_double =</span> <span class="st">&quot;%.2f&quot;</span>,</span>
<span id="cb1943-42"><a href="writing_functions.html#cb1943-42" aria-hidden="true" tabindex="-1"></a>   <span class="at">na_str =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb1943-43"><a href="writing_functions.html#cb1943-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-44"><a href="writing_functions.html#cb1943-44" aria-hidden="true" tabindex="-1"></a>tab_print </span>
<span id="cb1943-45"><a href="writing_functions.html#cb1943-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1943-46"><a href="writing_functions.html#cb1943-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1943-47"><a href="writing_functions.html#cb1943-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-48"><a href="writing_functions.html#cb1943-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-49"><a href="writing_functions.html#cb1943-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-50"><a href="writing_functions.html#cb1943-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1943-51"><a href="writing_functions.html#cb1943-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print_indic_prov</span>(table_indic_all, <span class="st">&quot;Shanghai&quot;</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-d446adfc{}.cl-d43da388{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-d43da39c{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d44137fa{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d4413804{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d44155aa{width:2.257in;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155b4{width:0.676in;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155b5{width:2.257in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155be{width:0.676in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155bf{width:2.257in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155c8{width:0.676in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155c9{width:2.257in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d44155d2{width:0.676in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-d446adfc'><thead><tr style="overflow-wrap:break-word;"><th  colspan="2"class="cl-d44155aa"><p class="cl-d44137fa"><span class="cl-d43da388">Indicateurs pour la province de : Shanghai</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-d44155aa"><p class="cl-d44137fa"><span class="cl-d43da388">Indicateurs</span></p></th><th class="cl-d44155b4"><p class="cl-d4413804"><span class="cl-d43da388">Estimation</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d44155b5"><p class="cl-d44137fa"><span class="cl-d43da39c">Délai moyen d'apparition hôpital</span></p></td><td class="cl-d44155be"><p class="cl-d4413804"><span class="cl-d43da39c">4.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d44155bf"><p class="cl-d44137fa"><span class="cl-d43da39c">Pourcentage de récupération</span></p></td><td class="cl-d44155c8"><p class="cl-d4413804"><span class="cl-d43da39c">46.7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d44155c9"><p class="cl-d44137fa"><span class="cl-d43da39c">Âge médian des cas</span></p></td><td class="cl-d44155d2"><p class="cl-d4413804"><span class="cl-d43da39c">67.0</span></p></td></tr></tbody></table></div>
<div class="sourceCode" id="cb1944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1944-1"><a href="writing_functions.html#cb1944-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_indic_prov</span>(table_indic_all, <span class="st">&quot;Jiangsu&quot;</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-d461ac42{}.cl-d458ed14{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-d458ed28{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d45c6bb0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d45c6bc4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d45c806e{width:2.257in;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c8078{width:0.676in;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c8079{width:2.257in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c8082{width:0.676in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c8083{width:2.257in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c808c{width:0.676in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c808d{width:2.257in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d45c8096{width:0.676in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-d461ac42'><thead><tr style="overflow-wrap:break-word;"><th  colspan="2"class="cl-d45c806e"><p class="cl-d45c6bb0"><span class="cl-d458ed14">Indicateurs pour la province de : Jiangsu</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-d45c806e"><p class="cl-d45c6bb0"><span class="cl-d458ed14">Indicateurs</span></p></th><th class="cl-d45c8078"><p class="cl-d45c6bc4"><span class="cl-d458ed14">Estimation</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d45c8079"><p class="cl-d45c6bb0"><span class="cl-d458ed28">Délai moyen d'apparition hôpital</span></p></td><td class="cl-d45c8082"><p class="cl-d45c6bc4"><span class="cl-d458ed28">6.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d45c8083"><p class="cl-d45c6bb0"><span class="cl-d458ed28">Pourcentage de récupération</span></p></td><td class="cl-d45c808c"><p class="cl-d45c6bc4"><span class="cl-d458ed28">71.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d45c808d"><p class="cl-d45c6bb0"><span class="cl-d458ed28">Âge médian des cas</span></p></td><td class="cl-d45c8096"><p class="cl-d45c6bc4"><span class="cl-d458ed28">55.0</span></p></td></tr></tbody></table></div>
</div>
</div>
<div id="conseils-et-meilleures-pratiques-pour-des-fonctions-bien-rodées" class="section level2" number="45.7">
<h2><span class="header-section-number">45.7</span> Conseils et meilleures pratiques pour des fonctions bien rodées</h2>
<p>La programmation fonctionnelle a pour but d’alléger le code et d’en faciliter la lecture. Elle devrait produire le contraire. Les conseils ci-dessous vous aideront à avoir un code propre et facile à lire.</p>
<div id="nommage-et-syntaxe" class="section level3 unnumbered">
<h3>Nommage et syntaxe</h3>
<ul>
<li><p>Evitez d’utiliser des caractères qui auraient pu être facilement pris par d’autres fonctions déjà existantes dans votre environnement.</p></li>
<li><p>Il est recommandé que le nom de la fonction soit court et facile à comprendre pour un autre lecteur.</p></li>
<li><p>Il est préférable d’utiliser des verbes pour le nom de la fonction et des noms pour les noms des arguments.</p></li>
</ul>
</div>
<div id="noms-de-colonnes-et-évaluation-ordonnée" class="section level3 unnumbered">
<h3>Noms de colonnes et évaluation ordonnée</h3>
<p>Si vous voulez savoir comment référencer les <em>noms de colonnes</em> qui sont fournis à votre code en tant qu’arguments, lisez ce <a href="https://dplyr.tidyverse.org/articles/programming.html">guide de programmation tidyverse</a>. Parmi les sujets abordés figurent <em>l’évaluation tidée</em> et l’utilisation de l’accolade double <code>{{ }}</code>.</p>
<p>Par exemple, voici un squelette de code rapide tiré du tutoriel de la page mentionnée juste au-dessus :</p>
<div class="sourceCode" id="cb1945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1945-1"><a href="writing_functions.html#cb1945-1" aria-hidden="true" tabindex="-1"></a>var_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var) {</span>
<span id="cb1945-2"><a href="writing_functions.html#cb1945-2" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb1945-3"><a href="writing_functions.html#cb1945-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">min =</span> <span class="fu">min</span>({{ var }}), <span class="at">max =</span> <span class="fu">max</span>({{ var }}))<span class="er">)</span></span>
<span id="cb1945-4"><a href="writing_functions.html#cb1945-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1945-5"><a href="writing_functions.html#cb1945-5" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb1945-6"><a href="writing_functions.html#cb1945-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb1945-7"><a href="writing_functions.html#cb1945-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var_summary</span>(mpg)</span></code></pre></div>
</div>
<div id="test-et-gestion-des-erreurs" class="section level3 unnumbered">
<h3>Test et gestion des erreurs</h3>
<p>Plus la tâche d’une fonction est compliquée, plus la possibilité d’erreurs est élevée. Il est donc parfois nécessaire d’ajouter une vérification dans la fonction pour aider à comprendre rapidement d’où vient l’erreur et trouver un moyen de la corriger.</p>
<ul>
<li>Il peut être plus que recommandé d’introduire une vérification de l’absence d’un argument en utilisant <code>missing(argument)</code>. Cette simple vérification peut retourner la valeur “VRAI” ou “FAUX”.</li>
</ul>
<div class="sourceCode" id="cb1946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1946-1"><a href="writing_functions.html#cb1946-1" aria-hidden="true" tabindex="-1"></a>contain_covid19_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(barrier_gest, wear_mask, get_vaccine){</span>
<span id="cb1946-2"><a href="writing_functions.html#cb1946-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1946-3"><a href="writing_functions.html#cb1946-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(barrier_gest)) (<span class="fu">print</span>(<span class="st">&quot;please provide arg1&quot;</span>))</span>
<span id="cb1946-4"><a href="writing_functions.html#cb1946-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(wear_mask)) <span class="fu">print</span>(<span class="st">&quot;please provide arg2&quot;</span>)</span>
<span id="cb1946-5"><a href="writing_functions.html#cb1946-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(get_vaccine)) <span class="fu">print</span>(<span class="st">&quot;please provide arg3&quot;</span>)</span>
<span id="cb1946-6"><a href="writing_functions.html#cb1946-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-7"><a href="writing_functions.html#cb1946-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-8"><a href="writing_functions.html#cb1946-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>barrier_gest <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">|</span> wear_mask <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">|</span> get_vaccine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> ) </span>
<span id="cb1946-9"><a href="writing_functions.html#cb1946-9" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb1946-10"><a href="writing_functions.html#cb1946-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span> (<span class="st">&quot;you can do better&quot;</span>)</span>
<span id="cb1946-11"><a href="writing_functions.html#cb1946-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1946-12"><a href="writing_functions.html#cb1946-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="st">&quot;please make sure all are yes, this pandemic has to end!&quot;</span>)</span>
<span id="cb1946-13"><a href="writing_functions.html#cb1946-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1946-14"><a href="writing_functions.html#cb1946-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-15"><a href="writing_functions.html#cb1946-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-16"><a href="writing_functions.html#cb1946-16" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19_missing</span>(<span class="at">get_vaccine =</span> <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;please provide arg1&quot;
## [1] &quot;please provide arg2&quot;</code></pre>
<pre><code>## Error in contain_covid19_missing(get_vaccine = &quot;yes&quot;): argument &quot;barrier_gest&quot; is missing, with no default</code></pre>
<ul>
<li>Utilisez <code>stop()</code> pour les erreurs plus faciles à détecter.</li>
</ul>
<div class="sourceCode" id="cb1949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1949-1"><a href="writing_functions.html#cb1949-1" aria-hidden="true" tabindex="-1"></a>contain_covid19_stop <span class="ot">&lt;-</span> <span class="cf">function</span>(barrier_gest, wear_mask, get_vaccine){</span>
<span id="cb1949-2"><a href="writing_functions.html#cb1949-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1949-3"><a href="writing_functions.html#cb1949-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.character</span>(barrier_gest)) (<span class="fu">stop</span>(<span class="st">&quot;arg1 should be a character, please enter the value with `yes`, `no` or `sometimes`&quot;</span>))</span>
<span id="cb1949-4"><a href="writing_functions.html#cb1949-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1949-5"><a href="writing_functions.html#cb1949-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(barrier_gest <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> wear_mask <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> get_vaccine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> ) </span>
<span id="cb1949-6"><a href="writing_functions.html#cb1949-6" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb1949-7"><a href="writing_functions.html#cb1949-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span> (<span class="st">&quot;success&quot;</span>)</span>
<span id="cb1949-8"><a href="writing_functions.html#cb1949-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1949-9"><a href="writing_functions.html#cb1949-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="st">&quot;please make sure all are yes, this pandemic has to end!&quot;</span>)</span>
<span id="cb1949-10"><a href="writing_functions.html#cb1949-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1949-11"><a href="writing_functions.html#cb1949-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1949-12"><a href="writing_functions.html#cb1949-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1949-13"><a href="writing_functions.html#cb1949-13" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19_stop</span>(<span class="at">barrier_gest=</span><span class="dv">1</span>, <span class="at">wear_mask=</span><span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>## Error in contain_covid19_stop(barrier_gest = 1, wear_mask = &quot;yes&quot;, get_vaccine = &quot;no&quot;): arg1 should be a character, please enter the value with `yes`, `no` or `sometimes`</code></pre>
<ul>
<li><p>Comme nous le voyons lorsque nous exécutons la plupart des fonctions intégrées, des messages et des avertissements peuvent apparaître dans certaines conditions. Nous pouvons les intégrer dans nos fonctions écrites en utilisant les fonctions <code>message()</code> et <code>warning()</code>.</p></li>
<li><p>Nous pouvons également gérer les erreurs en utilisant la fonction <code>safely()</code> qui prend une fonction en argument et l’exécute de manière sûre. En fait, la fonction s’exécutera sans s’arrêter si elle rencontre une erreur. <code>safely()</code> retourne en sortie une <strong>liste</strong> avec deux objets qui sont les résultats et l’erreur qu’elle a “sautée”.</p></li>
</ul>
<p>Nous pouvons vérifier en exécutant d’abord la fonction <code>mean()</code>, puis en l’exécutant avec <code>safely()</code>.</p>
<div class="sourceCode" id="cb1951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1951-1"><a href="writing_functions.html#cb1951-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(linelist, mean)</span></code></pre></div>
<pre><code>## $case_id
## [1] NA
## 
## $generation
## [1] 16.56165
## 
## $date_infection
## [1] NA
## 
## $date_onset
## [1] NA
## 
## $date_hospitalisation
## [1] &quot;2014-11-03&quot;
## 
## $date_outcome
## [1] NA
## 
## $outcome
## [1] NA
## 
## $gender
## [1] NA
## 
## $age
## [1] NA
## 
## $age_unit
## [1] NA
## 
## $age_years
## [1] NA
## 
## $age_cat
## [1] NA
## 
## $age_cat5
## [1] NA
## 
## $hospital
## [1] NA
## 
## $lon
## [1] -13.23381
## 
## $lat
## [1] 8.469638
## 
## $infector
## [1] NA
## 
## $source
## [1] NA
## 
## $wt_kg
## [1] 52.64487
## 
## $ht_cm
## [1] 124.9633
## 
## $ct_blood
## [1] 21.20686
## 
## $fever
## [1] NA
## 
## $chills
## [1] NA
## 
## $cough
## [1] NA
## 
## $aches
## [1] NA
## 
## $vomit
## [1] NA
## 
## $temp
## [1] NA
## 
## $time_admission
## [1] NA
## 
## $bmi
## [1] 46.89023
## 
## $days_onset_hosp
## [1] NA</code></pre>
<div class="sourceCode" id="cb1953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1953-1"><a href="writing_functions.html#cb1953-1" aria-hidden="true" tabindex="-1"></a>safe_mean <span class="ot">&lt;-</span> <span class="fu">safely</span>(mean)</span>
<span id="cb1953-2"><a href="writing_functions.html#cb1953-2" aria-hidden="true" tabindex="-1"></a>linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1953-3"><a href="writing_functions.html#cb1953-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(safe_mean)</span></code></pre></div>
<pre><code>## $case_id
## $case_id$result
## [1] NA
## 
## $case_id$error
## NULL
## 
## 
## $generation
## $generation$result
## [1] 16.56165
## 
## $generation$error
## NULL
## 
## 
## $date_infection
## $date_infection$result
## [1] NA
## 
## $date_infection$error
## NULL
## 
## 
## $date_onset
## $date_onset$result
## [1] NA
## 
## $date_onset$error
## NULL
## 
## 
## $date_hospitalisation
## $date_hospitalisation$result
## [1] &quot;2014-11-03&quot;
## 
## $date_hospitalisation$error
## NULL
## 
## 
## $date_outcome
## $date_outcome$result
## [1] NA
## 
## $date_outcome$error
## NULL
## 
## 
## $outcome
## $outcome$result
## [1] NA
## 
## $outcome$error
## NULL
## 
## 
## $gender
## $gender$result
## [1] NA
## 
## $gender$error
## NULL
## 
## 
## $age
## $age$result
## [1] NA
## 
## $age$error
## NULL
## 
## 
## $age_unit
## $age_unit$result
## [1] NA
## 
## $age_unit$error
## NULL
## 
## 
## $age_years
## $age_years$result
## [1] NA
## 
## $age_years$error
## NULL
## 
## 
## $age_cat
## $age_cat$result
## [1] NA
## 
## $age_cat$error
## NULL
## 
## 
## $age_cat5
## $age_cat5$result
## [1] NA
## 
## $age_cat5$error
## NULL
## 
## 
## $hospital
## $hospital$result
## [1] NA
## 
## $hospital$error
## NULL
## 
## 
## $lon
## $lon$result
## [1] -13.23381
## 
## $lon$error
## NULL
## 
## 
## $lat
## $lat$result
## [1] 8.469638
## 
## $lat$error
## NULL
## 
## 
## $infector
## $infector$result
## [1] NA
## 
## $infector$error
## NULL
## 
## 
## $source
## $source$result
## [1] NA
## 
## $source$error
## NULL
## 
## 
## $wt_kg
## $wt_kg$result
## [1] 52.64487
## 
## $wt_kg$error
## NULL
## 
## 
## $ht_cm
## $ht_cm$result
## [1] 124.9633
## 
## $ht_cm$error
## NULL
## 
## 
## $ct_blood
## $ct_blood$result
## [1] 21.20686
## 
## $ct_blood$error
## NULL
## 
## 
## $fever
## $fever$result
## [1] NA
## 
## $fever$error
## NULL
## 
## 
## $chills
## $chills$result
## [1] NA
## 
## $chills$error
## NULL
## 
## 
## $cough
## $cough$result
## [1] NA
## 
## $cough$error
## NULL
## 
## 
## $aches
## $aches$result
## [1] NA
## 
## $aches$error
## NULL
## 
## 
## $vomit
## $vomit$result
## [1] NA
## 
## $vomit$error
## NULL
## 
## 
## $temp
## $temp$result
## [1] NA
## 
## $temp$error
## NULL
## 
## 
## $time_admission
## $time_admission$result
## [1] NA
## 
## $time_admission$error
## NULL
## 
## 
## $bmi
## $bmi$result
## [1] 46.89023
## 
## $bmi$error
## NULL
## 
## 
## $days_onset_hosp
## $days_onset_hosp$result
## [1] NA
## 
## $days_onset_hosp$error
## NULL</code></pre>
<p>Comme dit précédemment, bien commenter nos codes est déjà un bon moyen d’avoir de la documentation dans notre travail.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="ressources-28" class="section level2" number="45.8">
<h2><span class="header-section-number">45.8</span> Ressources</h2>
<p><a href="https://r4ds.had.co.nz/functions.html">Lien vers R pour la science des données</a></p>
<p><a href="https://www.rstudio.com/wp-content/uploads/2016/02/advancedR.pdf">Cheatsheet advance R programming</a></p>
<p><a href="https://purrr.tidyverse.org/">Cheatsheet purr Package</a></p>
<p><a href="https://youtube.videoken.com/embed/bzUmK0Y07ck">Video-ACM talk by Hadley Wickham : Les joies de la programmation fonctionnelle (comment fonctionne map_dbl)</a></p>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2023-05-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
