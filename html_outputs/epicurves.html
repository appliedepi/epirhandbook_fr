<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>33 Courbes épidémiques | The Epidemiologist R Handbook</title>

    <meta name="author" content="the handbook team" />
  
   <meta name="description" content="The Epi R Handbook est un manuel de référence sur l’utilisation de R en épidémiologie appliquée et santé publique." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="33 Courbes épidémiques | The Epidemiologist R Handbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The Epi R Handbook est un manuel de référence sur l’utilisation de R en épidémiologie appliquée et santé publique." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="33 Courbes épidémiques | The Epidemiologist R Handbook" />
  
  <meta name="twitter:description" content="The Epi R Handbook est un manuel de référence sur l’utilisation de R en épidémiologie appliquée et santé publique." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.27/datatables.js"></script>
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
    <link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="libs/selectize-0.12.0/selectize.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
    <script src="libs/tabwid-1.1.3/tabwid.js"></script>
    <link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-1.3.1/leaflet.js"></script>
    <link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4-2.6.2/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
    <script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
    <script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
    <script src="libs/viz-1.8.2/viz.js"></script>
    <link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding-1.0.9/grViz.js"></script>
    <script src="libs/d3-4.5.0/d3.min.js"></script>
    <script src="libs/sankey-1/sankey.js"></script>
    <script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
    <script src="libs/plotly-binding-4.10.1/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
    <link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
    <script src="libs/vis-9.1.0/vis-network.min.js"></script>
    <script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
    <link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script src="libs/plotly-basic-2.11.1/plotly-basic-2.11.1.min.js"></script>
    <script src="libs/plotly-cartesian-2.11.1/plotly-cartesian-2.11.1.min.js"></script>
    <script src="libs/proj4js-2.3.15/proj4.js"></script>
    <link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
    <script src="libs/highcharts-9.3.1/highcharts.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
    <script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
    <script src="libs/highcharts-9.3.1/modules/stock.js"></script>
    <script src="libs/highcharts-9.3.1/modules/map.js"></script>
    <script src="libs/highcharts-9.3.1/modules/data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
    <script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
    <script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
    <script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
    <script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
    <script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
    <script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
    <script src="libs/highcharts-9.3.1/modules/organization.js"></script>
    <script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
    <script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
    <script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
    <script src="libs/highcharts-9.3.1/modules/vector.js"></script>
    <script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
    <script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
    <script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
    <script src="libs/highcharts-9.3.1/modules/venn.js"></script>
    <script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
    <script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
    <script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
    <script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
    <script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
    <script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
    <script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
    <script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
    <script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
    <script src="libs/highcharts-9.3.1/custom/reset.js"></script>
    <script src="libs/highcharts-9.3.1/modules/boost.js"></script>
    <script src="libs/highchart-binding-0.9.4/highchart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style_bs4.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="epicurves" class="section level1" number="33">
<h1><span class="header-section-number">33</span> Courbes épidémiques</h1>
<p><img src="images/epicurve_top.png" width="75%" /></p>
<p>Une courbe épidémique (également connue sous le nom de “courbe épi”) est un graphique épidémiologique de base généralement utilisé pour visualiser le schéma temporel d’apparition de la maladie parmi un groupe de cas ou une épidémie.</p>
<p>L’analyse de la courbe épi peut révéler des tendances temporelles, des valeurs aberrantes, l’ampleur de l’épidémie, la période d’exposition la plus probable, les intervalles de temps entre les générations de cas, et peut même aider à identifier le mode de transmission d’une maladie non identifie (par exemple, source ponctuelle, source commune continue, propagation de personne à personne). Une leçon en ligne sur l’interprétation des courbes épi est disponible sur le site Web du <a href="https://www.cdc.gov/training/quicklearns/epimode/index.html">US CDC</a>.</p>
<p>Dans cette page, nous démontrons deux approches pour produire des épicurves dans R :</p>
<ul>
<li>Le paquet <strong>incidence2</strong>, qui peut produire une courbe épi avec des commandes simples.<br />
</li>
<li>Le paquet <strong>ggplot2</strong>, qui permet une personnalisation avancé via des commandes plus complexes.</li>
</ul>
<p>Nous abordons également des cas d’utilisation spécifiques tels que :</p>
<ul>
<li>Les tracés de données de comptages agrégées<br />
</li>
<li>Le facettage ou la production de petits multiples<br />
</li>
<li>Application de moyennes mobiles<br />
</li>
<li>Montrer quelles données sont “provisoires” ou sujettes à des retards de rapport<br />
</li>
<li>Superposer l’incidence cumulative des cas à l’aide d’un deuxiéme axe</li>
</ul>
<!-- ======================================================= -->
<div id="préparation-17" class="section level2" number="33.1">
<h2><span class="header-section-number">33.1</span> Préparation</h2>
<div id="paquets-2" class="section level3 unnumbered">
<h3>Paquets</h3>
<p>Ce chunk de code montre le chargement des paquets nécessaires aux analyses. Dans ce manuel, nous mettons l’accent sur <code>p_load()</code> de <strong>pacman</strong>, qui installe le paquet si nécessaire <em>et</em> le charge pour l’utiliser. Vous pouvez également charger les paquets installs avec <code>library()</code> de <strong>base</strong> R. Voir la page sur <a href="rbasics.html#rbasics">R basics</a> pour plus d’informations sur les paquets R.</p>
<div class="sourceCode" id="cb1545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1545-1"><a href="epicurves.html#cb1545-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1545-2"><a href="epicurves.html#cb1545-2" aria-hidden="true" tabindex="-1"></a>  rio,         <span class="co"># import/export de fichiers</span></span>
<span id="cb1545-3"><a href="epicurves.html#cb1545-3" aria-hidden="true" tabindex="-1"></a>  here,        <span class="co"># chemins de fichiers relatifs </span></span>
<span id="cb1545-4"><a href="epicurves.html#cb1545-4" aria-hidden="true" tabindex="-1"></a>  lubridate,   <span class="co"># travailler avec des dates/epiweeks</span></span>
<span id="cb1545-5"><a href="epicurves.html#cb1545-5" aria-hidden="true" tabindex="-1"></a>  aweek,       <span class="co"># paquet alternatif pour travailler avec les dates/semaines</span></span>
<span id="cb1545-6"><a href="epicurves.html#cb1545-6" aria-hidden="true" tabindex="-1"></a>  incidence2,  <span class="co"># épicurves de données linelist</span></span>
<span id="cb1545-7"><a href="epicurves.html#cb1545-7" aria-hidden="true" tabindex="-1"></a>  i2extras,    <span class="co"># supplément à incidence2</span></span>
<span id="cb1545-8"><a href="epicurves.html#cb1545-8" aria-hidden="true" tabindex="-1"></a>  stringr,      <span class="co"># recherche et manipulation de chaînes de caractères</span></span>
<span id="cb1545-9"><a href="epicurves.html#cb1545-9" aria-hidden="true" tabindex="-1"></a>  forcats,      <span class="co"># travail avec des facteurs</span></span>
<span id="cb1545-10"><a href="epicurves.html#cb1545-10" aria-hidden="true" tabindex="-1"></a>  RColorBrewer, <span class="co"># palettes de couleurs de colorbrewer2.org</span></span>
<span id="cb1545-11"><a href="epicurves.html#cb1545-11" aria-hidden="true" tabindex="-1"></a>  tidyverse     <span class="co"># gestion des données + graphiques ggplot2</span></span>
<span id="cb1545-12"><a href="epicurves.html#cb1545-12" aria-hidden="true" tabindex="-1"></a>) </span></code></pre></div>
</div>
<div id="importer-des-données-7" class="section level3 unnumbered">
<h3>Importer des données</h3>
<p>Deux exemples de jeux de données sont utilisés dans cette section :</p>
<ul>
<li>Liste de cas individuels d’une épidémie simulée.<br />
</li>
<li>Comptage agrégé par hôpital à partir de la même épidémie simulée.</li>
</ul>
<p>Les jeux de données sont importés à l’aide de la fonction <code>import()</code> du paquetage <strong>rio</strong>. Voir la page <a href="import_export.html#import_export">Importation et exportation</a> pour les différentes maniéres d’importer des données.</p>
<p><strong>Liste de cas</strong></p>
<p>Nous importons le jeu de données des cas d’une épidémie d’Ebola simulée. Si vous souhaitez télécharger les données pour les suivre pas à pas, consultez les instructions de la page <a href="#date_used">Télécharger le manuel et les données</a>. Nous supposons que le fichier est dans le répertoire de travail, donc aucun sous-dossier n’est spécifié dans ce chemin de fichier.</p>
<div class="sourceCode" id="cb1546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1546-1"><a href="epicurves.html#cb1546-1" aria-hidden="true" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;linelist_cleaned.xlsx&quot;</span>)</span></code></pre></div>
<p>Les 50 premiéres lignes sont affichées ci-dessous.</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ab8bab31b641f04d88d2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ab8bab31b641f04d88d2">{"x":{"filter":"none","vertical":false,"data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca","2978ac","57a565","fc15ef","2eaa9a","bbfa93","c97dd9","f50e8a","3a7673","7f5a01","ddddee","99e8fa","567136","9371a9","bc2adf","403057","8bd1e8","f327be","42e1a9","90e5fe","959170","8ebf6e","e56412","6d788e","a47529","67be4e","da8ecb","148f18","2cb9a5","f5c142","70a9fe","3ad520","062638","c76676","baacc1","497372","23e499","38cc4a","3789ee","c71dcd","6b70f0"],[4,4,2,3,3,3,4,4,4,4,4,4,6,5,6,9,10,8,7,6,7,6,8,6,10,8,6,12,5,8,7,9,11,5,8,5,6,11,7,9,7,8,9,12,13,9,8,10,8,7],["2014-05-08",null,null,"2014-05-04","2014-05-18","2014-05-03","2014-05-22","2014-05-28",null,null,"2014-05-30","2014-05-28","2014-06-14","2014-06-07","2014-06-09",null,null,null,"2014-06-23","2014-06-18","2014-06-24",null,null,"2014-07-03",null,"2014-07-10","2014-06-14",null,"2014-06-18","2014-06-29","2014-07-02","2014-07-12","2014-07-12","2014-06-13","2014-07-15","2014-06-20",null,null,"2014-07-20",null,"2014-07-12","2014-07-19","2014-07-18","2014-07-18","2014-07-27",null,"2014-07-19","2014-07-26","2014-07-24",null],["2014-05-13","2014-05-13","2014-05-16","2014-05-18","2014-05-21","2014-05-22","2014-05-27","2014-06-02","2014-06-05","2014-06-05","2014-06-06","2014-06-13","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-22","2014-06-23","2014-06-25","2014-06-26","2014-06-28","2014-07-02","2014-07-08","2014-07-09","2014-07-09","2014-07-10","2014-07-12","2014-07-12","2014-07-13","2014-07-13","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-22","2014-07-22","2014-07-24","2014-07-24","2014-07-25","2014-07-25","2014-07-27","2014-07-29","2014-07-30",null,"2014-08-01","2014-08-02","2014-08-03"],["2014-05-15","2014-05-14","2014-05-18","2014-05-20","2014-05-22","2014-05-23","2014-05-29","2014-06-03","2014-06-06","2014-06-07","2014-06-08","2014-06-15","2014-06-17","2014-06-17","2014-06-20","2014-06-19","2014-06-23","2014-06-24","2014-06-27","2014-06-28","2014-06-29","2014-07-03","2014-07-09","2014-07-09","2014-07-11","2014-07-11","2014-07-13","2014-07-14","2014-07-14","2014-07-13","2014-07-14","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-20","2014-07-20","2014-07-22","2014-07-24","2014-07-26","2014-07-24","2014-07-27","2014-07-25","2014-07-27","2014-07-31","2014-08-01","2014-08-03","2014-08-02","2014-08-02","2014-08-04"],[null,"2014-05-18","2014-05-30",null,"2014-05-29","2014-05-24","2014-06-01","2014-06-07","2014-06-18","2014-06-09","2014-06-15",null,"2014-07-09",null,"2014-06-30","2014-07-11","2014-07-01","2014-06-25","2014-07-06","2014-07-02","2014-07-09","2014-07-07","2014-07-20",null,"2014-07-22","2014-07-16","2014-07-14","2014-07-20","2014-07-16","2014-07-19","2014-07-27","2014-07-19",null,"2014-07-26","2014-08-14","2014-08-01","2014-07-23","2014-08-28","2014-07-28","2014-07-19",null,"2014-08-03",null,null,null,"2014-08-06","2014-08-21","2014-09-13","2014-08-04",null],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death","Death","Death","Recover","Recover",null,"Recover",null,null,"Death","Death","Recover",null,null,null,"Death",null,"Death","Death",null,"Death","Recover","Death","Recover","Death","Recover",null,"Death","Recover","Recover","Death",null,null,"Death","Death","Death","Death","Recover",null,"Death","Death"],["m","f","m","f","m","f","f","f","m","f","m","m","m","f","f","m","f","f","f","f","m","m","f","m","f","m","m","f","m","f","f","f","m","m","f","m","f","f","f","m","f","m","f","m","m","f","m","f","m","m"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[2,3,56,18,3,16,16,0,61,27,12,42,19,7,7,13,35,17,11,11,19,54,14,28,6,3,31,6,67,14,10,21,20,45,1,12,3,15,20,36,7,13,14,3,10,1,0,20,26,14],["0-4","0-4","50-69","15-19","0-4","15-19","15-19","0-4","50-69","20-29","10-14","30-49","15-19","5-9","5-9","10-14","30-49","15-19","10-14","10-14","15-19","50-69","10-14","20-29","5-9","0-4","30-49","5-9","50-69","10-14","10-14","20-29","20-29","30-49","0-4","10-14","0-4","15-19","20-29","30-49","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-29","20-29","10-14"],["0-4","0-4","55-59","15-19","0-4","15-19","15-19","0-4","60-64","25-29","10-14","40-44","15-19","5-9","5-9","10-14","35-39","15-19","10-14","10-14","15-19","50-54","10-14","25-29","5-9","0-4","30-34","5-9","65-69","10-14","10-14","20-24","20-24","45-49","0-4","10-14","0-4","15-19","20-24","35-39","5-9","10-14","10-14","0-4","10-14","0-4","0-4","20-24","25-29","10-14"],["Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital","Missing","Missing","Missing","Missing","Port Hospital","Military Hospital","Missing","Missing","Other","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)","Missing","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Central Hospital","Military Hospital","Central Hospital","Missing","Military Hospital","Other","Missing","Missing","Port Hospital","Port Hospital","Port Hospital","Missing","Central Hospital","Military Hospital","Other","Other","Other","Missing","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","Missing"],[-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2363711169728,-13.2228638912441,-13.222625321098,-13.2331547837254,-13.2320975453153,-13.2225511595637,-13.2572163655863,-13.2206286746001,-13.253989309478,-13.2385127873491,-13.209391925612,-13.2157278814899,-13.2243437095992,-13.2336087079551,-13.21422143145,-13.2339681355349,-13.2535640411465,-13.2250089377786,-13.2160657166043,-13.2680671272333,-13.2266742923612,-13.2160179088168,-13.2482584611565,-13.2156319199566,-13.2142410663192,-13.2614879104088,-13.2452992638476,-13.2630592726116,-13.2343341712241,-13.2199077448676,-13.2227293309912,-13.2343062806506,-13.218781651651,-13.2483677722899,-13.2097478342339,-13.2680867723786,-13.2587535457526,-13.262635786914,-13.2697246824573,-13.2209026809759,-13.2330734719715,-13.2680923666905,-13.2547212675054,-13.2573683214693,-13.2137356012883,-13.2175973322257,-13.2486407324245],[8.46897295100924,8.45171855856465,8.46481700596819,8.4754761613651,8.46082377490923,8.46183062600728,8.46272931462646,8.46144367534271,8.46191259217774,8.47292327643506,8.48401630165138,8.45837125340844,8.47761705512509,8.47570184950483,8.47779946878972,8.47145134147474,8.47804840685363,8.48528034195779,8.46957530395867,8.45957352078114,8.47404889511544,8.48802917129884,8.473437335922,8.48408263734462,8.46242233645879,8.47026822126572,8.46398447480533,8.4641347894342,8.45623094629607,8.48334624336805,8.47493999153642,8.47832062438022,8.4693933891765,8.48480589906514,8.47121232619015,8.48438437371817,8.48466158574339,8.47714159984428,8.46238127010609,8.45568597813113,8.4632880274758,8.47940722413856,8.46353857052336,8.46178968158864,8.47508713872833,8.45825808128071,8.4532568143863,8.4732571907655,8.47911586641933,8.48480340615605],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null,"996f3a","133ee7","37a6f6","9f6884","4802b1",null,null,null,"a75c7f","8e104d","ab634e",null,null,"b799eb",null,"5d9e4d","a15e13",null,"ea3740","beb26e","567136","894024","36e2e7","a2086d","7baf73","eb2277",null,null,"d6584f",null,"312ecf","52ea64","cfd79c","d145b7","174288",null,"53608c","3b096b","f5c142",null],["other",null,null,"other","other","other","other","other",null,null,"other","other","other","other","other",null,null,null,"other","other","other",null,null,"other",null,"other","other",null,"other","funeral","other","funeral","other","other","other","funeral",null,null,"other",null,"other","other","other","other","other",null,"funeral","other","other",null],[27,25,91,41,36,56,47,0,86,69,67,84,68,44,34,66,78,47,53,47,71,86,53,69,38,46,68,37,100,56,50,57,65,72,29,69,37,48,54,71,47,61,47,35,53,16,13,59,69,67],[48,59,238,135,71,116,87,11,226,174,112,186,174,90,91,152,214,137,117,131,150,241,131,161,80,69,188,66,233,142,110,182,164,214,26,157,39,154,133,168,100,125,123,67,134,31,36,125,183,169],[22,22,21,23,23,21,21,22,22,22,22,22,22,21,23,22,23,21,22,23,21,23,21,24,23,22,24,23,20,24,24,20,24,21,22,21,23,22,23,23,23,22,23,22,22,22,23,22,22,22],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","no","no","no","no","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","no","yes","no",null,"no","no","no","yes","no",null,"no","no","yes",null,null,"no","no",null,"no","no",null,null,"no","no",null,"no","no",null,"no","yes","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes",null,"yes","yes","yes","yes","yes",null,"yes","yes","yes",null,null,"yes","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","yes","yes","yes","no",null],["no",null,null,"no","no","no",null,"no","no","no","no","no","no","no","no","yes","no","no",null,"no","no","no","no","no",null,"no","no","no",null,null,"no","no",null,"no","no",null,null,"yes","yes",null,"no","no",null,"no","no","no","no","no","no",null],["yes",null,null,"no","yes","yes",null,"yes","yes","no","yes","no","no","no","yes","no","no","no",null,"no","yes","no","no","no",null,"no","no","no",null,null,"no","yes",null,"yes","yes",null,null,"yes","yes",null,"yes","yes",null,"yes","yes","no","yes","yes","yes",null],[36.8,36.9,36.9,36.8,36.9,37.6,37.3,37,36.4,35.9,36.5,36.9,36.5,37.1,36.5,37.3,37,38,38,36,37,36.7,36.9,36.5,37,36.5,37.6,36.6,36.6,36.2,36.4,37.1,37.5,37.5,37.4,36.9,36.4,37.3,37,37.8,36.5,37.5,36.7,37,37.3,36.6,36.5,36.6,37.6,36.8],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55","16:03","11:14","12:42","11:06","09:10","08:45",null,"15:41","13:34","18:58","12:43","16:33","14:29","07:18","08:11","16:32","16:17","07:32","17:45",null,"13:24","14:43","02:33","11:36","17:28","16:27",null,"20:49",null,"11:38","14:25","13:42","21:22","13:33","19:06","17:14","20:09",null,"10:23","09:09"],[117.1875,71.8184429761563,16.0652496292635,22.4965706447188,71.4144019043841,41.6171224732461,62.0953890870657,0,16.8376536925366,22.7903289734443,53.4119897959184,24.2802636142907,22.4600343506408,54.320987654321,41.0578432556455,28.5664819944598,17.0320552013276,25.0412914912888,38.7172182043977,27.3876813705495,31.5555555555556,14.8069075945662,30.8839811199813,26.6193433895297,59.375,96.6183574879227,19.2394748755093,84.9403122130395,18.4199377406104,27.7722674072605,41.3223140495868,17.2080666586161,24.1671624033314,15.7218971089178,428.994082840237,27.9930220292912,243.261012491782,20.2395007589813,30.527446435638,25.15589569161,47,39.04,31.0661643201798,77.9683671196257,29.5165961238583,166.493236212279,100.308641975309,37.76,20.6037803457852,23.458562375267],[2,1,2,2,1,1,2,1,1,2,2,2,1,0,2,0,1,1,2,2,1,1,1,0,2,1,1,2,1,0,0,2,1,1,2,2,1,0,2,2,0,2,0,0,2,2,null,1,0,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p><strong>Comptes de cas agrégés par hôpital</strong></p>
<p>Pour les besoins du manuel, le jeu de données des comptages hebdomadaires agrégés par hôpital est créé à partir de la <code>linelist</code> avec le code suivant.</p>
<div class="sourceCode" id="cb1547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1547-1"><a href="epicurves.html#cb1547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importez les données de comptage dans R</span></span>
<span id="cb1547-2"><a href="epicurves.html#cb1547-2" aria-hidden="true" tabindex="-1"></a>count_data <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1547-3"><a href="epicurves.html#cb1547-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hospital, date_hospitalisation) <span class="sc">%&gt;%</span> </span>
<span id="cb1547-4"><a href="epicurves.html#cb1547-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_cases =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1547-5"><a href="epicurves.html#cb1547-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date_hospitalisation <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2013-06-01&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1547-6"><a href="epicurves.html#cb1547-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Les 50 premiéres lignes sont affichées ci-dessous :</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-912a94524ca8604c76b7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-912a94524ca8604c76b7">{"x":{"filter":"none","vertical":false,"data":[["Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital"],["2014-05-06","2014-05-10","2014-05-13","2014-05-28","2014-06-06","2014-06-09","2014-06-14","2014-06-19","2014-07-09","2014-07-10","2014-07-11","2014-07-13","2014-07-14","2014-07-15","2014-07-17","2014-07-19","2014-07-27","2014-07-30","2014-08-01","2014-08-02","2014-08-04","2014-08-05","2014-08-07","2014-08-09","2014-08-12","2014-08-14","2014-08-15","2014-08-16","2014-08-17","2014-08-18","2014-08-19","2014-08-20","2014-08-21","2014-08-22","2014-08-23","2014-08-24","2014-08-26","2014-08-28","2014-08-29","2014-08-30","2014-08-31","2014-09-01","2014-09-02","2014-09-03","2014-09-04","2014-09-05","2014-09-06","2014-09-07","2014-09-09","2014-09-10"],[1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,2,1,1,2,1,3,1,1,1,2,3,2,2,2,1,2,2,2,1,2,3,3,2,1,1,2,3,2,2,1]],"container":"<table class=\"white-space : nowrap\">\n  <thead>\n    <tr>\n      <th>hospital<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>n_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="définir-les-paramétres" class="section level3 unnumbered">
<h3>Définir les paramétres</h3>
<p>Pour la production d’un rapport, vous pouvez souhaiter définir des paramétres modifiables tels que la date à laquelle les données sont actuelles (la “date des données”). Vous pouvez ensuite faire référence à l’objet <code>data_date</code> dans votre code lorsque vous appliquez des filtres ou dans des légendes dynamiques.</p>
<div class="sourceCode" id="cb1548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1548-1"><a href="epicurves.html#cb1548-1" aria-hidden="true" tabindex="-1"></a><span class="do">## définit la date du rapport pour le rapport</span></span>
<span id="cb1548-2"><a href="epicurves.html#cb1548-2" aria-hidden="true" tabindex="-1"></a><span class="do">## note : peut étre défini à Sys.Date() pour la date actuelle</span></span>
<span id="cb1548-3"><a href="epicurves.html#cb1548-3" aria-hidden="true" tabindex="-1"></a>data_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-05-15&quot;</span>)</span></code></pre></div>
</div>
<div id="vérifier-les-dates" class="section level3 unnumbered">
<h3>Vérifier les dates</h3>
<p>Vérifiez que chaque colonne de date pertinente est de la classe Date et posséde une plage de valeurs appropriée. Vous pouvez le faire simplement en utilisant <code>hist()</code> pour les histogrammes, ou <code>range()</code> avec <code>na.rm=TRUE</code>, ou avec <code>ggplot()</code> comme ci-dessous.</p>
<div class="sourceCode" id="cb1549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1549-1"><a href="epicurves.html#cb1549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vérifier la plage de dates d&#39;apparition</span></span>
<span id="cb1549-2"><a href="epicurves.html#cb1549-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> linelist)<span class="sc">+</span></span>
<span id="cb1549-3"><a href="epicurves.html#cb1549-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> date_onset))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1146-1.png" width="50%" /></p>
<!-- ======================================================= -->
</div>
</div>
<div id="epicurves-avec-le-paquet-incidence2" class="section level2" number="33.2">
<h2><span class="header-section-number">33.2</span> Epicurves avec le paquet <strong>incidence2</strong></h2>
<p>Nous démontrons ci-dessous comment faire des épicurves en utilisant le paquet <strong>incidence2</strong>. Les auteurs de ce paquet ont essayé de permettre à l’utilisateur de créer et de modifier des épicurves sans avoir besoin de connaître la syntaxe de <strong>ggplot2</strong>. Une grande partie de cette page est adaptée des vignettes du paquet, qui peuvent étre trouvées sur la page <strong>incidence2</strong> <a href="https://github.com/reconhub/incidence2">github</a>.</p>
<!-- ======================================================= -->
<div id="exemple-simple" class="section level3 unnumbered">
<h3>Exemple simple</h3>
<p><strong>2 étapes sont nécessaires pour tracer une courbe épidémique avec le paquet <em>incidence2</em>:</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Créer</strong> un objet <em>incidence</em> (en utilisant la fonction <code>incidence()</code>)
<ul>
<li>Fournir les données<br />
</li>
<li>Spécifiez la colonne de date à <code>date_index =</code><br />
</li>
<li>Spécifiez l’“intervalle” dans lequel les cas doivent étre agrégés (quotidien, hebdomadaire, mensuel..)</li>
<li>Spécifiez toutes les colonnes de regroupement (par exemple, sexe, hôpital, résultat).<br />
</li>
</ul></li>
<li><strong>Graphique</strong> de l’objet d’incidence
<ul>
<li>Spécifier les étiquettes, les couleurs, les titres, etc.</li>
</ul></li>
</ol>
<p>Ci-dessous, nous chargeons le paquet <strong>incidence2</strong>, créons l’objet incidence à partir de la <code>linelist</code> sur la colonne <code>date_onset</code> et agrégeons les cas par semaine. Nous imprimons ensuite un résumé de l’objet d’incidence.</p>
<div class="sourceCode" id="cb1550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1550-1"><a href="epicurves.html#cb1550-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement du paquet incidence2</span></span>
<span id="cb1550-2"><a href="epicurves.html#cb1550-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(incidence2)</span>
<span id="cb1550-3"><a href="epicurves.html#cb1550-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1550-4"><a href="epicurves.html#cb1550-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1550-5"><a href="epicurves.html#cb1550-5" aria-hidden="true" tabindex="-1"></a><span class="co"># crée l&#39;objet incidence, en agrégeant les cas par jour</span></span>
<span id="cb1550-6"><a href="epicurves.html#cb1550-6" aria-hidden="true" tabindex="-1"></a>epi_day <span class="ot">&lt;-</span> <span class="fu">incidence</span>( <span class="co"># create incidence object</span></span>
<span id="cb1550-7"><a href="epicurves.html#cb1550-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> linelist, <span class="co"># dataset</span></span>
<span id="cb1550-8"><a href="epicurves.html#cb1550-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>, <span class="co"># colonne de date</span></span>
<span id="cb1550-9"><a href="epicurves.html#cb1550-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span> <span class="co"># intervalle de regroupement par semaine</span></span>
<span id="cb1550-10"><a href="epicurves.html#cb1550-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>L’objet <strong>incidence2</strong> lui-même ressemble à un tibble (comme un cadre de données) et peut étre imprimé ou manipulé comme un cadre de données.</p>
<div class="sourceCode" id="cb1551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1551-1"><a href="epicurves.html#cb1551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(epi_day)</span></code></pre></div>
<pre><code>## [1] &quot;incidence2&quot; &quot;data.frame&quot;</code></pre>
<p>Voici à quoi il ressemble une fois imprimé. Il posséde une colonne <code>date_index</code> et une colonne <code>count</code>.</p>
<div class="sourceCode" id="cb1553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1553-1"><a href="epicurves.html#cb1553-1" aria-hidden="true" tabindex="-1"></a>epi_day</span></code></pre></div>
<pre><code>## # incidence:  56 x 3
## # count vars: date_onset
##    date_index count_variable count
##  * &lt;isowk&gt;    &lt;chr&gt;          &lt;int&gt;
##  1 2014-W15   date_onset         1
##  2 2014-W16   date_onset         1
##  3 2014-W17   date_onset         5
##  4 2014-W18   date_onset         4
##  5 2014-W19   date_onset        12
##  6 2014-W20   date_onset        17
##  7 2014-W21   date_onset        13
##  8 2014-W22   date_onset        18
##  9 2014-W23   date_onset        22
## 10 2014-W24   date_onset        22
## # ℹ 46 more rows</code></pre>
<p>Vous pouvez également imprimer un résumé de l’objet :</p>
<div class="sourceCode" id="cb1555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1555-1"><a href="epicurves.html#cb1555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imprimer le résumé de l&#39;objet incidence</span></span>
<span id="cb1555-2"><a href="epicurves.html#cb1555-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(epi_day)</span></code></pre></div>
<pre><code>## From:          2014-W15
## To:            2015-W18
## Groups:        
## 
## Total observations:
## # A data frame: 1 × 2
##   count_variable count
##   &lt;chr&gt;          &lt;int&gt;
## 1 date_onset      5632</code></pre>
<p>Pour <em>tracer</em> l’objet <em>incidence</em>, utilisez <code>plot()</code> sur le <em>nom de l’objet incidence</em>. En arriére-plan, la fonction <code>plot.incidence2()</code> est appelée, donc pour lire la documentation spécifique à <strong>incidence2</strong>, vous devez exécuter <code>éplot.incidence2</code>.</p>
<div class="sourceCode" id="cb1557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1557-1"><a href="epicurves.html#cb1557-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace l&#39;objet incidence</span></span>
<span id="cb1557-2"><a href="epicurves.html#cb1557-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_day)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1151-1.png" width="672" /></p>
<p>Si vous remarquez beaucoup de petites lignes verticales blanches, essayez d’ajuster la taille de votre image. Par exemple, si vous exportez votre tracé avec <code>ggsave()</code>, vous pouvez fournir des nombres à <code>width =</code> et <code>height =</code>. Si vous élargissez le tracé, ces lignes peuvent disparaétre.</p>
</div>
<div id="changer-lintervalle-de-temps-de-lagrégation-des-cas" class="section level3 unnumbered">
<h3>Changer l’intervalle de temps de l’agrégation des cas</h3>
<p>L’argument <code>interval =</code> de <code>incidence()</code> définit comment les observations sont regroupées en barres verticales.</p>
<p><strong>Spécifier l’intervalle</strong></p>
<p><strong>incidence2</strong> offre une flexibilité et une syntaxe compréhensible pour spécifier comment vous voulez regrouper vos cas en barres épicurves. Fournissez une valeur comme celles ci-dessous à l’argument <code>interval =</code>. Vous pouvez écrire n’importe laquelle des valeurs ci-dessous au pluriel (par exemple “semaine<strong>s</strong>”), et vous pouvez ajouter des chiffres avant (par exemple “3 mois”).</p>
<table>
<colgroup>
<col width="34%" />
<col width="65%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument option</th>
<th>Explication complémentaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nombre (1, 7, 13, 14, etc.)</td>
<td>Nombre de jours par intervalle</td>
</tr>
<tr class="even">
<td>“semaine”</td>
<td>Note : le jour de départ du lundi est la valeur par défaut</td>
</tr>
<tr class="odd">
<td>“2 semaines”</td>
<td>ou 3, 4, 5…</td>
</tr>
<tr class="even">
<td>“semaine du dimanche”</td>
<td>semaines commençant le dimanche (pourrait aussi utiliser le jeudi, etc.)</td>
</tr>
<tr class="odd">
<td>“2 semaines de dimanche”</td>
<td>ou 3, 4, 5…</td>
</tr>
<tr class="even">
<td>“MMWRweek”</td>
<td>semaine commençant le dimanche - voir US CDC</td>
</tr>
<tr class="odd">
<td>“mois”</td>
<td>1er du mois</td>
</tr>
<tr class="even">
<td>“trimestre”</td>
<td>1er du mois du trimestre</td>
</tr>
<tr class="odd">
<td>“2 mois”</td>
<td>ou 3, 4, 5…</td>
</tr>
<tr class="even">
<td>“année”</td>
<td>1er jour de l’année civile</td>
</tr>
</tbody>
</table>
<p>Vous trouverez ci-dessous des exemples de l’aspect des différents intervalles lorsqu’ils sont appliqués à la liste de lignes. Notez comment le format et la fréquence par défaut des <em>étiquettes</em> de date sur l’axe des x changent lorsque l’intervalle de date change.</p>
<div class="sourceCode" id="cb1558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1558-1"><a href="epicurves.html#cb1558-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créez les objets d&#39;incidence (avec différents intervalles)</span></span>
<span id="cb1558-2"><a href="epicurves.html#cb1558-2" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb1558-3"><a href="epicurves.html#cb1558-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hebdomadaire (semaine du lundi par défaut)</span></span>
<span id="cb1558-4"><a href="epicurves.html#cb1558-4" aria-hidden="true" tabindex="-1"></a>epi_wk <span class="ot">&lt;-</span> <span class="fu">incidence</span>(linelist, <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="dv">1</span>)</span>
<span id="cb1558-5"><a href="epicurves.html#cb1558-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-6"><a href="epicurves.html#cb1558-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Semaine du dimanche</span></span>
<span id="cb1558-7"><a href="epicurves.html#cb1558-7" aria-hidden="true" tabindex="-1"></a>epi_Sun_wk <span class="ot">&lt;-</span> <span class="fu">incidence</span>(linelist, <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="st">&quot;epiweeks&quot;</span>)</span>
<span id="cb1558-8"><a href="epicurves.html#cb1558-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-9"><a href="epicurves.html#cb1558-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Trois semaines (semaines de lundi par défaut)</span></span>
<span id="cb1558-10"><a href="epicurves.html#cb1558-10" aria-hidden="true" tabindex="-1"></a>epi_2wk <span class="ot">&lt;-</span> <span class="fu">incidence</span>(linelist, <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="st">&quot;weekly&quot;</span>)</span>
<span id="cb1558-11"><a href="epicurves.html#cb1558-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-12"><a href="epicurves.html#cb1558-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Mensuel</span></span>
<span id="cb1558-13"><a href="epicurves.html#cb1558-13" aria-hidden="true" tabindex="-1"></a>epi_month <span class="ot">&lt;-</span> <span class="fu">incidence</span>(linelist, <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="st">&quot;month&quot;</span>)</span>
<span id="cb1558-14"><a href="epicurves.html#cb1558-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-15"><a href="epicurves.html#cb1558-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Trimestrielle</span></span>
<span id="cb1558-16"><a href="epicurves.html#cb1558-16" aria-hidden="true" tabindex="-1"></a>epi_quarter <span class="ot">&lt;-</span> <span class="fu">incidence</span>(linelist, <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="st">&quot;quarter&quot;</span>)</span>
<span id="cb1558-17"><a href="epicurves.html#cb1558-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-18"><a href="epicurves.html#cb1558-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Années</span></span>
<span id="cb1558-19"><a href="epicurves.html#cb1558-19" aria-hidden="true" tabindex="-1"></a>epi_year <span class="ot">&lt;-</span> <span class="fu">incidence</span>(linelist, <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="cb1558-20"><a href="epicurves.html#cb1558-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-21"><a href="epicurves.html#cb1558-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-22"><a href="epicurves.html#cb1558-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracez les objets d&#39;incidence (+ titres pour plus de clarté)</span></span>
<span id="cb1558-23"><a href="epicurves.html#cb1558-23" aria-hidden="true" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb1558-24"><a href="epicurves.html#cb1558-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_wk)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Daily&quot;</span>)</span>
<span id="cb1558-25"><a href="epicurves.html#cb1558-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_Sun_wk)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sunday weeks&quot;</span>)</span>
<span id="cb1558-26"><a href="epicurves.html#cb1558-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_2wk)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Monday Weeks&quot;</span>)</span>
<span id="cb1558-27"><a href="epicurves.html#cb1558-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_month)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Months&quot;</span>)</span>
<span id="cb1558-28"><a href="epicurves.html#cb1558-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_quarter)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Quarters&quot;</span>)</span>
<span id="cb1558-29"><a href="epicurves.html#cb1558-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epi_year)<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Years&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/incidence-1.png" width="50%" /><img src="_main_files/figure-html/incidence-2.png" width="50%" /><img src="_main_files/figure-html/incidence-3.png" width="50%" /><img src="_main_files/figure-html/incidence-4.png" width="50%" /><img src="_main_files/figure-html/incidence-5.png" width="50%" /><img src="_main_files/figure-html/incidence-6.png" width="50%" /></p>
<!-- **Débuter au premier cas** -->
<!-- Si vous voulez que les intervalles commencent au premier cas, vous pouvez ajouter l'argument `standard = TRUE` à la commande `incidence()`. Cela ne fonctionne que si l'intervalle est soit "semaine", "mois", "trimestre" ou "année".   -->
<p><strong>Premiére date</strong></p>
<p>Vous pouvez optionnellement spécifier une valeur de la classe Date (par exemple <code>as.Date("2016-05-01")</code>) à <code>firstdate =</code> dans la commande <code>incidence()</code>. Si elle est donnée, les données seront rognées à cette plage et les intervalles commenceront à cette date.</p>
</div>
<div id="groupes" class="section level3 unnumbered">
<h3>Groupes</h3>
<p>Les groupes sont spécifiés dans la commande <code>incidence()</code>, et peuvent étre utilisés pour colorer les barres ou pour facetter les données. Pour spécifier des groupes dans vos données, fournissez le(s) nom(s) de colonne(s) à l’argument <code>groups =</code> de la commande <code>incidence()</code> (sans guillemets autour du nom de colonne). Si vous spécifiez plusieurs colonnes, mettez leurs noms dans <code>c()</code>.</p>
<p>Vous pouvez spécifier que les cas avec des valeurs manquantes dans les colonnes de regroupement soient listés comme un groupe distinct <code>NA</code> en mettant <code>na_as_group = TRUE</code>. Sinon, ils seront exclus du graphique.</p>
<ul>
<li><p>Pour <em>colorer les barres par une colonne de regroupement</em>, vous devez à nouveau fournir le nom de la colonne à <code>fill =</code> dans la commande <code>plot()</code>.</p></li>
<li><p>Pour <em>faire des facettes basées sur une colonne de regroupement</em>, voir la section ci-dessous sur les facettes avec <strong>incidence2</strong>.</p></li>
</ul>
<p>Dans l’exemple ci-dessous, les cas de l’ensemble de l’épidémie sont groupés par leur catégorie d’âge. Les valeurs manquantes sont incluses en tant que groupe. L’intervalle d’épicurve est des semaines.</p>
<div class="sourceCode" id="cb1559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1559-1"><a href="epicurves.html#cb1559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créez un objet incidence, avec des données groupées par catégorie d&#39;âge</span></span>
<span id="cb1559-2"><a href="epicurves.html#cb1559-2" aria-hidden="true" tabindex="-1"></a>age_outbreak <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1559-3"><a href="epicurves.html#cb1559-3" aria-hidden="true" tabindex="-1"></a>  linelist, <span class="co"># jeu de données</span></span>
<span id="cb1559-4"><a href="epicurves.html#cb1559-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>, <span class="co"># colonne de date</span></span>
<span id="cb1559-5"><a href="epicurves.html#cb1559-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># agrégation hebdomadaire des cas du lundi</span></span>
<span id="cb1559-6"><a href="epicurves.html#cb1559-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="st">&quot;age_cat&quot;</span>) <span class="co">#, # age_cat est défini comme un groupe</span></span>
<span id="cb1559-7"><a href="epicurves.html#cb1559-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#na_as_group = TRUE) # les valeurs manquantes se voient attribuer leur propre groupe</span></span>
<span id="cb1559-8"><a href="epicurves.html#cb1559-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1559-9"><a href="epicurves.html#cb1559-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1559-10"><a href="epicurves.html#cb1559-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracez l&#39;objet d&#39;incidence groupée</span></span>
<span id="cb1559-11"><a href="epicurves.html#cb1559-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1559-12"><a href="epicurves.html#cb1559-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(age_outbreak) <span class="sc">+</span>                                    <span class="co"># objet d&#39;incidence avec age_cat comme groupe</span></span>
<span id="cb1559-13"><a href="epicurves.html#cb1559-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_col</span>(<span class="fu">aes</span>(date_index, count, <span class="at">fill =</span> age_cat)) <span class="sc">+</span> <span class="co"># age_cat est utilisé pour la couleur de remplissage des barres (doit avoir été défini comme une colonne de groupes ci-dessus)</span></span>
<span id="cb1559-14"><a href="epicurves.html#cb1559-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Age Category&quot;</span>,                        <span class="co"># change le titre de la légende de &quot;age_cat&quot; par défaut (c&#39;est une modification de ggplot2)</span></span>
<span id="cb1559-15"><a href="epicurves.html#cb1559-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb1559-16"><a href="epicurves.html#cb1559-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb1559-17"><a href="epicurves.html#cb1559-17" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1152-1.png" width="672" /></p>
<div class="sourceCode" id="cb1560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1560-1"><a href="epicurves.html#cb1560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracez l&#39;objet d&#39;incidence groupée</span></span>
<span id="cb1560-2"><a href="epicurves.html#cb1560-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(</span></span>
<span id="cb1560-3"><a href="epicurves.html#cb1560-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  age_outbreak # objet d&#39;incidence avec age_cat comme groupe</span></span>
<span id="cb1560-4"><a href="epicurves.html#cb1560-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  )+  age_cat est utilisé pour la couleur de remplissage des barres (doit avoir été défini comme une colonne de groupes ci-dessus)</span></span>
<span id="cb1560-5"><a href="epicurves.html#cb1560-5" aria-hidden="true" tabindex="-1"></a><span class="co">#labs(fill = &quot;Age Category&quot;) # change le titre de la légende de &quot;age_cat&quot; par défaut (c&#39;est une modification de ggplot2)</span></span></code></pre></div>
<p><span style="color : darkgreen ;"><strong><em>ATTENTION:</em></strong> Changez le titre de la légende en ajoutant <code>+</code> la commande <strong>ggplot2</strong> <code>labs(fill = "your title")</code> à votre graphe <strong>incidence2</strong>.</span></p>
<p>Vous pouvez également afficher les barres groupées côte à côte en définissant <code>stack = FALSE</code> dans <code>plot()</code>, comme indiqué ci-dessous :</p>
<div class="sourceCode" id="cb1561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1561-1"><a href="epicurves.html#cb1561-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créez un objet d&#39;incidence pour les comptes mensuels. </span></span>
<span id="cb1561-2"><a href="epicurves.html#cb1561-2" aria-hidden="true" tabindex="-1"></a>monthly_gender <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1561-3"><a href="epicurves.html#cb1561-3" aria-hidden="true" tabindex="-1"></a> linelist,</span>
<span id="cb1561-4"><a href="epicurves.html#cb1561-4" aria-hidden="true" tabindex="-1"></a> <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>,</span>
<span id="cb1561-5"><a href="epicurves.html#cb1561-5" aria-hidden="true" tabindex="-1"></a> <span class="at">interval =</span> <span class="st">&quot;month&quot;</span>,</span>
<span id="cb1561-6"><a href="epicurves.html#cb1561-6" aria-hidden="true" tabindex="-1"></a> <span class="at">groups =</span> <span class="st">&quot;gender&quot;</span> <span class="co"># définit le genre comme colonne de regroupement</span></span>
<span id="cb1561-7"><a href="epicurves.html#cb1561-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1561-8"><a href="epicurves.html#cb1561-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1561-9"><a href="epicurves.html#cb1561-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_gender) <span class="sc">+</span> <span class="co"># objet d&#39;incidence</span></span>
<span id="cb1561-10"><a href="epicurves.html#cb1561-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_col</span>(<span class="fu">aes</span>(date_index, count, <span class="at">fill =</span> gender), <span class="co"># affichage de barres colorées par sexe</span></span>
<span id="cb1561-11"><a href="epicurves.html#cb1561-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span>  <span class="co"># côte à côte (non empilées)</span></span>
<span id="cb1561-12"><a href="epicurves.html#cb1561-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span>, </span>
<span id="cb1561-13"><a href="epicurves.html#cb1561-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>, </span>
<span id="cb1561-14"><a href="epicurves.html#cb1561-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1153-1.png" width="672" /></p>
<div class="sourceCode" id="cb1562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1562-1"><a href="epicurves.html#cb1562-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(</span></span>
<span id="cb1562-2"><a href="epicurves.html#cb1562-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  monthly_gender, # objet d&#39;incidence</span></span>
<span id="cb1562-3"><a href="epicurves.html#cb1562-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  fill = &quot;gender&quot;, # affichage de barres colorées par sexe</span></span>
<span id="cb1562-4"><a href="epicurves.html#cb1562-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  stack = FALSE) # côte à côte (non empilées)</span></span></code></pre></div>
<p>Vous pouvez définir l’argument <code>na_as_group =</code> à FALSE dans la commande <code>incidence()</code> pour supprimer les lignes avec des valeurs manquantes du graphique.</p>
</div>
<div id="données-filtrées" class="section level3 unnumbered">
<h3>Données filtrées</h3>
<p>Pour tracer l’épicurve d’un sous-ensemble de données :</p>
<ol style="list-style-type: decimal">
<li>Filtrer les données de la liste de lignes<br />
</li>
<li>Fournissez les données filtrées à la commande <code>incidence()</code>.<br />
</li>
<li>Tracez l’objet d’incidence</li>
</ol>
<p>L’exemple ci-dessous utilise des données filtrées pour ne montrer que les cas de l’hôpital central.</p>
<div class="sourceCode" id="cb1563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1563-1"><a href="epicurves.html#cb1563-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filtrez la liste de lignes</span></span>
<span id="cb1563-2"><a href="epicurves.html#cb1563-2" aria-hidden="true" tabindex="-1"></a>central_data <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1563-3"><a href="epicurves.html#cb1563-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hospital <span class="sc">==</span> <span class="st">&quot;Central Hospital&quot;</span>)</span>
<span id="cb1563-4"><a href="epicurves.html#cb1563-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-5"><a href="epicurves.html#cb1563-5" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un objet d&#39;incidence en utilisant les données filtrées</span></span>
<span id="cb1563-6"><a href="epicurves.html#cb1563-6" aria-hidden="true" tabindex="-1"></a>central_outbreak <span class="ot">&lt;-</span> <span class="fu">incidence</span>(central_data, <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>, <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>)</span>
<span id="cb1563-7"><a href="epicurves.html#cb1563-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1563-8"><a href="epicurves.html#cb1563-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;objet d&#39;incidence</span></span>
<span id="cb1563-9"><a href="epicurves.html#cb1563-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(central_outbreak, <span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas à l&#39;hôpital central&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1154-1.png" width="672" /></p>
</div>
<div id="comptages-agrégés" class="section level3 unnumbered">
<h3>Comptages agrégés</h3>
<p>Si vos données d’origine sont agrégées (comptes), fournissez le nom de la colonne qui contient les comptes de cas à l’argument <code>count =</code> lorsque vous créez l’objet d’incidence avec <code>incidence()</code>.</p>
<p>Par exemple, ce cadre de données <code>count_data</code> est la liste de lignes agrégée en comptes quotidiens par hôpital. Les 50 premiéres lignes ressemblent à ceci :</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-43e6a3a4c0a07fcf9851" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-43e6a3a4c0a07fcf9851">{"x":{"filter":"none","vertical":false,"data":[["Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital"],["2014-05-06","2014-05-10","2014-05-13","2014-05-28","2014-06-06","2014-06-09","2014-06-14","2014-06-19","2014-07-09","2014-07-10","2014-07-11","2014-07-13","2014-07-14","2014-07-15","2014-07-17","2014-07-19","2014-07-27","2014-07-30","2014-08-01","2014-08-02","2014-08-04","2014-08-05","2014-08-07","2014-08-09","2014-08-12","2014-08-14","2014-08-15","2014-08-16","2014-08-17","2014-08-18","2014-08-19","2014-08-20","2014-08-21","2014-08-22","2014-08-23","2014-08-24","2014-08-26","2014-08-28","2014-08-29","2014-08-30","2014-08-31","2014-09-01","2014-09-02","2014-09-03","2014-09-04","2014-09-05","2014-09-06","2014-09-07","2014-09-09","2014-09-10"],[1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,2,1,1,2,1,3,1,1,1,2,3,2,2,2,1,2,2,2,1,2,3,3,2,1,1,2,3,2,2,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>hospital<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>n_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Si vous commencez votre analyse avec des données de comptage quotidiennes comme l’ensemble de données ci-dessus, votre commande <code>incidence()</code> pour convertir ces données en une épicurve hebdomadaire par hôpital ressemblerait à ceci :</p>
<div class="sourceCode" id="cb1564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1564-1"><a href="epicurves.html#cb1564-1" aria-hidden="true" tabindex="-1"></a>epi_counts <span class="ot">&lt;-</span> <span class="fu">incidence</span>( <span class="co"># créer un objet d&#39;incidence hebdomadaire</span></span>
<span id="cb1564-2"><a href="epicurves.html#cb1564-2" aria-hidden="true" tabindex="-1"></a>  count_data, <span class="co"># ensemble de données avec les comptes agrégés par jour</span></span>
<span id="cb1564-3"><a href="epicurves.html#cb1564-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_hospitalisation&quot;</span>, <span class="co"># colonne avec les dates</span></span>
<span id="cb1564-4"><a href="epicurves.html#cb1564-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">counts =</span> <span class="st">&quot;n_cases&quot;</span>, <span class="co"># colonne avec les comptages</span></span>
<span id="cb1564-5"><a href="epicurves.html#cb1564-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># agréger les comptages quotidiens jusqu&#39;aux semaines</span></span>
<span id="cb1564-6"><a href="epicurves.html#cb1564-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="st">&quot;hospital&quot;</span> <span class="co"># groupe par hôpital</span></span>
<span id="cb1564-7"><a href="epicurves.html#cb1564-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1564-8"><a href="epicurves.html#cb1564-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1564-9"><a href="epicurves.html#cb1564-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1564-10"><a href="epicurves.html#cb1564-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(epi_counts) <span class="sc">+</span> <span class="co"># objet d&#39;incidence</span></span>
<span id="cb1564-11"><a href="epicurves.html#cb1564-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_col</span>(<span class="fu">aes</span>(date_index, count, <span class="at">fill =</span> hospital) <span class="co"># affichage de barres colorées par hôpital</span></span>
<span id="cb1564-12"><a href="epicurves.html#cb1564-12" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span>  </span>
<span id="cb1564-13"><a href="epicurves.html#cb1564-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Hospital&quot;</span>, </span>
<span id="cb1564-14"><a href="epicurves.html#cb1564-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>, </span>
<span id="cb1564-15"><a href="epicurves.html#cb1564-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb1564-16"><a href="epicurves.html#cb1564-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1156-1.png" width="672" /></p>
<div class="sourceCode" id="cb1565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1565-1"><a href="epicurves.html#cb1565-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracez la courbe d&#39;incidence hebdomadaire de l&#39;épi, avec des barres empilées par hôpital.</span></span>
<span id="cb1565-2"><a href="epicurves.html#cb1565-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(epi_counts, # objet incidence</span></span>
<span id="cb1565-3"><a href="epicurves.html#cb1565-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     fill = hospital) # colorer les barres par hôpital</span></span></code></pre></div>
</div>
<div id="facettespetits-multiples" class="section level3 unnumbered">
<h3>Facettes/petits multiples</h3>
<p>Pour facetter les données par groupe (i.e. produire des “petits multiples”) :</p>
<ol style="list-style-type: decimal">
<li>Spécifiez la colonne de facettes à <code>groups =</code> lorsque vous créez l’objet d’incidence.<br />
</li>
<li>Utilisez la commande <code>facet_plot()</code> au lieu de <code>plot()</code>.<br />
</li>
<li>spécifiez les colonnes de regroupement à utiliser comme <code>fill =</code> et celles à utiliser comme <code>facets =</code>.</li>
</ol>
<p>Ci-dessous, nous avons défini les deux colonnes <code>hospital</code> et <code>outcome</code> comme colonnes de regroupement dans la commande <code>incidence()</code>. Ensuite, dans <code>facet_plot()</code> nous traçons l’épicurve, en spécifiant que nous voulons une épicurve différente pour chaque hôpital et que dans chaque épicurve les barres doivent étre empilées et colorées par résultat.</p>
<div class="sourceCode" id="cb1566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1566-1"><a href="epicurves.html#cb1566-1" aria-hidden="true" tabindex="-1"></a>epi_wks_hosp_out <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1566-2"><a href="epicurves.html#cb1566-2" aria-hidden="true" tabindex="-1"></a>  linelist, <span class="co"># ensemble de données</span></span>
<span id="cb1566-3"><a href="epicurves.html#cb1566-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>, <span class="co"># colonne de date</span></span>
<span id="cb1566-4"><a href="epicurves.html#cb1566-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;month&quot;</span>, <span class="co"># barres mensuelles  </span></span>
<span id="cb1566-5"><a href="epicurves.html#cb1566-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="fu">c</span>(<span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;hospital&quot;</span>) <span class="co"># le résultat et l&#39;hôpital sont données comme colonnes de regroupement</span></span>
<span id="cb1566-6"><a href="epicurves.html#cb1566-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1566-7"><a href="epicurves.html#cb1566-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1566-8"><a href="epicurves.html#cb1566-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1566-9"><a href="epicurves.html#cb1566-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1566-10"><a href="epicurves.html#cb1566-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(epi_wks_hosp_out) <span class="sc">+</span> </span>
<span id="cb1566-11"><a href="epicurves.html#cb1566-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_col</span>(<span class="fu">aes</span>(date_index, count, <span class="at">fill =</span> outcome )) <span class="sc">+</span></span>
<span id="cb1566-12"><a href="epicurves.html#cb1566-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(<span class="sc">~</span>hospital) <span class="sc">+</span> </span>
<span id="cb1566-13"><a href="epicurves.html#cb1566-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Outcome&quot;</span>, </span>
<span id="cb1566-14"><a href="epicurves.html#cb1566-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, </span>
<span id="cb1566-15"><a href="epicurves.html#cb1566-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb1566-16"><a href="epicurves.html#cb1566-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1157-1.png" width="672" /></p>
<p>Notez que le package <strong>ggtree</strong> (utilisé pour afficher les arbres phylogénétiques) posséde également une fonction <code>facet_plot()</code> - c’est pourquoi nous avons spécifié `incidence2::facet_plot()`` ci-dessus.</p>
</div>
<div id="modifications-avec-plot" class="section level3 unnumbered">
<h3>Modifications avec <code>plot()</code></h3>
<p>Une épicurve produite par <strong>incidence2</strong> peut étre modifiée via ces arguments <em>dans la fonction <code>plot()</code></em>.</p>
<p><strong>Voici les arguments de <code>plot()</code> qui modifient l’apparence des barres:</strong></p>
<table>
<colgroup>
<col width="23%" />
<col width="51%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Description</th>
<th>Exemples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fill =</code></td>
<td>Couleur des barres. Soit un nom de couleur ou un nom de colonne probablement spécifié à <code>groups =</code> dans la commande <code>incidence()</code></td>
<td>fill = “red”<code>, ou</code>fill = gender<code></code>color = <code>|Couleur autour de chaque barre, ou autour de chaque groupement dans une barre|</code>border = “white”<code></code>legend = <code>|Localisation de la légende|Une des options suivantes : "bottom", "top", "left", "right" ou "none".</code>alpha = <code>|Transparence des barres/boîtes|1 est totalement opaque, 0 est totalement transparent</code>width = <code>Valeur entre 0 et 1 indiquant la taille relative des barres par rapport à leur intervalle de temps|</code>width = .7<code></code>show_cases = `</td>
</tr>
</tbody>
</table>
<p><strong>Voici les arguments de <code>plot()</code> qui modifient l’axe des dates:</strong></p>
<table>
<colgroup>
<col width="29%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument(s)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>centre_dates =</code></td>
<td>TRUE/FALSE pour savoir si les dates sont affichôes au centre des barres ou au début des barres.</td>
</tr>
<tr class="even">
<td><code>date_format =</code></td>
<td>Régler le format d’affichage de la date en utilisant la syntaxe strptime (“%”). Ne fonctionne que si <code>centre_dates = FALSE</code> (détails ci-dessous).</td>
</tr>
<tr class="odd">
<td><code>n.breaks =</code></td>
<td>Nombre approximatif de ruptures d’étiquettes sur l’axe des x souhaité.</td>
</tr>
<tr class="even">
<td><code>angle =</code></td>
<td>Angle des étiquettes de date sur l’axe des x (nombre de degrés)</td>
</tr>
<tr class="odd">
<td><code>size =</code></td>
<td>Taille du texte en points</td>
</tr>
</tbody>
</table>
<p>Notez que l’argument <code>date_breaks =</code> ne fonctionne que si <code>centre_dates = FALSE</code>. Fournissez une valeur entre guillemets en utilisant la syntaxe strptime ci-dessous, comme détaillé dans la page <a href="#dates">travailler avec des dates</a>. Vous pouvez utiliser <code>\n</code> pour une “nouvelle ligne”.</p>
<p>%d = Numéro du jour du mois (5, 17, 28, etc.)<br />
%j = Numéro du jour de l’année (jour julien 001-366)<br />
%a = Jour de semaine abrégé (Lun, Mar, Mer, etc.)<br />
%A = Jour de la semaine complet (lundi, mardi, etc.)<br />
%w = Numéro du jour de la semaine (0-6, le dimanche est 0)<br />
%u = Numéro du jour de la semaine (1-7, le lundi est 1)<br />
%W = Numéro de la semaine (00-53, le lundi est le début de la semaine)<br />
%U = Numéro de la semaine (01-53, le dimanche est le début de la semaine)<br />
%m = Numéro du mois (par exemple 01, 02, 03, 04)<br />
%b = Mois abrégé (Jan, Feb, etc.)<br />
%B = Mois complet (janvier, février, etc.)<br />
%y = Année à 2 chiffres (ex. 89)<br />
%Y = Année à 4 chiffres (ex. 1989)<br />
%h = heures (horloge de 24 heures)<br />
%m = minutes<br />
%s = secondes<br />
%z = décalage par rapport à GMT<br />
%Z = fuseau horaire (caractère)</p>
<!-- <span style="color : darkgreen ;">**_TIP:_** Pour des pauses a tous les "n" intervalles (par exemple tous les 4), utilisez `n.breaks = nrow(i)/n` (où "i" est le nom de votre objet d'incidence et "n" est un nombre). Si vos données sont groupées, vous devrez multiplier "n" par le nombre de groupes uniques.</span> -->
<p><strong>Voici les arguments de <code>plot()</code> qui modifient les étiquettes des graphiques:</strong></p>
<table>
<colgroup>
<col width="29%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument(s)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>title =</code></td>
<td>Titre du graphique</td>
</tr>
<tr class="even">
<td><code>xlab =</code></td>
<td>Titre de l’axe des x</td>
</tr>
<tr class="odd">
<td><code>ylab =</code></td>
<td>Titre de l’axe des y</td>
</tr>
<tr class="even">
<td><code>size =</code></td>
<td>Taille du texte de l’axe des x en pts (utilisez theme() de ggplot pour ajuster les autres tailles)</td>
</tr>
</tbody>
</table>
<p>Un exemple utilisant plusieurs des arguments ci-dessus :</p>
<div class="sourceCode" id="cb1567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1567-1"><a href="epicurves.html#cb1567-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filtrez la liste des lignes</span></span>
<span id="cb1567-2"><a href="epicurves.html#cb1567-2" aria-hidden="true" tabindex="-1"></a>central_data <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1567-3"><a href="epicurves.html#cb1567-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hospital <span class="sc">==</span> <span class="st">&quot;Central Hospital&quot;</span>)</span>
<span id="cb1567-4"><a href="epicurves.html#cb1567-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1567-5"><a href="epicurves.html#cb1567-5" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un objet d&#39;incidence en utilisant les données filtrées</span></span>
<span id="cb1567-6"><a href="epicurves.html#cb1567-6" aria-hidden="true" tabindex="-1"></a>central_outbreak <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1567-7"><a href="epicurves.html#cb1567-7" aria-hidden="true" tabindex="-1"></a>  central_data,</span>
<span id="cb1567-8"><a href="epicurves.html#cb1567-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>,</span>
<span id="cb1567-9"><a href="epicurves.html#cb1567-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb1567-10"><a href="epicurves.html#cb1567-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="st">&quot;outcome&quot;</span>)</span>
<span id="cb1567-11"><a href="epicurves.html#cb1567-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1567-12"><a href="epicurves.html#cb1567-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1567-13"><a href="epicurves.html#cb1567-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_outbreak) <span class="sc">+</span> </span>
<span id="cb1567-14"><a href="epicurves.html#cb1567-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> date_index, <span class="at">y =</span> count, <span class="at">fill =</span>  outcome), <span class="co"># couleur de la boéte/barre</span></span>
<span id="cb1567-15"><a href="epicurves.html#cb1567-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="co"># transparence </span></span>
<span id="cb1567-16"><a href="epicurves.html#cb1567-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span>  <span class="co">#bordure de la boîte</span></span>
<span id="cb1567-17"><a href="epicurves.html#cb1567-17" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1567-18"><a href="epicurves.html#cb1567-18" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cases at Central Hospital&quot;</span>, <span class="co">#titre</span></span>
<span id="cb1567-19"><a href="epicurves.html#cb1567-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Week of onset&quot;</span>,  <span class="co"># étiquette de l&#39;axe des x</span></span>
<span id="cb1567-20"><a href="epicurves.html#cb1567-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="co"># étiquette de l&#39;axe des y</span></span>
<span id="cb1567-21"><a href="epicurves.html#cb1567-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;Outcome&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1567-22"><a href="epicurves.html#cb1567-22" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1567-23"><a href="epicurves.html#cb1567-23" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="co"># légende en haut de page</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1158-1.png" width="672" /></p>
<div class="sourceCode" id="cb1568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1568-1"><a href="epicurves.html#cb1568-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;objet incidence</span></span>
<span id="cb1568-2"><a href="epicurves.html#cb1568-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(</span></span>
<span id="cb1568-3"><a href="epicurves.html#cb1568-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  central_outbreak,</span></span>
<span id="cb1568-4"><a href="epicurves.html#cb1568-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  fill = outcome, # couleur de la boéte/barre</span></span>
<span id="cb1568-5"><a href="epicurves.html#cb1568-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  legend = &quot;top&quot;, # légende en haut de page</span></span>
<span id="cb1568-6"><a href="epicurves.html#cb1568-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  title = &quot;Cas à l&#39;hôpital central&quot;, # titre</span></span>
<span id="cb1568-7"><a href="epicurves.html#cb1568-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  xlab = &quot;Semaine d&#39;apparition&quot;, # étiquette de l&#39;axe des x</span></span>
<span id="cb1568-8"><a href="epicurves.html#cb1568-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylab = &quot;Incidence&quot;, # étiquette de l&#39;axe des y</span></span>
<span id="cb1568-9"><a href="epicurves.html#cb1568-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  show_cases = TRUE, # afficher chaque cas comme une boîte individuelle</span></span>
<span id="cb1568-10"><a href="epicurves.html#cb1568-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  alpha = 0.7, # transparence </span></span>
<span id="cb1568-11"><a href="epicurves.html#cb1568-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  border = &quot;grey&quot;, # bordure de la boîte</span></span>
<span id="cb1568-12"><a href="epicurves.html#cb1568-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  angle = 30, # angle des étiquettes de date</span></span>
<span id="cb1568-13"><a href="epicurves.html#cb1568-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  centre_dates = FALSE, # étiquettes de date au bord de la barre</span></span>
<span id="cb1568-14"><a href="epicurves.html#cb1568-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  date_format = &quot;%a %d %b %Y\n(Week %W)&quot; # ajuste la façon dont les dates sont affichôes</span></span>
<span id="cb1568-15"><a href="epicurves.html#cb1568-15" aria-hidden="true" tabindex="-1"></a> <span class="co"># )</span></span></code></pre></div>
<p>Pour ajuster davantage l’apparence du graphique, consultez la section ci-dessous sur les modifications avec <code>ggplot()</code>.</p>
</div>
<div id="modifications-avec-ggplot2" class="section level3 unnumbered">
<h3>Modifications avec ggplot2</h3>
<p>Vous pouvez modifier davantage un graphique <strong>incidence2</strong> en ajoutant des modifications <strong>ggplot2</strong> avec un <code>+</code> aprés la fin de la fonction <code>plot()</code> d’incidence, comme démontré ci-dessous.</p>
<p>Ci-dessous, le tracé <strong>incidence2</strong> se termine, puis les commandes <strong>ggplot2</strong> sont utilisées pour modifier les axes, ajouter une légende et ajuster la police en gras et la taille du texte.</p>
<p>Notez que si vous ajoutez <code>scale_x_date()</code>, la plupart des formatages de date de <code>plot()</code> seront écrasés. Voir la section sur les épicurves de <code>ggplot()</code> et la page du manuel <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a> pour plus d’options.</p>
<div class="sourceCode" id="cb1569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1569-1"><a href="epicurves.html#cb1569-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filtrez la liste des lignes</span></span>
<span id="cb1569-2"><a href="epicurves.html#cb1569-2" aria-hidden="true" tabindex="-1"></a>central_data <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1569-3"><a href="epicurves.html#cb1569-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hospital <span class="sc">==</span> <span class="st">&quot;Central Hospital&quot;</span>)</span>
<span id="cb1569-4"><a href="epicurves.html#cb1569-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1569-5"><a href="epicurves.html#cb1569-5" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un objet d&#39;incidence en utilisant les données filtrées</span></span>
<span id="cb1569-6"><a href="epicurves.html#cb1569-6" aria-hidden="true" tabindex="-1"></a>central_outbreak <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1569-7"><a href="epicurves.html#cb1569-7" aria-hidden="true" tabindex="-1"></a>  central_data,</span>
<span id="cb1569-8"><a href="epicurves.html#cb1569-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>,</span>
<span id="cb1569-9"><a href="epicurves.html#cb1569-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb1569-10"><a href="epicurves.html#cb1569-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="fu">c</span>(<span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb1569-11"><a href="epicurves.html#cb1569-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1569-12"><a href="epicurves.html#cb1569-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_outbreak) <span class="sc">+</span> </span>
<span id="cb1569-13"><a href="epicurves.html#cb1569-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(date_index), <span class="at">y =</span> count, <span class="at">fill =</span>  outcome), <span class="co"># couleur de la boéte/barre</span></span>
<span id="cb1569-14"><a href="epicurves.html#cb1569-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="co"># transparence </span></span>
<span id="cb1569-15"><a href="epicurves.html#cb1569-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span>  <span class="co">#bordure de la boîte</span></span>
<span id="cb1569-16"><a href="epicurves.html#cb1569-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1569-17"><a href="epicurves.html#cb1569-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="co"># spécifie les incréments de l&#39;axe des y par 5</span></span>
<span id="cb1569-18"><a href="epicurves.html#cb1569-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># supprime l&#39;espace excédentaire en dessous de 0 sur l&#39;axe des y </span></span>
<span id="cb1569-19"><a href="epicurves.html#cb1569-19" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%a %d %b</span><span class="sc">\n</span><span class="st">%Y (Week %W)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1569-20"><a href="epicurves.html#cb1569-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1569-21"><a href="epicurves.html#cb1569-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajouter une légende dynamique</span></span>
<span id="cb1569-22"><a href="epicurves.html#cb1569-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1569-23"><a href="epicurves.html#cb1569-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajuster le caractère gras et la position de la légende</span></span>
<span id="cb1569-24"><a href="epicurves.html#cb1569-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1569-25"><a href="epicurves.html#cb1569-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb1569-26"><a href="epicurves.html#cb1569-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>,</span>
<span id="cb1569-27"><a href="epicurves.html#cb1569-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="co"># titres des axes plus grands et plus gras</span></span>
<span id="cb1569-28"><a href="epicurves.html#cb1569-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="co"># taille du texte de l&#39;axe et gras</span></span>
<span id="cb1569-29"><a href="epicurves.html#cb1569-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>), <span class="co"># déplacer la légende vers la gauche</span></span>
<span id="cb1569-30"><a href="epicurves.html#cb1569-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1569-31"><a href="epicurves.html#cb1569-31" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1569-32"><a href="epicurves.html#cb1569-32" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>( </span>
<span id="cb1569-33"><a href="epicurves.html#cb1569-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Cas à l&#39;hôpital central&quot;</span>, <span class="co"># titre</span></span>
<span id="cb1569-34"><a href="epicurves.html#cb1569-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition&quot;</span>, <span class="co"># étiquette de l&#39;axe des x</span></span>
<span id="cb1569-35"><a href="epicurves.html#cb1569-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Incidence&quot;</span>, <span class="co"># étiquette de l&#39;axe des y</span></span>
<span id="cb1569-36"><a href="epicurves.html#cb1569-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;Résultat pour le patient&quot;</span>, <span class="co"># Titre de la légende</span></span>
<span id="cb1569-37"><a href="epicurves.html#cb1569-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>( <span class="co"># légende dynamique - voir la page sur les caractères et les chaîne de caractères pour plus de détails</span></span>
<span id="cb1569-38"><a href="epicurves.html#cb1569-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;n = {central_cases} de l&#39;hôpital central</span></span>
<span id="cb1569-39"><a href="epicurves.html#cb1569-39" aria-hidden="true" tabindex="-1"></a><span class="st">      L&#39;apparition des cas va de {earliest_date} à {latest_date}. {missing_onset} cas n&#39;ont pas de date d&#39;apparition et ne sont pas représentés ici.&quot;</span>,</span>
<span id="cb1569-40"><a href="epicurves.html#cb1569-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">central_cases =</span> <span class="fu">nrow</span>(central_data),</span>
<span id="cb1569-41"><a href="epicurves.html#cb1569-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">earliest_date =</span> <span class="fu">format</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="at">format =</span> <span class="st">&#39;%a %d %b %Y&#39;</span>),</span>
<span id="cb1569-42"><a href="epicurves.html#cb1569-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">latest_date =</span> <span class="fu">format</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="at">format =</span> <span class="st">&#39;%a %d %b %Y&#39;</span>),      </span>
<span id="cb1569-43"><a href="epicurves.html#cb1569-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">missing_onset =</span> <span class="fu">nrow</span>(central_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(date_onset)))))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1159-1.png" width="672" /></p>
<div class="sourceCode" id="cb1570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1570-1"><a href="epicurves.html#cb1570-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;objet incidence</span></span>
<span id="cb1570-2"><a href="epicurves.html#cb1570-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(</span></span>
<span id="cb1570-3"><a href="epicurves.html#cb1570-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  central_outbreak,</span></span>
<span id="cb1570-4"><a href="epicurves.html#cb1570-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  fill = outcome, # couleur de la boîte/barre</span></span>
<span id="cb1570-5"><a href="epicurves.html#cb1570-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  legend = &quot;top&quot;, # légende sur le dessus</span></span>
<span id="cb1570-6"><a href="epicurves.html#cb1570-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  title = &quot;Cas à l&#39;hôpital central&quot;, # titre</span></span>
<span id="cb1570-7"><a href="epicurves.html#cb1570-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  xlab = &quot;Semaine d&#39;apparition&quot;, # étiquette de l&#39;axe des x</span></span>
<span id="cb1570-8"><a href="epicurves.html#cb1570-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylab = &quot;Incidence&quot;, # étiquette de l&#39;axe des y</span></span>
<span id="cb1570-9"><a href="epicurves.html#cb1570-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  show_cases = TRUE, # afficher chaque cas comme une boîte individuelle</span></span>
<span id="cb1570-10"><a href="epicurves.html#cb1570-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  alpha = 0.7, # transparence </span></span>
<span id="cb1570-11"><a href="epicurves.html#cb1570-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  border = &quot;grey&quot;, # bordure de la boîte</span></span>
<span id="cb1570-12"><a href="epicurves.html#cb1570-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  centre_dates = FALSE,                   </span></span>
<span id="cb1570-13"><a href="epicurves.html#cb1570-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  date_format = &quot;%a %d %b\n%Y (Week %W)&quot;, </span></span>
<span id="cb1570-14"><a href="epicurves.html#cb1570-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  angle = 30 # angle des étiquettes de date</span></span>
<span id="cb1570-15"><a href="epicurves.html#cb1570-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  )</span></span></code></pre></div>
</div>
<div id="changer-les-couleurs" class="section level3 unnumbered">
<h3>Changer les couleurs</h3>
<div id="spécifier-une-palette" class="section level4 unnumbered">
<h4>spécifier une palette</h4>
<p>Fournissez le nom d’une palette prédéfinie à l’argument <code>col_pal =</code> dans <code>plot()</code>. Le paquet <strong>incidence2</strong> est livré avec 2 palettes prédéfinies : “vibrant” et “muted”. Dans “vibrant” les 6 premiéres couleurs sont distinctes et dans “muted” les 9 premiéres couleurs sont distinctes. Aprés ces chiffres, les couleurs sont des interpolations/intermédiaires d’autres couleurs. Ces palettes prédéfinies sont disponibles sur <a href="https://personal.sron.nl/~pault/#sec:qualitative">ce site</a>. Les palettes excluent le gris, qui est réservé aux données manquantes (utilisez <code>na_color =</code> pour modifier cette valeur par défaut).</p>
<div class="sourceCode" id="cb1571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1571-1"><a href="epicurves.html#cb1571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un objet incidence, avec des données groupées par catégorie d&#39;âge  </span></span>
<span id="cb1571-2"><a href="epicurves.html#cb1571-2" aria-hidden="true" tabindex="-1"></a>age_outbreak <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1571-3"><a href="epicurves.html#cb1571-3" aria-hidden="true" tabindex="-1"></a>  linelist,</span>
<span id="cb1571-4"><a href="epicurves.html#cb1571-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>, <span class="co"># date d&#39;apparition pour l&#39;axe des x</span></span>
<span id="cb1571-5"><a href="epicurves.html#cb1571-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># agrégation hebdomadaire des cas</span></span>
<span id="cb1571-6"><a href="epicurves.html#cb1571-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="st">&quot;age_cat&quot;</span>)</span>
<span id="cb1571-7"><a href="epicurves.html#cb1571-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1571-8"><a href="epicurves.html#cb1571-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;épicurve avec la palette par défaut</span></span>
<span id="cb1571-9"><a href="epicurves.html#cb1571-9" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(age_outbreak, fill = age_cat, title = &quot;&#39;vibrant&#39; incidence2 palette par défaut&quot;)</span></span>
<span id="cb1571-10"><a href="epicurves.html#cb1571-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1571-11"><a href="epicurves.html#cb1571-11" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer avec une palette de couleurs différente</span></span>
<span id="cb1571-12"><a href="epicurves.html#cb1571-12" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(age_outbreak, fill = age_cat, col_pal = muted, title = &quot;&#39;muted&#39; incidence2 palette&quot;)</span></span></code></pre></div>
<p>Vous pouvez également utiliser l’une des palettes <strong>base</strong> de R (mettez le nom de la palette <em>sans</em> guillemets).</p>
<div class="sourceCode" id="cb1572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1572-1"><a href="epicurves.html#cb1572-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer avec la palette R de base</span></span>
<span id="cb1572-2"><a href="epicurves.html#cb1572-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(age_outbreak, fill = age_cat, col_pal = heat.colors, title = &quot;base R heat.colors palette&quot;)</span></span>
<span id="cb1572-3"><a href="epicurves.html#cb1572-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1572-4"><a href="epicurves.html#cb1572-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tracé avec la palette R de base</span></span>
<span id="cb1572-5"><a href="epicurves.html#cb1572-5" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(age_outbreak, fill = age_cat, col_pal = rainbow, title = &quot;base R rainbow palette&quot;)</span></span></code></pre></div>
<p>Vous pouvez également ajouter une palette de couleurs à partir du paquet <strong>viridis</strong> ou du paquet <strong>RColorBrewer</strong>. Vous devez d’abord charger ces paquets, puis ajouter leurs fonctions respectives <code>scale_fill_*()</code> avec un <code>+</code>, comme indiqué ci-dessous.</p>
<div class="sourceCode" id="cb1573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1573-1"><a href="epicurves.html#cb1573-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(RColorBrewer, viridis)</span>
<span id="cb1573-2"><a href="epicurves.html#cb1573-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1573-3"><a href="epicurves.html#cb1573-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer avec une palette de couleurs</span></span>
<span id="cb1573-4"><a href="epicurves.html#cb1573-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(age_outbreak, <span class="at">fill =</span> age_cat, <span class="at">title =</span> <span class="st">&quot;Palette Viridis&quot;</span>)<span class="sc">+</span></span>
<span id="cb1573-5"><a href="epicurves.html#cb1573-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(</span>
<span id="cb1573-6"><a href="epicurves.html#cb1573-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="co"># schôma de couleurs, essayez aussi &quot;plasma&quot; ou la valeur par défaut</span></span>
<span id="cb1573-7"><a href="epicurves.html#cb1573-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Age Category&quot;</span>, <span class="co"># nom de la légende</span></span>
<span id="cb1573-8"><a href="epicurves.html#cb1573-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;grey&quot;</span>)      <span class="co"># pour les valeurs manquantes</span></span>
<span id="cb1573-9"><a href="epicurves.html#cb1573-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1573-10"><a href="epicurves.html#cb1573-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer avec la palette de couleurs</span></span>
<span id="cb1573-11"><a href="epicurves.html#cb1573-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(age_outbreak, <span class="at">fill =</span> age_cat, <span class="at">title =</span> <span class="st">&quot;RColorBrewer palette&quot;</span>)<span class="sc">+</span></span>
<span id="cb1573-12"><a href="epicurves.html#cb1573-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(</span>
<span id="cb1573-13"><a href="epicurves.html#cb1573-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>, <span class="co"># palette de couleurs, essayez aussi Accent, Dark2, Paired, Pastel1, Pastel2, Set1, Set2, Set3</span></span>
<span id="cb1573-14"><a href="epicurves.html#cb1573-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Age Category&quot;</span>, <span class="co"># nom de la légende</span></span>
<span id="cb1573-15"><a href="epicurves.html#cb1573-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;grey&quot;</span>)      <span class="co"># pour les valeurs manquantes</span></span></code></pre></div>
</div>
<div id="spécifier-manuellement" class="section level4 unnumbered">
<h4>spécifier manuellement</h4>
<p>Pour spécifier les couleurs manuellement, ajoutez la fonction <strong>ggplot2</strong> <code>scale_fill_manual()</code> à la fonction <code>plot()</code> avec un <code>+</code> et fournissez le vecteur de noms de couleurs ou de codes HEX à l’argument <code>values =</code>. Le nombre de couleurs listées doit étre égal au nombre de groupes. Faites attention si les valeurs manquantes sont un groupe - elles peuvent étre converties en une valeur de caractère comme “Missing” pendant votre préparation de données avec la fonction <code>fct_explicit_na()</code> comme expliqué dans la page sur <a href="factors.html#factors">les facteurs</a>.</p>
<div class="sourceCode" id="cb1574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1574-1"><a href="epicurves.html#cb1574-1" aria-hidden="true" tabindex="-1"></a><span class="co"># couleurs manuelles</span></span>
<span id="cb1574-2"><a href="epicurves.html#cb1574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(age_outbreak, <span class="at">fill =</span> age_cat, <span class="at">title =</span> <span class="st">&quot;Manually-specified colors&quot;</span>)<span class="sc">+</span></span>
<span id="cb1574-3"><a href="epicurves.html#cb1574-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb1574-4"><a href="epicurves.html#cb1574-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;lightblue&quot;</span>), <span class="co"># colors</span></span>
<span id="cb1574-5"><a href="epicurves.html#cb1574-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Age category&quot;</span>)      <span class="co"># Nom pour la légende</span></span></code></pre></div>
<p>Comme mentionné dans la page <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a>, vous pouvez créer vos propres palettes en utilisant <code>colorRampPalette()</code> sur un vecteur de couleurs et en spécifiant le nombre de couleurs que vous voulez en retour. C’est un bon moyen d’obtenir de nombreuses couleurs dans une rampe en n’en spécifiant que quelques-unes.</p>
<div class="sourceCode" id="cb1575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1575-1"><a href="epicurves.html#cb1575-1" aria-hidden="true" tabindex="-1"></a>my_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb1575-2"><a href="epicurves.html#cb1575-2" aria-hidden="true" tabindex="-1"></a>my_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(my_cols)(<span class="dv">12</span>) <span class="co"># étendez les 6 couleurs ci-dessus à 12 couleurs</span></span>
<span id="cb1575-3"><a href="epicurves.html#cb1575-3" aria-hidden="true" tabindex="-1"></a>my_palette</span></code></pre></div>
<pre><code>##  [1] &quot;#006400&quot; &quot;#00363F&quot; &quot;#00097E&quot; &quot;#3A0BAF&quot; &quot;#821ADD&quot; &quot;#A84BE2&quot; &quot;#B592CB&quot; &quot;#C9C99B&quot; &quot;#E7E745&quot; &quot;#FFF600&quot; &quot;#FFCD00&quot; &quot;#FFA500&quot;</code></pre>
</div>
</div>
<div id="ajuster-lordre-des-niveaux" class="section level3 unnumbered">
<h3>Ajuster l’ordre des niveaux</h3>
<p>Pour ajuster l’ordre d’apparition des groupes (sur le graphe et dans la légende), la colonne de regroupement doit étre de classe Facteur. Voir la page sur les <a href="factors.html#factors">facteurs</a> pour plus d’informations.</p>
<p>Tout d’abord, voyons une épicurve hebdomadaire par hôpital avec l’ordre par défaut :</p>
<div class="sourceCode" id="cb1577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1577-1"><a href="epicurves.html#cb1577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ORIGINAL - hôpital PAS comme facteur</span></span>
<span id="cb1577-2"><a href="epicurves.html#cb1577-2" aria-hidden="true" tabindex="-1"></a><span class="do">###################################</span></span>
<span id="cb1577-3"><a href="epicurves.html#cb1577-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1577-4"><a href="epicurves.html#cb1577-4" aria-hidden="true" tabindex="-1"></a><span class="co"># créer un objet d&#39;incidence hebdomadaire, lignes groupées par hôpital et semaine</span></span>
<span id="cb1577-5"><a href="epicurves.html#cb1577-5" aria-hidden="true" tabindex="-1"></a>hospital_outbreak <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1577-6"><a href="epicurves.html#cb1577-6" aria-hidden="true" tabindex="-1"></a>  linelist,</span>
<span id="cb1577-7"><a href="epicurves.html#cb1577-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> date_onset, </span>
<span id="cb1577-8"><a href="epicurves.html#cb1577-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>, </span>
<span id="cb1577-9"><a href="epicurves.html#cb1577-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> hospital)</span>
<span id="cb1577-10"><a href="epicurves.html#cb1577-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1577-11"><a href="epicurves.html#cb1577-11" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;objet incidence</span></span>
<span id="cb1577-12"><a href="epicurves.html#cb1577-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hospital_outbreak, <span class="at">fill =</span> hospital, <span class="at">title =</span> <span class="st">&quot;ORIGINAL - l&#39;hôpital n&#39;est pas un facteur&quot;</span>)</span></code></pre></div>
<p>Maintenant, pour ajuster l’ordre de sorte que “Missing” et “Other” soient en haut de l’épicurve, nous pouvons faire ce qui suit :</p>
<ul>
<li>Charger le paquet <strong>forcats</strong>, pour travailler avec les facteurs.<br />
</li>
<li>Ajustez l’ensemble de données - dans ce cas, nous définirons un nouvel ensemble de données (<code>plot_data</code>) dans lequel :
<ul>
<li>la colonne <code>gender</code> est définie comme un facteur l’ordre des niveaux est défini avec <code>fct_relevel()</code> de sorte que “Other” et “Missing” soient les premiers, ils apparaissent donc en haut des barres<br />
</li>
</ul></li>
<li>L’objet d’incidence est créé et tracé comme précédemment.<br />
</li>
<li>Nous ajoutons les modifications <strong>ggplot2</strong>.
<ul>
<li><code>scale_fill_manual()</code> pour assigner manuellement les couleurs de sorte que “Missing” soit gris et “Other” soit beige.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1578-1"><a href="epicurves.html#cb1578-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODIFIED - l&#39;hôpital comme facteur</span></span>
<span id="cb1578-2"><a href="epicurves.html#cb1578-2" aria-hidden="true" tabindex="-1"></a><span class="do">###############################</span></span>
<span id="cb1578-3"><a href="epicurves.html#cb1578-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1578-4"><a href="epicurves.html#cb1578-4" aria-hidden="true" tabindex="-1"></a><span class="co"># charger le paquet forcats pour travailler avec les facteurs</span></span>
<span id="cb1578-5"><a href="epicurves.html#cb1578-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(forcats)</span>
<span id="cb1578-6"><a href="epicurves.html#cb1578-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1578-7"><a href="epicurves.html#cb1578-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir la colonne hôpital en facteur et ajuster les niveaux</span></span>
<span id="cb1578-8"><a href="epicurves.html#cb1578-8" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> lineelist <span class="sc">%&gt;%</span> </span>
<span id="cb1578-9"><a href="epicurves.html#cb1578-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hospital =</span> <span class="fu">fct_relevel</span>(hospital, <span class="fu">c</span>(<span class="st">&quot;Missing&quot;</span>, <span class="st">&quot;Other&quot;</span>))) <span class="co"># définir &quot;Missing&quot; et &quot;Other&quot; comme niveaux supérieurs.</span></span>
<span id="cb1578-10"><a href="epicurves.html#cb1578-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1578-11"><a href="epicurves.html#cb1578-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1578-12"><a href="epicurves.html#cb1578-12" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un objet d&#39;incidence hebdomadaire, groupé par hôpital et par semaine.</span></span>
<span id="cb1578-13"><a href="epicurves.html#cb1578-13" aria-hidden="true" tabindex="-1"></a>hospital_outbreak_mod <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1578-14"><a href="epicurves.html#cb1578-14" aria-hidden="true" tabindex="-1"></a>  plot_data,</span>
<span id="cb1578-15"><a href="epicurves.html#cb1578-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> date_onset, </span>
<span id="cb1578-16"><a href="epicurves.html#cb1578-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>, </span>
<span id="cb1578-17"><a href="epicurves.html#cb1578-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> hospital)</span>
<span id="cb1578-18"><a href="epicurves.html#cb1578-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1578-19"><a href="epicurves.html#cb1578-19" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;objet d&#39;incidence</span></span>
<span id="cb1578-20"><a href="epicurves.html#cb1578-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hospital_outbreak_mod, <span class="at">fill =</span> hospital)<span class="sc">+</span></span>
<span id="cb1578-21"><a href="epicurves.html#cb1578-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1578-22"><a href="epicurves.html#cb1578-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spécifier manuellement les couleurs</span></span>
<span id="cb1578-23"><a href="epicurves.html#cb1578-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;beige&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;green2&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;pink&quot;</span>))<span class="sc">+</span>                      </span>
<span id="cb1578-24"><a href="epicurves.html#cb1578-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1578-25"><a href="epicurves.html#cb1578-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes ajoutées via ggplot</span></span>
<span id="cb1578-26"><a href="epicurves.html#cb1578-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1578-27"><a href="epicurves.html#cb1578-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;MODIFIÉ - l&#39;hôpital comme facteur&quot;</span>, <span class="co"># titre du graphique</span></span>
<span id="cb1578-28"><a href="epicurves.html#cb1578-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;Autre &amp; Manquant en haut de l&#39;épicurve&quot;</span>,</span>
<span id="cb1578-29"><a href="epicurves.html#cb1578-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;Incidence hebdomadaire des cas &quot;</span>, <span class="co"># titre de l&#39;axe des y  </span></span>
<span id="cb1578-30"><a href="epicurves.html#cb1578-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>, <span class="co"># titre de l&#39;axe des x</span></span>
<span id="cb1578-31"><a href="epicurves.html#cb1578-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;Hôpital&quot;</span>) <span class="co"># titre de la légende     </span></span></code></pre></div>
<p><span style="color : darkgreen ;"><strong><em>ATTENTION:</em></strong> Si vous voulez inverser l’ordre de la légende uniquement, ajoutez cette commande <strong>ggplot2</strong> <code>guides(fill = guide_legend(reverse = TRUE))</code>.</span></p>
</div>
<div id="lignes-de-grille-verticales" class="section level3 unnumbered">
<h3>Lignes de grille verticales</h3>
<p>Si vous tracez avec les paramétres par défaut de <strong>incidence2</strong>, vous pouvez remarquer que les lignes de grille verticales apparaissent à chaque étiquette de date et une fois entre chaque étiquette de date. Cela peut entraîner l’intersection des lignes de grille avec le haut de certaines barres.</p>
<p>&lt;Remarque : ce paragraphe n’est pas applicable avec la version 1.0.0 de incidence2). Vous pouvez spécifier l’intervalle des lignes de grille en ajoutant la commande <code>scale_x_date()</code> de <strong>ggplot2</strong> à votre graphe <strong>incidence2</strong>. Dans celle-ci, spécifiez les intervalles pour <code>date_breaks =</code> et <code>date_minor_breaks =</code> (par exemple “semaines” ou “3 semaines” ou “mois”). Notez que l’utilisation de <code>scale_x_date()</code> remplacera tout formatage des étiquettes de date dans <code>plot()</code>, donc vous devrez spécifier tout format de chaîne à <code>date_labels =</code> comme ci-dessous. –&gt;</p>
<p>Vous pouvez supprimer toutes les lignes de grille en ajoutant la commande <strong>ggplot2</strong> <code>theme_classic()</code>.</p>
<div class="sourceCode" id="cb1579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1579-1"><a href="epicurves.html#cb1579-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fabrique un objet d&#39;incidence</span></span>
<span id="cb1579-2"><a href="epicurves.html#cb1579-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1579-3"><a href="epicurves.html#cb1579-3" aria-hidden="true" tabindex="-1"></a>  central_data,</span>
<span id="cb1579-4"><a href="epicurves.html#cb1579-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>,</span>
<span id="cb1579-5"><a href="epicurves.html#cb1579-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;weekly&quot;</span></span>
<span id="cb1579-6"><a href="epicurves.html#cb1579-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1579-7"><a href="epicurves.html#cb1579-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1579-8"><a href="epicurves.html#cb1579-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lignes de grille par défaut</span></span>
<span id="cb1579-9"><a href="epicurves.html#cb1579-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">title =</span> <span class="st">&quot;Lignes par défaut&quot;</span>)</span>
<span id="cb1579-10"><a href="epicurves.html#cb1579-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1579-11"><a href="epicurves.html#cb1579-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalles de lignes de grille spécifiés</span></span>
<span id="cb1579-12"><a href="epicurves.html#cb1579-12" aria-hidden="true" tabindex="-1"></a><span class="co"># NE FONCTIONNE PAS AVEC INCIDENCE2 1.0.0</span></span>
<span id="cb1579-13"><a href="epicurves.html#cb1579-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(a, title = &quot;Lignes hebdomadaires&quot;)+</span></span>
<span id="cb1579-14"><a href="epicurves.html#cb1579-14" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_x_date(</span></span>
<span id="cb1579-15"><a href="epicurves.html#cb1579-15" aria-hidden="true" tabindex="-1"></a><span class="co"># date_breaks = &quot;4 weeks&quot;, # major vertical lines align on weeks</span></span>
<span id="cb1579-16"><a href="epicurves.html#cb1579-16" aria-hidden="true" tabindex="-1"></a><span class="co"># date_minor_breaks = &quot;weeks&quot;, # lignes verticales mineures chaque semaine</span></span>
<span id="cb1579-17"><a href="epicurves.html#cb1579-17" aria-hidden="true" tabindex="-1"></a><span class="co"># date_labels = &quot;%a\n%d\n%b&quot;) # format des étiquettes de date</span></span>
<span id="cb1579-18"><a href="epicurves.html#cb1579-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1579-19"><a href="epicurves.html#cb1579-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Pas de lignes de grille</span></span>
<span id="cb1579-20"><a href="epicurves.html#cb1579-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a, <span class="at">title =</span> <span class="st">&quot;Aucune ligne&quot;</span>)<span class="sc">+</span></span>
<span id="cb1579-21"><a href="epicurves.html#cb1579-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="co"># supprime toutes les lignes du quadrillage</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1167-1.png" width="50%" /><img src="_main_files/figure-html/unnamed-chunk-1167-2.png" width="50%" /></p>
<p>Notez cependant que si vous utilisez des semaines, les arguments <code>date_breaks</code> et <code>date_minor_breaks</code> ne fonctionnent que pour les semaines <em>lundi</em>. Si vos semaines sont d’un autre jour de la semaine, vous devrez fournir manuellement un vecteur de dates aux arguments <code>breaks =</code> et <code>minor_breaks =</code> à la place. Voir la section <strong>ggplot2</strong> pour des exemples de ceci en utilisant <code>seq.Date()</code>.</p>
</div>
<div id="incidence-cumulée" class="section level3 unnumbered">
<h3>Incidence cumulée</h3>
<p>Vous pouvez facilement produire un graphique de l’incidence cumulée en passant l’objet incidence à la commande <strong>incidence2</strong> <code>cumulate()</code> et ensuite à <code>plot()</code>. Cela fonctionne également avec <code>facet_plot()</code>.</p>
<div class="sourceCode" id="cb1580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1580-1"><a href="epicurves.html#cb1580-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fabrique un objet d&#39;incidence hebdomadaire</span></span>
<span id="cb1580-2"><a href="epicurves.html#cb1580-2" aria-hidden="true" tabindex="-1"></a>wkly_inci <span class="ot">&lt;-</span> <span class="fu">incidence</span>(</span>
<span id="cb1580-3"><a href="epicurves.html#cb1580-3" aria-hidden="true" tabindex="-1"></a>  linelist,</span>
<span id="cb1580-4"><a href="epicurves.html#cb1580-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>,</span>
<span id="cb1580-5"><a href="epicurves.html#cb1580-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>)</span>
<span id="cb1580-6"><a href="epicurves.html#cb1580-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1580-7"><a href="epicurves.html#cb1580-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer l&#39;incidence cumulée</span></span>
<span id="cb1580-8"><a href="epicurves.html#cb1580-8" aria-hidden="true" tabindex="-1"></a>wkly_inci <span class="sc">%&gt;%</span> </span>
<span id="cb1580-9"><a href="epicurves.html#cb1580-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cumulate</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1580-10"><a href="epicurves.html#cb1580-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1168-1.png" width="672" /></p>
<p>Voir la section plus bas sur cette page pour une méthode alternative pour tracer l’incidence cumulative avec <strong>ggplot2</strong> - par exemple pour superposer une ligne d’incidence cumulative sur une épicurve.</p>
</div>
<div id="moyenne-glissante" class="section level3 unnumbered">
<h3>Moyenne glissante</h3>
<p>Vous pouvez ajouter une moyenne glissante à un graphique <strong>incidence2</strong> facilement avec <code>add_rolling_average()</code> du paquet <strong>i2extras</strong>. Passez votre objet incidence2 à cette fonction, puis à <code>plot()</code>. définissez <code>before =</code> comme le nombre de jours précédents que vous voulez inclure dans la moyenne glissante (par défaut, 2). Si vos données sont groupées, la moyenne mobile sera calculée par groupe.</p>
<div class="sourceCode" id="cb1581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1581-1"><a href="epicurves.html#cb1581-1" aria-hidden="true" tabindex="-1"></a>rolling_avg <span class="ot">&lt;-</span> <span class="fu">incidence</span>( <span class="co"># make incidence object</span></span>
<span id="cb1581-2"><a href="epicurves.html#cb1581-2" aria-hidden="true" tabindex="-1"></a>  linelist,</span>
<span id="cb1581-3"><a href="epicurves.html#cb1581-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_index =</span> <span class="st">&quot;date_onset&quot;</span>,</span>
<span id="cb1581-4"><a href="epicurves.html#cb1581-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb1581-5"><a href="epicurves.html#cb1581-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups =</span> <span class="st">&quot;gender&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1581-6"><a href="epicurves.html#cb1581-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1581-7"><a href="epicurves.html#cb1581-7" aria-hidden="true" tabindex="-1"></a>  i2extras<span class="sc">::</span><span class="fu">add_rolling_average</span>(<span class="dv">6</span>) <span class="co"># ajouter des moyennes glissantes (dans ce cas, par sexe)</span></span>
<span id="cb1581-8"><a href="epicurves.html#cb1581-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1581-9"><a href="epicurves.html#cb1581-9" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer</span></span>
<span id="cb1581-10"><a href="epicurves.html#cb1581-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rolling_avg, <span class="at">n.breaks =</span> <span class="dv">3</span>) <span class="co"># facettes automatiquement car moyenne glissante sur les groupes</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1169-1.png" width="672" /></p>
<p>Pour apprendre à appliquer des moyennes glissantes de maniére plus générale sur des données, voir la page du manuel sur les <a href="moving_average.html#moving_average">moyennes glissantes</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="epicurves-avec-ggplot2" class="section level2" number="33.3">
<h2><span class="header-section-number">33.3</span> Epicurves avec ggplot2</h2>
<p>L’utilisation de <code>ggplot()</code> pour construire votre épicurve permet plus de flexibilité et de personnalisation, mais nécessite plus d’efforts et de compréhension du fonctionnement de <code>ggplot()</code>.</p>
<p>Contrairement à l’utilisation du paquet <strong>incidence2</strong>, vous devez <em>manuellement</em> contrôler l’agrégation des cas par temps (en semaines, mois, etc.) <em>et</em> les intervalles des étiquettes sur l’axe des dates. Ceci doit étre soigneusement géré.</p>
<p>Ces exemples utilisent un sous-ensemble de l’ensemble de données <code>linelist</code> - seulement les cas de l’hôpital central.</p>
<div class="sourceCode" id="cb1582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1582-1"><a href="epicurves.html#cb1582-1" aria-hidden="true" tabindex="-1"></a>central_data <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1582-2"><a href="epicurves.html#cb1582-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hospital <span class="sc">==</span> <span class="st">&quot;Central Hospital&quot;</span>)</span></code></pre></div>
<p>Pour produire une épicurve avec <code>ggplot()</code>, il y a trois éléments principaux :</p>
<ul>
<li>Un histogramme, avec les cas de la liste de lignes agrégés en “bins” distingués par des points de “rupture” spécifiques.<br />
</li>
<li>Des échelles pour les axes et leurs étiquettes<br />
</li>
<li>Des thèmes pour l’apparence du graphique, y compris les titres, les étiquettes, les légendes, etc.</li>
</ul>
<div id="spécifier-les-cas-en-bacs" class="section level3 unnumbered">
<h3>spécifier les cas en bacs</h3>
<p>Nous montrons ici comment spécifier la façon dont les cas seront agrégés dans des cases d’histogramme (“barres”). Il est important de reconnaétre que l’agrégation des cas dans les cases de l’histogramme n’est <strong>pas</strong> nécessairement les mêmes intervalles que les dates qui apparaîtront sur l’axe des abscisses.</p>
<p>Vous trouverez ci-dessous le code le plus simple pour produire des épicurves quotidiennes et hebdomadaires.</p>
<p>Dans la commande globale <code>ggplot()</code>, le jeu de données est fourni avec <code>data =</code>. Sur cette base, la géométrie d’un histogramme est ajoutée avec un <code>+</code>. Dans la commande <code>geom_histogram()</code>, nous mappons l’esthétique de telle sorte que la colonne <code>date_onset</code> soit mappée sur l’axe des x. Toujours dans <code>geom_histogram()</code> mais <em>non</em> dans <code>aes()</code>, nous définissons la <code>binwidth =</code> des bins de l’histogramme, en jours. Si cette syntaxe <strong>ggplot2</strong> est confuse, revoyez la page sur <a href="ggplot_basics.html#ggplot_basics">les bases de ggplot</a>.</p>
<p><span style="color : orange ;"><strong><em>CAUTION:</em></strong> Tracer des cas hebdomadaires en utilisant <code>binwidth = 7</code> fait démarrer le premier bin de 7 jours au premier cas, qui pourrait étre n’importe quel jour de la semaine ! Pour créer des semaines spécifiques, voir la section ci-dessous .</span></p>
<div class="sourceCode" id="cb1583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1583-1"><a href="epicurves.html#cb1583-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quotidien </span></span>
<span id="cb1583-2"><a href="epicurves.html#cb1583-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> central_data) <span class="sc">+</span> <span class="co"># set data</span></span>
<span id="cb1583-3"><a href="epicurves.html#cb1583-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>( <span class="co"># ajouter un histogramme</span></span>
<span id="cb1583-4"><a href="epicurves.html#cb1583-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset), <span class="co"># map date column to x-axis</span></span>
<span id="cb1583-5"><a href="epicurves.html#cb1583-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">1</span>)<span class="sc">+</span> <span class="co"># cas groupés par 1 jour </span></span>
<span id="cb1583-6"><a href="epicurves.html#cb1583-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Central Hospital - Quotidiennement&quot;</span>) <span class="co"># titre</span></span>
<span id="cb1583-7"><a href="epicurves.html#cb1583-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1583-8"><a href="epicurves.html#cb1583-8" aria-hidden="true" tabindex="-1"></a><span class="co"># hebdomadaire</span></span>
<span id="cb1583-9"><a href="epicurves.html#cb1583-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> central_data) <span class="sc">+</span> <span class="co"># set data </span></span>
<span id="cb1583-10"><a href="epicurves.html#cb1583-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>( <span class="co"># ajouter un histogramme</span></span>
<span id="cb1583-11"><a href="epicurves.html#cb1583-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset), <span class="co"># mappage de la colonne date sur l&#39;axe des x</span></span>
<span id="cb1583-12"><a href="epicurves.html#cb1583-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">binwidth =</span> <span class="dv">7</span>)<span class="sc">+</span> <span class="co"># cas classés tous les 7 jours, à partir du premier cas ( !) </span></span>
<span id="cb1583-13"><a href="epicurves.html#cb1583-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Central Hospital - Tranches de 7 jours, à partir du premier cas&quot;</span>) <span class="co"># titre</span></span></code></pre></div>
<p><img src="_main_files/figure-html/ggplot_simple-1.png" width="50%" /><img src="_main_files/figure-html/ggplot_simple-2.png" width="50%" /></p>
<p>Notons que le premier cas de cet ensemble de données de l’hôpital Central a vu ses symptômes apparaître le :</p>
<div class="sourceCode" id="cb1584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1584-1"><a href="epicurves.html#cb1584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;%A %d %b, %Y&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Thursday 01 May, 2014&quot;</code></pre>
<p><strong>Pour spécifier manuellement les ruptures des cases de l’histogramme, n’utilisez pas l’argument <code>binwidth =</code>, mais fournissez un vecteur de dates à <code>breaks =</code>.</strong>.</p>
<p>créez le vecteur de dates avec la fonction R <strong>base</strong> <code>seq.Date()</code>. Cette fonction attend les arguments <code>to =</code>, <code>from =</code>, et <code>by =</code>. Par exemple, la commande ci-dessous renvoie les dates mensuelles commençant le 15 janvier et se terminant le 28 juin.</p>
<div class="sourceCode" id="cb1586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1586-1"><a href="epicurves.html#cb1586-1" aria-hidden="true" tabindex="-1"></a>monthly_breaks <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2014-02-01&quot;</span>),</span>
<span id="cb1586-2"><a href="epicurves.html#cb1586-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">to =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-07-15&quot;</span>),</span>
<span id="cb1586-3"><a href="epicurves.html#cb1586-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by =</span> <span class="st">&quot;months&quot;</span>)</span>
<span id="cb1586-4"><a href="epicurves.html#cb1586-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1586-5"><a href="epicurves.html#cb1586-5" aria-hidden="true" tabindex="-1"></a>monthly_breaks <span class="co"># print</span></span></code></pre></div>
<pre><code>##  [1] &quot;2014-02-01&quot; &quot;2014-03-01&quot; &quot;2014-04-01&quot; &quot;2014-05-01&quot; &quot;2014-06-01&quot; &quot;2014-07-01&quot; &quot;2014-08-01&quot; &quot;2014-09-01&quot; &quot;2014-10-01&quot; &quot;2014-11-01&quot;
## [11] &quot;2014-12-01&quot; &quot;2015-01-01&quot; &quot;2015-02-01&quot; &quot;2015-03-01&quot; &quot;2015-04-01&quot; &quot;2015-05-01&quot; &quot;2015-06-01&quot; &quot;2015-07-01&quot;</code></pre>
<p>Ce vecteur peut étre fourni à <code>geom_histogram()</code> sous la forme <code>breaks =</code> :</p>
<div class="sourceCode" id="cb1588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1588-1"><a href="epicurves.html#cb1588-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mensuel </span></span>
<span id="cb1588-2"><a href="epicurves.html#cb1588-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> central_data) <span class="sc">+</span>  </span>
<span id="cb1588-3"><a href="epicurves.html#cb1588-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1588-4"><a href="epicurves.html#cb1588-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1588-5"><a href="epicurves.html#cb1588-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> monthly_breaks)<span class="sc">+</span> <span class="co"># fournit le vecteur prédéfini de breaks                    </span></span>
<span id="cb1588-6"><a href="epicurves.html#cb1588-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Bins de cas mensuels&quot;</span>) <span class="co"># titre</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1175-1.png" width="672" /></p>
<p>Une simple séquence de date hebdomadaire peut étre retournée en définissant <code>by = "week"</code>. Par exemple :</p>
<div class="sourceCode" id="cb1589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1589-1"><a href="epicurves.html#cb1589-1" aria-hidden="true" tabindex="-1"></a>weekly_breaks <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2014-02-01&quot;</span>),</span>
<span id="cb1589-2"><a href="epicurves.html#cb1589-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">to =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-07-15&quot;</span>),</span>
<span id="cb1589-3"><a href="epicurves.html#cb1589-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by =</span> <span class="st">&quot;week&quot;</span>)</span></code></pre></div>
<p>Une alternative à la fourniture de dates de début et de fin spécifiques consiste à écrire un code <em>dynamique</em> pour que les bacs hebdomadaires commencent <em>le lundi précédant le premier cas</em>. **Nous utiliserons ces vecteurs de date dans les exemples ci-dessous.</p>
<div class="sourceCode" id="cb1590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1590-1"><a href="epicurves.html#cb1590-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Séquence de dates hebdomadaires du lundi pour CENTRAL HOSPITAL</span></span>
<span id="cb1590-2"><a href="epicurves.html#cb1590-2" aria-hidden="true" tabindex="-1"></a>weekly_breaks_central <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(</span>
<span id="cb1590-3"><a href="epicurves.html#cb1590-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">1</span>), <span class="co"># lundi avant le premier cas</span></span>
<span id="cb1590-4"><a href="epicurves.html#cb1590-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">1</span>), <span class="co"># lundi aprés la derniére affaire</span></span>
<span id="cb1590-5"><a href="epicurves.html#cb1590-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">&quot;week&quot;</span>)</span></code></pre></div>
<p>Décortiquons le code plutôt déconcertant ci-dessus :</p>
<ul>
<li>La valeur “from” (date la plus ancienne de la séquence) est crée comme suit : la valeur minimale de la date (<code>min()</code> avec <code>na.rm=TRUE</code>) dans la colonne <code>date_onset</code> est introduite dans <code>floor_date()</code> du paquet <strong>lubridate</strong>. <code>floor_date()</code> défini sur “week” renvoie la date de début de la “semaine” de ce cas, étant donné que le jour de début de chaque semaine est un lundi (<code>week_start = 1</code>).<br />
</li>
<li>De même, la valeur “to” (date de fin de la séquence) est créée en utilisant la fonction inverse <code>ceiling_date()</code> pour retourner le lundi <em>aprés</em> le dernier cas.<br />
</li>
<li>L’argument “by” de <code>seq.Date()</code> peut étre défini sur un nombre quelconque de jours, de semaines ou de mois.<br />
</li>
<li>Utilisez <code>week_start = 7</code> pour les semaines de dimanche.</li>
</ul>
<p>Comme nous utiliserons ces vecteurs de date tout au long de cette page, nous en définissons également un pour l’ensemble du foyer (ce qui précéde ne concerne que l’hôpital central).</p>
<div class="sourceCode" id="cb1591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1591-1"><a href="epicurves.html#cb1591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Séquence pour l&#39;ensemble du foyer</span></span>
<span id="cb1591-2"><a href="epicurves.html#cb1591-2" aria-hidden="true" tabindex="-1"></a>weekly_breaks_all <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(</span>
<span id="cb1591-3"><a href="epicurves.html#cb1591-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(linelist<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">1</span>), <span class="co"># lundi avant le premier cas</span></span>
<span id="cb1591-4"><a href="epicurves.html#cb1591-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(linelist<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">1</span>), <span class="co"># lundi aprés la derniére affaire</span></span>
<span id="cb1591-5"><a href="epicurves.html#cb1591-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">&quot;week&quot;</span>)</span></code></pre></div>
<p>Ces sorties <code>seq.Date()</code> peuvent étre utilisées pour créer les ruptures des cases de l’histogramme, mais aussi les ruptures pour les étiquettes de date, qui peuvent étre indépendantes des cases. Vous en saurez plus sur les étiquettes de date dans les sections suivantes.</p>
<p><span style="color : darkgreen ;"><strong><em>TIP:</em></strong> Pour une commande <code>ggplot()</code> plus simple, sauvegardez à l’avance les ruptures de bacs et les ruptures d’étiquettes de dates en tant que vecteurs nommés, et fournissez simplement leurs noms à <code>breaks =</code>.</span>.</p>
</div>
<div id="exemple-dépicurve-hebdomadaire" class="section level3 unnumbered">
<h3>Exemple d’épicurve hebdomadaire</h3>
<p><strong>Vous trouverez ci-dessous un exemple de code détaillé pour produire des épicurves hebdomadaires pour les semaines du lundi, avec des barres alignées, des étiquettes de date et des lignes de grille verticales.</strong> Cette section est destinée à l’utilisateur qui a besoin de code rapidement. Pour comprendre en profondeur chaque aspect (thèmes, étiquettes de date, etc.), passez aux sections suivantes. A noter :</p>
<ul>
<li>Les <em>cassures de l’histogramme</em> sont définies avec <code>seq.Date()</code> comme expliqué ci-dessus pour commencer le lundi avant le premier cas et pour finir le lundi aprés le dernier cas.<br />
</li>
<li>L’intervalle des <em>étiquettes de date</em> est spécifié par <code>date_breaks =</code> dans <code>scale_x_date()</code>.<br />
</li>
<li>L’intervalle des petites lignes verticales entre les étiquettes de date est spécifié par <code>date_minor_breaks =</code>.<br />
</li>
<li><code>expand = c(0,0)</code> dans les échelles x et y supprime l’espace excédentaire de chaque côte des axes, ce qui garantit également que les étiquettes de date commencent à partir de la premiére barre.</li>
</ul>
<div class="sourceCode" id="cb1592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1592-1"><a href="epicurves.html#cb1592-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ALIGNEMENT TOTAL DE LA SEMAINE DU LUNDI</span></span>
<span id="cb1592-2"><a href="epicurves.html#cb1592-2" aria-hidden="true" tabindex="-1"></a><span class="do">#############################</span></span>
<span id="cb1592-3"><a href="epicurves.html#cb1592-3" aria-hidden="true" tabindex="-1"></a><span class="co"># définir la séquence des pauses hebdomadaires</span></span>
<span id="cb1592-4"><a href="epicurves.html#cb1592-4" aria-hidden="true" tabindex="-1"></a>weekly_breaks_central <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(</span>
<span id="cb1592-5"><a href="epicurves.html#cb1592-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">1</span>), <span class="co"># lundi avant la premiére affaire</span></span>
<span id="cb1592-6"><a href="epicurves.html#cb1592-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">1</span>), <span class="co"># lundi aprés la derniére affaire</span></span>
<span id="cb1592-7"><a href="epicurves.html#cb1592-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">&quot;week&quot;</span>)    <span class="co"># les bins sont de 7 jours </span></span>
<span id="cb1592-8"><a href="epicurves.html#cb1592-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1592-9"><a href="epicurves.html#cb1592-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1592-10"><a href="epicurves.html#cb1592-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> central_data) <span class="sc">+</span> </span>
<span id="cb1592-11"><a href="epicurves.html#cb1592-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1592-12"><a href="epicurves.html#cb1592-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># créer un histogramme : spécifier les points de rupture des bacs : commence le lundi avant le premier cas, se termine le lundi aprés le dernier cas</span></span>
<span id="cb1592-13"><a href="epicurves.html#cb1592-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1592-14"><a href="epicurves.html#cb1592-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1592-15"><a href="epicurves.html#cb1592-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># esthétique de la mapping</span></span>
<span id="cb1592-16"><a href="epicurves.html#cb1592-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset), <span class="co"># colonne de date mappée sur l&#39;axe des x</span></span>
<span id="cb1592-17"><a href="epicurves.html#cb1592-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1592-18"><a href="epicurves.html#cb1592-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ruptures de la case de l&#39;histogramme</span></span>
<span id="cb1592-19"><a href="epicurves.html#cb1592-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central, <span class="co"># pauses des cases de l&#39;histogramme définies précédemment</span></span>
<span id="cb1592-20"><a href="epicurves.html#cb1592-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1592-21"><a href="epicurves.html#cb1592-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># barres</span></span>
<span id="cb1592-22"><a href="epicurves.html#cb1592-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># couleur des lignes autour des barres</span></span>
<span id="cb1592-23"><a href="epicurves.html#cb1592-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span> <span class="co"># couleur de remplissage dans les barres</span></span>
<span id="cb1592-24"><a href="epicurves.html#cb1592-24" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span> </span>
<span id="cb1592-25"><a href="epicurves.html#cb1592-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1592-26"><a href="epicurves.html#cb1592-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes de l&#39;axe des x</span></span>
<span id="cb1592-27"><a href="epicurves.html#cb1592-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1592-28"><a href="epicurves.html#cb1592-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># suppression de l&#39;espace excédentaire sur l&#39;axe des x avant et aprés les barres de cas</span></span>
<span id="cb1592-29"><a href="epicurves.html#cb1592-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;4 weeks&quot;</span>, <span class="co"># les étiquettes de date et les principales lignes de grille verticales apparaissent toutes les 3 semaines du lundi</span></span>
<span id="cb1592-30"><a href="epicurves.html#cb1592-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># les lignes verticales mineures apparaissent chaque lundi de semaine</span></span>
<span id="cb1592-31"><a href="epicurves.html#cb1592-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%a</span><span class="sc">\n</span><span class="st">%d %b</span><span class="sc">\n</span><span class="st">%Y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes de date</span></span>
<span id="cb1592-32"><a href="epicurves.html#cb1592-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1592-33"><a href="epicurves.html#cb1592-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axe des y</span></span>
<span id="cb1592-34"><a href="epicurves.html#cb1592-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1592-35"><a href="epicurves.html#cb1592-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire sur l&#39;axe des y en dessous de 0 (alignement de l&#39;histogramme sur l&#39;axe des x)</span></span>
<span id="cb1592-36"><a href="epicurves.html#cb1592-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1592-37"><a href="epicurves.html#cb1592-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thèmes esthétiques</span></span>
<span id="cb1592-38"><a href="epicurves.html#cb1592-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># simplifie le fond du graphique</span></span>
<span id="cb1592-39"><a href="epicurves.html#cb1592-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1592-40"><a href="epicurves.html#cb1592-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1592-41"><a href="epicurves.html#cb1592-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="co"># légende sur le côte gauche</span></span>
<span id="cb1592-42"><a href="epicurves.html#cb1592-42" aria-hidden="true" tabindex="-1"></a>                                <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>), <span class="co"># légende en italique</span></span>
<span id="cb1592-43"><a href="epicurves.html#cb1592-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="sc">+</span> <span class="co"># titres des axes en gras</span></span>
<span id="cb1592-44"><a href="epicurves.html#cb1592-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1592-45"><a href="epicurves.html#cb1592-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes incluant une légende dynamique</span></span>
<span id="cb1592-46"><a href="epicurves.html#cb1592-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1592-47"><a href="epicurves.html#cb1592-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas (semaines de lundi)&quot;</span>,</span>
<span id="cb1592-48"><a href="epicurves.html#cb1592-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Notez l&#39;alignement des barres, des lignes de grille verticales et des étiquettes d&#39;axe sur les semaines du lundi&quot;</span>,</span>
<span id="cb1592-49"><a href="epicurves.html#cb1592-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1592-50"><a href="epicurves.html#cb1592-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Incidence hebdomadaire des cas signalés&quot;</span>,</span>
<span id="cb1592-51"><a href="epicurves.html#cb1592-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">&quot;n = {nrow(central_data)} de Central Hospital ; Les occurrences de cas ranges de {format(min(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)} à {format(max(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)}{nrow(central_data %&gt;% filter(is.na(date_onset)))} cas dont la date d&#39;apparition est manquante et qui ne sont pas indiqués&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1179-1.png" width="672" /></p>
<div id="semaines-de-dimanche" class="section level4 unnumbered">
<h4>Semaines de dimanche</h4>
<p>Pour obtenir le graphique ci-dessus pour les semaines de dimanche, quelques modifications sont nécessaires, car les <code>date_breaks = "weeks"</code> ne fonctionnent que pour les semaines de lundi.</p>
<ul>
<li>Les points de rupture des <em>bins de l’histogramme</em> doivent étre fixés au dimanche (<code>week_start = 7</code>)<br />
</li>
<li>Dans <code>scale_x_date()</code>, les ruptures de date similaires doivent étre fournies à <code>breaks =</code> et <code>minor_breaks =</code> pour s’assurer que les étiquettes de date et les lignes de grille verticales s’alignent sur les dimanches.</li>
</ul>
<p>Par exemple, la commande <code>scale_x_date()</code> pour les semaines du dimanche pourrait ressembler à ceci :</p>
<div class="sourceCode" id="cb1593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1593-1"><a href="epicurves.html#cb1593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_date</span>(</span>
<span id="cb1593-2"><a href="epicurves.html#cb1593-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1593-3"><a href="epicurves.html#cb1593-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1593-4"><a href="epicurves.html#cb1593-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># spécifie l&#39;intervalle des étiquettes de date et des principales lignes de grille verticales</span></span>
<span id="cb1593-5"><a href="epicurves.html#cb1593-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq.Date</span>(</span>
<span id="cb1593-6"><a href="epicurves.html#cb1593-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>), <span class="co"># dimanche avant la premiére affaire</span></span>
<span id="cb1593-7"><a href="epicurves.html#cb1593-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>), <span class="co"># dimanche aprés la derniére affaire</span></span>
<span id="cb1593-8"><a href="epicurves.html#cb1593-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">&quot;4 weeks&quot;</span>),</span>
<span id="cb1593-9"><a href="epicurves.html#cb1593-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1593-10"><a href="epicurves.html#cb1593-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># spécifier l&#39;intervalle de la ligne de grille verticale mineure </span></span>
<span id="cb1593-11"><a href="epicurves.html#cb1593-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq.Date</span>(</span>
<span id="cb1593-12"><a href="epicurves.html#cb1593-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>), <span class="co"># dimanche avant le premier cas</span></span>
<span id="cb1593-13"><a href="epicurves.html#cb1593-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>), <span class="co"># dimanche aprés la derniére affaire</span></span>
<span id="cb1593-14"><a href="epicurves.html#cb1593-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">&quot;week&quot;</span>),</span>
<span id="cb1593-15"><a href="epicurves.html#cb1593-15" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb1593-16"><a href="epicurves.html#cb1593-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># format des étiquettes de date</span></span>
<span id="cb1593-17"><a href="epicurves.html#cb1593-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%a</span><span class="sc">\n</span><span class="st">%d %b</span><span class="sc">\n</span><span class="st">%Y&quot;</span>)<span class="sc">+</span> <span class="co"># jour, au-dessus abréviation du mois, au-dessus année à 2 chiffres</span></span></code></pre></div>
</div>
</div>
<div id="groupercolorer-par-valeur" class="section level3 unnumbered">
<h3>Grouper/colorer par valeur</h3>
<p>Les barres de l’histogramme peuvent étre colorées par groupe et “empilées”. Pour désigner la colonne de regroupement, effectuez les modifications suivantes. Voir la page <a href="ggplot_basics.html#ggplot_basics">ggplot basics</a> pour plus de détails.</p>
<ul>
<li>Dans le mappage esthétique de l’histogramme <code>aes()</code>, mettez en correspondance le nom de la colonne avec les arguments <code>group =</code> et <code>fill =</code>.<br />
</li>
<li>Supprimez tout argument <code>fill =</code> à l’extérieur de <code>aes()</code>, car il remplacera celui qui se trouve à l’intérieur.<br />
</li>
<li>Les arguments <em>inside</em> de <code>aes()</code> s’appliqueront <em>par groupe</em>, alors que les arguments <em>outside</em> s’appliqueront à toutes les barres (par exemple, vous pouvez toujours vouloir <code>color =</code> à l’extérieur, pour que chaque barre ait la même bordure).</li>
</ul>
<p>Voici à quoi ressemblerait la commande <code>aes()</code> pour grouper et colorer les barres par sexe :</p>
<div class="sourceCode" id="cb1594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1594-1"><a href="epicurves.html#cb1594-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">x =</span> date_onset, <span class="at">group =</span> gender, <span class="at">fill =</span> gender)</span></code></pre></div>
<p>Le voici appliqué :</p>
<div class="sourceCode" id="cb1595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1595-1"><a href="epicurves.html#cb1595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> linelist) <span class="sc">+</span> <span class="co"># commencer avec linelist (many hospitals)</span></span>
<span id="cb1595-2"><a href="epicurves.html#cb1595-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1595-3"><a href="epicurves.html#cb1595-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># faire un histogramme : spécifier les points de rupture de la benne : commence le lundi avant le premier cas, se termine le lundi aprés le dernier cas</span></span>
<span id="cb1595-4"><a href="epicurves.html#cb1595-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1595-5"><a href="epicurves.html#cb1595-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1595-6"><a href="epicurves.html#cb1595-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> date_onset,</span>
<span id="cb1595-7"><a href="epicurves.html#cb1595-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> hospital, <span class="co"># définir les données pour qu&#39;elles soient groupées par hôpital</span></span>
<span id="cb1595-8"><a href="epicurves.html#cb1595-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> hospital), <span class="co"># remplissage des barres (couleur intérieure) par hôpital</span></span>
<span id="cb1595-9"><a href="epicurves.html#cb1595-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1595-10"><a href="epicurves.html#cb1595-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># les pauses sont les semaines de lundi</span></span>
<span id="cb1595-11"><a href="epicurves.html#cb1595-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_all, <span class="co"># séquence de pauses hebdomadaires du lundi pour toute l&#39;épidémie, définie dans le code précédent </span></span>
<span id="cb1595-12"><a href="epicurves.html#cb1595-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1595-13"><a href="epicurves.html#cb1595-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>, <span class="co"># Compter les cas à partir du début du point d&#39;arrêt</span></span>
<span id="cb1595-14"><a href="epicurves.html#cb1595-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Couleur autour des barres</span></span>
<span id="cb1595-15"><a href="epicurves.html#cb1595-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1182-1.png" width="672" /></p>
</div>
<div id="ajuster-les-couleurs" class="section level3 unnumbered">
<h3>Ajuster les couleurs</h3>
<ul>
<li>Pour <em>manuellement</em> régler le remplissage pour chaque groupe, utilisez <code>scale_fill_manual()</code> (note : <code>scale_color_manual()</code> est différent !).
<ul>
<li>Utilisez l’argument <code>values =</code> pour appliquer un vecteur de couleurs.<br />
</li>
<li>Utilisez <code>na.value =</code> pour spécifier une couleur pour les valeurs <code>NA</code>.<br />
</li>
<li>Utilisez l’argument <code>labels =</code> pour changer le texte des éléments de la légende. Pour étre sur, fournissez un vecteur nommé comme <code>c("old" = "new", "old" = "new")</code> ou ajustez les valeurs dans les données elles-mêmes.<br />
</li>
<li>Utilisez <code>name =</code> pour donner un titre correct à la légende.<br />
</li>
</ul></li>
<li>Pour plus d’informations sur les échelles et les palettes de couleurs, consultez la page sur <a href="ggplot_basics.html#ggplot_basics">les bases de ggplot</a>.</li>
</ul>
<div class="sourceCode" id="cb1596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1596-1"><a href="epicurves.html#cb1596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> linelist)<span class="sc">+</span> <span class="co"># commencer avec linelist (plusieurs hôpitaux)</span></span>
<span id="cb1596-2"><a href="epicurves.html#cb1596-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1596-3"><a href="epicurves.html#cb1596-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># faire un histogramme</span></span>
<span id="cb1596-4"><a href="epicurves.html#cb1596-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1596-5"><a href="epicurves.html#cb1596-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset,</span>
<span id="cb1596-6"><a href="epicurves.html#cb1596-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> hospital, <span class="co"># cas groupés par hôpital</span></span>
<span id="cb1596-7"><a href="epicurves.html#cb1596-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> hospital), <span class="co"># remplissage des barres par hôpital</span></span>
<span id="cb1596-8"><a href="epicurves.html#cb1596-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1596-9"><a href="epicurves.html#cb1596-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin breaks</span></span>
<span id="cb1596-10"><a href="epicurves.html#cb1596-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_all, <span class="co"># séquence de bin breaks hebdomadaires du lundi, définie dans le code précédent</span></span>
<span id="cb1596-11"><a href="epicurves.html#cb1596-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1596-12"><a href="epicurves.html#cb1596-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>, <span class="co"># Compter les cas à partir du début du point d&#39;arrêt</span></span>
<span id="cb1596-13"><a href="epicurves.html#cb1596-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1596-14"><a href="epicurves.html#cb1596-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="co"># couleur de la bordure de chaque barre</span></span>
<span id="cb1596-15"><a href="epicurves.html#cb1596-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1596-16"><a href="epicurves.html#cb1596-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spécification manuelle des couleurs</span></span>
<span id="cb1596-17"><a href="epicurves.html#cb1596-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb1596-18"><a href="epicurves.html#cb1596-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;beige&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;brown&quot;</span>),</span>
<span id="cb1596-19"><a href="epicurves.html#cb1596-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;St. Mark&#39;s Maternity Hospital (SMMH)&quot;</span> <span class="ot">=</span> <span class="st">&quot;St.Mark&#39;s&quot;</span>),</span>
<span id="cb1596-20"><a href="epicurves.html#cb1596-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Hospital&quot;</span>) <span class="co"># spécifier les couleurs de remplissage (&quot;values&quot;) - attention à l&#39;ordre !</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1183-1.png" width="672" /></p>
</div>
<div id="ajuster-lordre-des-niveaux-1" class="section level3 unnumbered">
<h3>Ajuster l’ordre des niveaux</h3>
<p>Le meilleur moyen d’ajuster l’ordre dans lequel les barres groupées sont empilées est de classer la colonne de groupage en tant que classe Facteur. Vous pouvez alors désigner l’ordre des niveaux de facteurs (et leurs étiquettes d’affichage). Voir la page sur <a href="factors.html#factors">facteurs</a> ou <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a> pour plus de détails.</p>
<p>Avant de réaliser le tracé, utilisez la fonction <code>fct_relevel()</code> du paquet <strong>forcats</strong> pour convertir la colonne de regroupement en classe facteur et ajuster manuellement l’ordre des niveaux, comme détaillé dans la page sur les <a href="factors.html#factors">facteurs</a>.</p>
<div class="sourceCode" id="cb1597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1597-1"><a href="epicurves.html#cb1597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># charger le paquet forcats pour travailler avec les facteurs</span></span>
<span id="cb1597-2"><a href="epicurves.html#cb1597-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(forcats)</span>
<span id="cb1597-3"><a href="epicurves.html#cb1597-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1597-4"><a href="epicurves.html#cb1597-4" aria-hidden="true" tabindex="-1"></a><span class="co"># définir un nouvel ensemble de données avec l&#39;hôpital comme facteur</span></span>
<span id="cb1597-5"><a href="epicurves.html#cb1597-5" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1597-6"><a href="epicurves.html#cb1597-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hospital =</span> <span class="fu">fct_relevel</span>(hospital, <span class="fu">c</span>(<span class="st">&quot;Missing&quot;</span>, <span class="st">&quot;Other&quot;</span>))) <span class="co"># Convertir en facteur et définir &quot;Manquant&quot; et &quot;Autre&quot; comme niveaux supérieurs pour apparaétre sur le sommet de l&#39;épicurve.</span></span>
<span id="cb1597-7"><a href="epicurves.html#cb1597-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1597-8"><a href="epicurves.html#cb1597-8" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(plot_data<span class="sc">$</span>hospital) <span class="co"># Imprime les niveaux dans l&#39;ordre</span></span></code></pre></div>
<pre><code>## [1] &quot;Missing&quot;                              &quot;Other&quot;                                &quot;Central Hospital&quot;                    
## [4] &quot;Military Hospital&quot;                    &quot;Port Hospital&quot;                        &quot;St. Mark&#39;s Maternity Hospital (SMMH)&quot;</code></pre>
<p>Dans le graphique ci-dessous, les seules différences par rapport au précédent sont que la colonne <code>hospital</code> a été consolidée comme ci-dessus, et que nous utilisons <code>guides()</code> pour inverser l’ordre de la légende, de sorte que “Missing” se trouve en bas de la légende.</p>
<div class="sourceCode" id="cb1599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1599-1"><a href="epicurves.html#cb1599-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data) <span class="sc">+</span> <span class="co"># Utiliser le NOUVEL ensemble de données avec les hôpitaux comme facteurs réordonnés.</span></span>
<span id="cb1599-2"><a href="epicurves.html#cb1599-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1599-3"><a href="epicurves.html#cb1599-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># créer un histogramme</span></span>
<span id="cb1599-4"><a href="epicurves.html#cb1599-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1599-5"><a href="epicurves.html#cb1599-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset,</span>
<span id="cb1599-6"><a href="epicurves.html#cb1599-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> hospital, <span class="co"># cas groupés par hôpital</span></span>
<span id="cb1599-7"><a href="epicurves.html#cb1599-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> hospital), <span class="co"># remplissage des barres (couleur) par hôpital</span></span>
<span id="cb1599-8"><a href="epicurves.html#cb1599-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1599-9"><a href="epicurves.html#cb1599-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_all, <span class="co"># séquence de pauses hebdomadaires du lundi pour toute l&#39;épidémie, définie en haut de la section ggplot</span></span>
<span id="cb1599-10"><a href="epicurves.html#cb1599-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1599-11"><a href="epicurves.html#cb1599-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="co"># couleur de la bordure autour de chaque barre</span></span>
<span id="cb1599-12"><a href="epicurves.html#cb1599-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1599-13"><a href="epicurves.html#cb1599-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes de l&#39;axe des x</span></span>
<span id="cb1599-14"><a href="epicurves.html#cb1599-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1599-15"><a href="epicurves.html#cb1599-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprimer l&#39;espace excédentaire sur l&#39;axe des x avant et aprés les barres de cas</span></span>
<span id="cb1599-16"><a href="epicurves.html#cb1599-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;3 weeks&quot;</span>, <span class="co"># les étiquettes apparaissent toutes les 3 semaines du lundi</span></span>
<span id="cb1599-17"><a href="epicurves.html#cb1599-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># les lignes verticales apparaissent tous les lundis de la semaine</span></span>
<span id="cb1599-18"><a href="epicurves.html#cb1599-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes de date</span></span>
<span id="cb1599-19"><a href="epicurves.html#cb1599-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1599-20"><a href="epicurves.html#cb1599-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axe des y</span></span>
<span id="cb1599-21"><a href="epicurves.html#cb1599-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1599-22"><a href="epicurves.html#cb1599-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire sur l&#39;axe des y en dessous de 0</span></span>
<span id="cb1599-23"><a href="epicurves.html#cb1599-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1599-24"><a href="epicurves.html#cb1599-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spécification manuelle des couleurs, ! attention à l&#39;ordre</span></span>
<span id="cb1599-25"><a href="epicurves.html#cb1599-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb1599-26"><a href="epicurves.html#cb1599-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;beige&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;brown&quot;</span>),</span>
<span id="cb1599-27"><a href="epicurves.html#cb1599-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;St. Mark&#39;s Maternity Hospital (SMMH)&quot;</span> <span class="ot">=</span> <span class="st">&quot;St.Marks&quot;</span>),</span>
<span id="cb1599-28"><a href="epicurves.html#cb1599-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Hospital&quot;</span>)<span class="sc">+</span> </span>
<span id="cb1599-29"><a href="epicurves.html#cb1599-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1599-30"><a href="epicurves.html#cb1599-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thèmes esthétiques</span></span>
<span id="cb1599-31"><a href="epicurves.html#cb1599-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># simplifier le fond du graphique</span></span>
<span id="cb1599-32"><a href="epicurves.html#cb1599-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1599-33"><a href="epicurves.html#cb1599-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1599-34"><a href="epicurves.html#cb1599-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="co"># légende à gauche en italique</span></span>
<span id="cb1599-35"><a href="epicurves.html#cb1599-35" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hjust =</span> <span class="dv">0</span>), </span>
<span id="cb1599-36"><a href="epicurves.html#cb1599-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="sc">+</span> <span class="co"># titres des axes en gras</span></span>
<span id="cb1599-37"><a href="epicurves.html#cb1599-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1599-38"><a href="epicurves.html#cb1599-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes</span></span>
<span id="cb1599-39"><a href="epicurves.html#cb1599-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1599-40"><a href="epicurves.html#cb1599-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas par hôpital&quot;</span>,</span>
<span id="cb1599-41"><a href="epicurves.html#cb1599-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hospital as re-ordered factor&quot;</span>,</span>
<span id="cb1599-42"><a href="epicurves.html#cb1599-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1599-43"><a href="epicurves.html#cb1599-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cas hebdomadaires&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1185-1.png" width="672" /></p>
<p><span style="color : darkgreen ;"><strong><em>TIP:</em></strong> Pour inverser l’ordre de la légende uniquement, ajoutez cette commande <strong>ggplot2</strong> : <code>guides(fill = guide_legend(reverse = TRUE))</code>.</span></p>
</div>
<div id="ajuster-la-légende" class="section level3 unnumbered">
<h3>Ajuster la légende</h3>
<p>Pour en savoir plus sur les légendes et les échelles, consultez la page <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a>. Voici quelques points saillants :</p>
<ul>
<li>Modifiez le titre de la légende soit dans la fonction d’échelle, soit avec <code>labs(fill = "Legend title")</code> (si vous utilisez <code>color =</code> esthétique, alors utilisez <code>labs(color = "")</code>).<br />
</li>
<li><code>theme(legend.title = element_blank())</code> pour ne pas avoir de titre de légende<br />
</li>
<li><code>theme(legend.position = "top")</code> (“bottom”, “left”, “right”, ou “none” pour supprimer la légende)</li>
<li><code>theme(legend.direction = "horizontal")</code> légende horizontale</li>
<li><code>guides(fill = guide_legend(reverse = TRUE))</code> pour inverser l’ordre de la légende</li>
</ul>
</div>
<div id="bars-side-by-side-.unnumbered-barres-côte-à-côte" class="section level3" number="33.3.1">
<h3><span class="header-section-number">33.3.1</span> Bars side-by-side {.unnumbered} (barres côte à côte)</h3>
<p>L’affichage côte à côte des barres de groupe (par opposition à l’empilement) est spécifié dans <code>geom_histogram()</code> avec <code>position = "dodge"</code> placé en dehors de <code>aes()</code>.</p>
<p>S’il y a plus de deux groupes de valeurs, ceux-ci peuvent devenir difficiles à lire. Envisagez plutôt d’utiliser un graphique à facettes (petits multiples). Pour améliorer la lisibilité dans cet exemple, les valeurs de sexe manquantes sont supprimées.</p>
<div class="sourceCode" id="cb1600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1600-1"><a href="epicurves.html#cb1600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(gender))<span class="sc">+</span> <span class="co"># Commencez par les cas de l&#39;hôpital central en supprimant les valeurs manquantes pour le sexe.</span></span>
<span id="cb1600-2"><a href="epicurves.html#cb1600-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb1600-3"><a href="epicurves.html#cb1600-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1600-4"><a href="epicurves.html#cb1600-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> date_onset,</span>
<span id="cb1600-5"><a href="epicurves.html#cb1600-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">group =</span> gender, <span class="co"># cas groupés par sexe</span></span>
<span id="cb1600-6"><a href="epicurves.html#cb1600-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> gender), <span class="co"># barres remplies par sexe</span></span>
<span id="cb1600-7"><a href="epicurves.html#cb1600-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1600-8"><a href="epicurves.html#cb1600-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># histogramme bin breaks</span></span>
<span id="cb1600-9"><a href="epicurves.html#cb1600-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> weekly_breaks_central, <span class="co"># séquence de dates hebdomadaires pour le foyer central - définie en haut de la section ggplot</span></span>
<span id="cb1600-10"><a href="epicurves.html#cb1600-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1600-11"><a href="epicurves.html#cb1600-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb1600-12"><a href="epicurves.html#cb1600-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1600-13"><a href="epicurves.html#cb1600-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># couleur du bord des barres</span></span>
<span id="cb1600-14"><a href="epicurves.html#cb1600-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1600-15"><a href="epicurves.html#cb1600-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span> <span class="co"># barres SIDE-BY-SIDE</span></span>
<span id="cb1600-16"><a href="epicurves.html#cb1600-16" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb1600-17"><a href="epicurves.html#cb1600-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1600-18"><a href="epicurves.html#cb1600-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Les étiquettes sur l&#39;axe des x</span></span>
<span id="cb1600-19"><a href="epicurves.html#cb1600-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprimer l&#39;espace excédentaire de l&#39;axe des x sous et aprés les barres de cas</span></span>
<span id="cb1600-20"><a href="epicurves.html#cb1600-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">&quot;3 weeks&quot;</span>, <span class="co"># les étiquettes apparaissent toutes les 3 semaines du lundi</span></span>
<span id="cb1600-21"><a href="epicurves.html#cb1600-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># les lignes verticales apparaissent tous les lundis de la semaine</span></span>
<span id="cb1600-22"><a href="epicurves.html#cb1600-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes de date</span></span>
<span id="cb1600-23"><a href="epicurves.html#cb1600-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1600-24"><a href="epicurves.html#cb1600-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axe des y</span></span>
<span id="cb1600-25"><a href="epicurves.html#cb1600-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># supprime l&#39;espace excédentaire sur l&#39;axe des y entre le bas des barres et les étiquettes</span></span>
<span id="cb1600-26"><a href="epicurves.html#cb1600-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1600-27"><a href="epicurves.html#cb1600-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#échelle des couleurs et des étiquettes de légende</span></span>
<span id="cb1600-28"><a href="epicurves.html#cb1600-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;brown&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="co"># spécifie les couleurs de remplissage (&quot;values&quot;) - attention à l&#39;ordre !</span></span>
<span id="cb1600-29"><a href="epicurves.html#cb1600-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="st">&quot;grey&quot;</span> )<span class="sc">+</span>     </span>
<span id="cb1600-30"><a href="epicurves.html#cb1600-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1600-31"><a href="epicurves.html#cb1600-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thèmes esthétiques</span></span>
<span id="cb1600-32"><a href="epicurves.html#cb1600-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># un ensemble de thèmes pour simplifier le graphe</span></span>
<span id="cb1600-33"><a href="epicurves.html#cb1600-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>), <span class="co"># légende à gauche en italique</span></span>
<span id="cb1600-34"><a href="epicurves.html#cb1600-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="sc">+</span> <span class="co"># titres des axes en gras</span></span>
<span id="cb1600-35"><a href="epicurves.html#cb1600-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1600-36"><a href="epicurves.html#cb1600-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes</span></span>
<span id="cb1600-37"><a href="epicurves.html#cb1600-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas, par sexe&quot;</span>,</span>
<span id="cb1600-38"><a href="epicurves.html#cb1600-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Sous-titre&quot;</span>,</span>
<span id="cb1600-39"><a href="epicurves.html#cb1600-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Gender&quot;</span>, <span class="co"># fournir un nouveau titre pour la légende</span></span>
<span id="cb1600-40"><a href="epicurves.html#cb1600-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1600-41"><a href="epicurves.html#cb1600-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Incidence hebdomadaire des cas signalés&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1186-1.png" width="672" /></p>
</div>
<div id="limites-de-laxe" class="section level3 unnumbered">
<h3>Limites de l’axe</h3>
<p>Il existe deux façons de limiter l’étendue des valeurs des axes.</p>
<p>Généralement, la méthode préférée est d’utiliser la commande <code>coord_cartesian()</code>, qui accepte <code>xlim = c(min, max)</code> et <code>ylim = c(min, max)</code> (où vous fournissez les valeurs min et max). Ceci agit comme un “zoom” sans réellement supprimer de données, ce qui est important pour les statistiques et les mesures sommaires.</p>
<p>Alternativement, vous pouvez définir les valeurs maximales et minimales de la date en utilisant <code>limits = c()</code> dans <code>scale_x_date()</code>. Par exemple :</p>
<div class="sourceCode" id="cb1601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1601-1"><a href="epicurves.html#cb1601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_date</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2014-04-01&quot;</span>), <span class="cn">NA</span>)) <span class="co"># définit une date minimum mais laisse la date maximum ouverte.  </span></span></code></pre></div>
<p>Si vous souhaitez que l’axe des abscisses s’tende jusqu’é une date spécifique (par exemple, la date du jour), même si aucun nouveau cas n’a été signalé, vous pouvez utiliser :</p>
<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1602-1"><a href="epicurves.html#cb1602-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_date</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">Sys.Date</span>())) <span class="co"># garantit que l&#39;axe des dates s&#39;étendra jusqu&#39;à la date du jour  </span></span></code></pre></div>
<p><span style="color : red ;"><strong><em>DANGER:</em></strong> Soyez prudent en fixant les ruptures d’échelle ou les limites de l’axe des y (par exemple, 0 à 30 par 5 : <code>seq(0, 30, 5)</code>). De tels nombres statiques peuvent couper votre tracé trop court si les données changent pour dépasser la limite !</span>.</p>
</div>
<div id="libellés-des-axes-de-date-lignes-de-grille" class="section level3 unnumbered">
<h3>Libellés des axes de date / lignes de grille</h3>
<p><span style="color : darkgreen ;"><strong><em>TIP:</em></strong> Rappelez-vous que les <strong>étiquettes de l’axe des dates</strong> sont indépendantes de l’agrégation des données en barres, mais visuellement, il peut étre important d’aligner les bacs, les étiquettes de date et les lignes de grille verticales.</span></p>
<p>Pour <strong>modifier les étiquettes de date et les lignes de grille</strong>, utilisez <code>scale_x_date()</code> de l’une de ces façons :</p>
<ul>
<li><strong>Si vos bins d’histogramme sont des jours, lundi des semaines, des mois ou des années</strong> :
<ul>
<li>Utilisez <code>date_breaks =</code> pour spécifier l’intervalle des étiquettes et des lignes de grille principales (par exemple “jour”, “semaine”, “3 semaines”, “mois” ou “année”).</li>
<li>Utilisez <code>date_minor_breaks =</code> pour spécifier l’intervalle des lignes verticales mineures (entre les étiquettes de date)<br />
</li>
<li>Ajoutez <code>expand = c(0,0)</code> pour que les étiquettes commencent à la premiére barre.<br />
</li>
<li>Utilisez <code>date_labels =</code> pour spécifier le format des étiquettes de date - voir la page Dates pour des conseils (utilisez <code>\n</code> pour une nouvelle ligne).<br />
</li>
</ul></li>
<li><strong>Si les cases de votre histogramme sont des semaines de dimanche</strong> :
<ul>
<li>Utilisez <code>breaks =</code> et <code>minor_breaks =</code> en fournissant une séquence de ruptures de date pour chacun d’entre eux.</li>
<li>Vous pouvez toujours utiliser <code>date_labels =</code> et <code>expand =</code> pour le formatage comme décrit ci-dessus.</li>
</ul></li>
</ul>
<p>Quelques notes :</p>
<ul>
<li>Voir la section ggplot d’ouverture pour des instructions sur la façon de créer une séquence de dates en utilisant <code>seq.Date()</code>.<br />
</li>
<li>Voir <a href="https://rdrr.io/r/base/strptime.html">cette page</a> ou la page <a href="working_dates.html#working_dates">travailler avec des dates</a> pour des conseils sur la création d’étiquettes de date.</li>
</ul>
<div id="démonstrations" class="section level4 unnumbered">
<h4>Démonstrations</h4>
<p>Vous trouverez ci-dessous une démonstration de tracés où les bacs et les étiquettes/grilles sont alignés et non alignés :</p>
<div class="sourceCode" id="cb1603"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb1603-1"><a href="epicurves.html#cb1603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bacs de 7 jours + étiquettes du lundi</span></span>
<span id="cb1603-2"><a href="epicurves.html#cb1603-2" aria-hidden="true" tabindex="-1"></a><span class="do">#############################</span></span>
<span id="cb1603-3"><a href="epicurves.html#cb1603-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span></span>
<span id="cb1603-4"><a href="epicurves.html#cb1603-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1603-5"><a href="epicurves.html#cb1603-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1603-6"><a href="epicurves.html#cb1603-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">7</span>, <span class="co"># bins de 7 jours avec début au premier cas</span></span>
<span id="cb1603-7"><a href="epicurves.html#cb1603-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb1603-8"><a href="epicurves.html#cb1603-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1603-9"><a href="epicurves.html#cb1603-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-10"><a href="epicurves.html#cb1603-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1603-11"><a href="epicurves.html#cb1603-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprime l&#39;espace excédentaire sur l&#39;axe des x en dessous et aprés les barres de cas</span></span>
<span id="cb1603-12"><a href="epicurves.html#cb1603-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;3 weeks&quot;</span>, <span class="co"># Lundi toutes les 3 semaines</span></span>
<span id="cb1603-13"><a href="epicurves.html#cb1603-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># lundi semaines</span></span>
<span id="cb1603-14"><a href="epicurves.html#cb1603-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%a</span><span class="sc">\n</span><span class="st">%d</span><span class="sc">\n</span><span class="st">%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1603-15"><a href="epicurves.html#cb1603-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-16"><a href="epicurves.html#cb1603-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1603-17"><a href="epicurves.html#cb1603-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire sous l&#39;axe des x, mise à plat</span></span>
<span id="cb1603-18"><a href="epicurves.html#cb1603-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-19"><a href="epicurves.html#cb1603-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1603-20"><a href="epicurves.html#cb1603-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;MAL ALIGNÉ&quot;</span>,</span>
<span id="cb1603-21"><a href="epicurves.html#cb1603-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot; ! ATTENTION : Les barres de 7 jours commencent le jeudi avec le premier cas.</span><span class="sc">\n</span><span class="st"> Grandes lignes de grille et étiquettes de date au 1er de chaque mois.</span><span class="sc">\n</span><span class="st"> Lignes de grille mineures chaque lundi.&quot;</span>)</span>
<span id="cb1603-22"><a href="epicurves.html#cb1603-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-23"><a href="epicurves.html#cb1603-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-24"><a href="epicurves.html#cb1603-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-25"><a href="epicurves.html#cb1603-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Tranches de 7 jours + Mois</span></span>
<span id="cb1603-26"><a href="epicurves.html#cb1603-26" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb1603-27"><a href="epicurves.html#cb1603-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span></span>
<span id="cb1603-28"><a href="epicurves.html#cb1603-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1603-29"><a href="epicurves.html#cb1603-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1603-30"><a href="epicurves.html#cb1603-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">7</span>,</span>
<span id="cb1603-31"><a href="epicurves.html#cb1603-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb1603-32"><a href="epicurves.html#cb1603-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1603-33"><a href="epicurves.html#cb1603-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-34"><a href="epicurves.html#cb1603-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1603-35"><a href="epicurves.html#cb1603-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprime l&#39;espace excédentaire de l&#39;axe des x sous et aprés les barres de cas</span></span>
<span id="cb1603-36"><a href="epicurves.html#cb1603-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;months&quot;</span>, <span class="co"># 1er du mois</span></span>
<span id="cb1603-37"><a href="epicurves.html#cb1603-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># semaines de lundi</span></span>
<span id="cb1603-38"><a href="epicurves.html#cb1603-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%a</span><span class="sc">\n</span><span class="st">%d %b</span><span class="sc">\n</span><span class="st">%Y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1603-39"><a href="epicurves.html#cb1603-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-40"><a href="epicurves.html#cb1603-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1603-41"><a href="epicurves.html#cb1603-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># Suppression de l&#39;espace excédentaire sous l&#39;axe des x, mise à plat des données </span></span>
<span id="cb1603-42"><a href="epicurves.html#cb1603-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-43"><a href="epicurves.html#cb1603-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1603-44"><a href="epicurves.html#cb1603-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;MAL ALIGNÉ&quot;</span>,</span>
<span id="cb1603-45"><a href="epicurves.html#cb1603-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot; ! ATTENTION : Les barres de 7 jours commencent le jeudi avec le premier cas</span><span class="sc">\n</span><span class="st">Les lignes de grille principales et les étiquettes de date au 1er de chaque mois</span><span class="sc">\n</span><span class="st">Les lignes de grille mineures sont hebdomadaires le lundi</span><span class="sc">\n</span><span class="st">Notez l&#39;espacement inégal de certaines lignes de grille et les tics non alignés avec les barres&quot;</span></span>
<span id="cb1603-46"><a href="epicurves.html#cb1603-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1603-47"><a href="epicurves.html#cb1603-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-48"><a href="epicurves.html#cb1603-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-49"><a href="epicurves.html#cb1603-49" aria-hidden="true" tabindex="-1"></a><span class="co"># ALIGNEMENT TOTAL DU LUNDI : spécifier que les pauses manuelles sont des lundis</span></span>
<span id="cb1603-50"><a href="epicurves.html#cb1603-50" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb1603-51"><a href="epicurves.html#cb1603-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span> </span>
<span id="cb1603-52"><a href="epicurves.html#cb1603-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1603-53"><a href="epicurves.html#cb1603-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1603-54"><a href="epicurves.html#cb1603-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-55"><a href="epicurves.html#cb1603-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># les ruptures d&#39;histogramme sont fixées à 7 jours commençant le lundi avant le premier cas</span></span>
<span id="cb1603-56"><a href="epicurves.html#cb1603-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central, <span class="co"># défini plus tôt dans cette page</span></span>
<span id="cb1603-57"><a href="epicurves.html#cb1603-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-58"><a href="epicurves.html#cb1603-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb1603-59"><a href="epicurves.html#cb1603-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-60"><a href="epicurves.html#cb1603-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb1603-61"><a href="epicurves.html#cb1603-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-62"><a href="epicurves.html#cb1603-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1603-63"><a href="epicurves.html#cb1603-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-64"><a href="epicurves.html#cb1603-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1603-65"><a href="epicurves.html#cb1603-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprime l&#39;espace excédentaire sur l&#39;axe x en dessous et aprés les barres de cas</span></span>
<span id="cb1603-66"><a href="epicurves.html#cb1603-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;4 weeks&quot;</span>, <span class="co"># Lundi toutes les 4 semaines</span></span>
<span id="cb1603-67"><a href="epicurves.html#cb1603-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># lundi semaines </span></span>
<span id="cb1603-68"><a href="epicurves.html#cb1603-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%a</span><span class="sc">\n</span><span class="st">%d %b</span><span class="sc">\n</span><span class="st">%Y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1603-69"><a href="epicurves.html#cb1603-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-70"><a href="epicurves.html#cb1603-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1603-71"><a href="epicurves.html#cb1603-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># Suppression de l&#39;espace excédentaire sous l&#39;axe des x, mise à plat des données </span></span>
<span id="cb1603-72"><a href="epicurves.html#cb1603-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-73"><a href="epicurves.html#cb1603-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1603-74"><a href="epicurves.html#cb1603-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lundis ALIGNÉS&quot;</span>,</span>
<span id="cb1603-75"><a href="epicurves.html#cb1603-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Les intervalles de 7 jours sont réglés manuellement pour commencer le lundi avant le premier cas (28 avr.)</span><span class="sc">\n</span><span class="st"> Les étiquettes de date et les lignes de grille sont aussi sur les lundis&quot;</span>)</span>
<span id="cb1603-76"><a href="epicurves.html#cb1603-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-77"><a href="epicurves.html#cb1603-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-78"><a href="epicurves.html#cb1603-78" aria-hidden="true" tabindex="-1"></a><span class="co"># ALIGNEMENT TOTAL DES LUNDIS AVEC LES étiQUETTES DE MOIS :</span></span>
<span id="cb1603-79"><a href="epicurves.html#cb1603-79" aria-hidden="true" tabindex="-1"></a><span class="do">############################################</span></span>
<span id="cb1603-80"><a href="epicurves.html#cb1603-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span> </span>
<span id="cb1603-81"><a href="epicurves.html#cb1603-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1603-82"><a href="epicurves.html#cb1603-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1603-83"><a href="epicurves.html#cb1603-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-84"><a href="epicurves.html#cb1603-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ruptures d&#39;histogramme fixées à 7 jours commençant le lundi avant le premier cas</span></span>
<span id="cb1603-85"><a href="epicurves.html#cb1603-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central, <span class="co"># défini plus tôt dans cette page</span></span>
<span id="cb1603-86"><a href="epicurves.html#cb1603-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-87"><a href="epicurves.html#cb1603-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb1603-88"><a href="epicurves.html#cb1603-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-89"><a href="epicurves.html#cb1603-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb1603-90"><a href="epicurves.html#cb1603-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-91"><a href="epicurves.html#cb1603-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1603-92"><a href="epicurves.html#cb1603-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-93"><a href="epicurves.html#cb1603-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1603-94"><a href="epicurves.html#cb1603-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprime l&#39;espace excédentaire sur l&#39;axe x en dessous et aprés les barres de cas</span></span>
<span id="cb1603-95"><a href="epicurves.html#cb1603-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;months&quot;</span>, <span class="co"># Lundi toutes les 4 semaines</span></span>
<span id="cb1603-96"><a href="epicurves.html#cb1603-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># lundi semaines </span></span>
<span id="cb1603-97"><a href="epicurves.html#cb1603-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%b</span><span class="sc">\n</span><span class="st">%Y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1603-98"><a href="epicurves.html#cb1603-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-99"><a href="epicurves.html#cb1603-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1603-100"><a href="epicurves.html#cb1603-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire sous l&#39;axe des x, mise à plat </span></span>
<span id="cb1603-101"><a href="epicurves.html#cb1603-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-102"><a href="epicurves.html#cb1603-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>())<span class="sc">+</span> <span class="co"># Suppression des lignes de grille principales (tombent le 1er du mois)</span></span>
<span id="cb1603-103"><a href="epicurves.html#cb1603-103" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb1603-104"><a href="epicurves.html#cb1603-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1603-105"><a href="epicurves.html#cb1603-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lundis ALIGNÉS avec étiquettes MONTHLY&quot;</span>,</span>
<span id="cb1603-106"><a href="epicurves.html#cb1603-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Bacs de 7 jours réglés manuellement pour commencer le lundi avant le premier cas (28 avril) - étiquettes de date le 1er du mois - Suppression des principaux quadrillages mensuels&quot;</span>)</span>
<span id="cb1603-107"><a href="epicurves.html#cb1603-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-108"><a href="epicurves.html#cb1603-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1603-109"><a href="epicurves.html#cb1603-109" aria-hidden="true" tabindex="-1"></a><span class="co"># ALIGNEMENT TOTAL DU DIMANCHE : spécifier les ruptures manuelles des bacs ET les étiquettes pour les dimanches</span></span>
<span id="cb1603-110"><a href="epicurves.html#cb1603-110" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb1603-111"><a href="epicurves.html#cb1603-111" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span> </span>
<span id="cb1603-112"><a href="epicurves.html#cb1603-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1603-113"><a href="epicurves.html#cb1603-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1603-114"><a href="epicurves.html#cb1603-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-115"><a href="epicurves.html#cb1603-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ruptures d&#39;histogramme fixées à 7 jours commençant le dimanche avant le premier cas</span></span>
<span id="cb1603-116"><a href="epicurves.html#cb1603-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>),</span>
<span id="cb1603-117"><a href="epicurves.html#cb1603-117" aria-hidden="true" tabindex="-1"></a>                      <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>),</span>
<span id="cb1603-118"><a href="epicurves.html#cb1603-118" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by =</span> <span class="st">&quot;7 days&quot;</span>),</span>
<span id="cb1603-119"><a href="epicurves.html#cb1603-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-120"><a href="epicurves.html#cb1603-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb1603-121"><a href="epicurves.html#cb1603-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-122"><a href="epicurves.html#cb1603-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb1603-123"><a href="epicurves.html#cb1603-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-124"><a href="epicurves.html#cb1603-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1603-125"><a href="epicurves.html#cb1603-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-126"><a href="epicurves.html#cb1603-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1603-127"><a href="epicurves.html#cb1603-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1603-128"><a href="epicurves.html#cb1603-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># les ruptures de l&#39;étiquette de date et les principales lignes de la grille sont fixées à toutes les 3 semaines, en commençant le dimanche avant le premier cas.</span></span>
<span id="cb1603-129"><a href="epicurves.html#cb1603-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>),</span>
<span id="cb1603-130"><a href="epicurves.html#cb1603-130" aria-hidden="true" tabindex="-1"></a>                      <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>),</span>
<span id="cb1603-131"><a href="epicurves.html#cb1603-131" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by =</span> <span class="st">&quot;3 weeks&quot;</span>),</span>
<span id="cb1603-132"><a href="epicurves.html#cb1603-132" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-133"><a href="epicurves.html#cb1603-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># grilles mineures fixées à la semaine commençant le dimanche avant le premier cas</span></span>
<span id="cb1603-134"><a href="epicurves.html#cb1603-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">floor_date</span>(<span class="fu">min</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>),</span>
<span id="cb1603-135"><a href="epicurves.html#cb1603-135" aria-hidden="true" tabindex="-1"></a>                            <span class="at">to =</span> <span class="fu">ceiling_date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm=</span>T), <span class="st">&quot;week&quot;</span>, <span class="at">week_start =</span> <span class="dv">7</span>),</span>
<span id="cb1603-136"><a href="epicurves.html#cb1603-136" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="st">&quot;7 days&quot;</span>),</span>
<span id="cb1603-137"><a href="epicurves.html#cb1603-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1603-138"><a href="epicurves.html#cb1603-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%a</span><span class="sc">\n</span><span class="st">%d</span><span class="sc">\n</span><span class="st">%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1603-139"><a href="epicurves.html#cb1603-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-140"><a href="epicurves.html#cb1603-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1603-141"><a href="epicurves.html#cb1603-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire sous l&#39;axe des x, mise à plat </span></span>
<span id="cb1603-142"><a href="epicurves.html#cb1603-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1603-143"><a href="epicurves.html#cb1603-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dimanches ALIGNÉS&quot;</span>,</span>
<span id="cb1603-144"><a href="epicurves.html#cb1603-144" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Les intervalles de 7 jours ont été réglés manuellement pour commencer le dimanche avant le premier cas (27 avril)</span><span class="sc">\n</span><span class="st"> Les étiquettes de date et les lignes de grille ont également été réglées manuellement sur les dimanches&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1189-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-1189-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-1189-3.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-1189-4.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-1189-5.png" width="672" /></p>
</div>
</div>
<div id="données-agrégées" class="section level3 unnumbered">
<h3>données agrégées</h3>
<p>Souvent, au lieu d’une liste de lignes, vous commencez par des comptages agrégés d’établissements, de districts, etc. Vous pouvez faire une épicurve avec <code>ggplot()</code> mais le code sera légérement différent. Cette section va utiliser le jeu de données <code>count_data</code> qui a été importé plus tôt, dans la section de préparation des données. Ce jeu de données est la <code>linelist</code> agrégée au nombre de jours d’hospitalisation. Les 50 premiéres lignes sont affichôes ci-dessous.</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-dcfb0cdb6f64d9e27631" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dcfb0cdb6f64d9e27631">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1399334400000\" data-max=\"1410307200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital"],["2014-05-06","2014-05-10","2014-05-13","2014-05-28","2014-06-06","2014-06-09","2014-06-14","2014-06-19","2014-07-09","2014-07-10","2014-07-11","2014-07-13","2014-07-14","2014-07-15","2014-07-17","2014-07-19","2014-07-27","2014-07-30","2014-08-01","2014-08-02","2014-08-04","2014-08-05","2014-08-07","2014-08-09","2014-08-12","2014-08-14","2014-08-15","2014-08-16","2014-08-17","2014-08-18","2014-08-19","2014-08-20","2014-08-21","2014-08-22","2014-08-23","2014-08-24","2014-08-26","2014-08-28","2014-08-29","2014-08-30","2014-08-31","2014-09-01","2014-09-02","2014-09-03","2014-09-04","2014-09-05","2014-09-06","2014-09-07","2014-09-09","2014-09-10"],[1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,2,1,1,2,1,3,1,1,1,2,3,2,2,2,1,2,2,2,1,2,3,3,2,1,1,2,3,2,2,1]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>hospital<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>n_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div id="tracer-des-épicentres-quotidiens" class="section level4 unnumbered">
<h4>Tracer des épicentres quotidiens</h4>
<p>Nous pouvons tracer une épicurve quotidienne à partir de ces <em>comptes quotidiens</em>. Voici les différences par rapport au code :</p>
<ul>
<li>Dans le mappage esthétique <code>aes()</code>, spécifiez <code>y =</code> comme colonne de comptage (dans ce cas, le nom de la colonne est <code>n_cases</code>).</li>
<li>Ajoutez l’argument <code>stat = "identity"</code> dans <code>geom_histogram()</code>, qui spécifie que la hauteur de la barre doit étre la valeur <code>y =</code>, et non le nombre de lignes comme c’est le cas par défaut.<br />
</li>
<li>Ajoutez l’argument <code>width =</code> pour éviter les lignes blanches verticales entre les barres. Pour les données quotidiennes, fixez la valeur à 1. Pour les données de comptage hebdomadaire, fixez la valeur à 7. Pour les données de comptage mensuel, les lignes blanches sont un probléme (chaque mois a un nombre de jours différent) - envisagez de transformer votre axe des x en un facteur ordonné catégorique (mois) et utilisez `geom_col()``.</li>
</ul>
<div class="sourceCode" id="cb1604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1604-1"><a href="epicurves.html#cb1604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> count_data) <span class="sc">+</span></span>
<span id="cb1604-2"><a href="epicurves.html#cb1604-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1604-3"><a href="epicurves.html#cb1604-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_hospitalisation, <span class="at">y =</span> n_cases),</span>
<span id="cb1604-4"><a href="epicurves.html#cb1604-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb1604-5"><a href="epicurves.html#cb1604-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># pour les comptages quotidiens, définir width = 1 pour éviter les espaces blancs entre les barres</span></span>
<span id="cb1604-6"><a href="epicurves.html#cb1604-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1604-7"><a href="epicurves.html#cb1604-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Date du rapport&quot;</span>, </span>
<span id="cb1604-8"><a href="epicurves.html#cb1604-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Nombre de cas&quot;</span>,</span>
<span id="cb1604-9"><a href="epicurves.html#cb1604-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Incidence quotidienne des cas, à partir des données de comptage quotidiennes&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1191-1.png" width="672" /></p>
</div>
<div id="tracer-les-comptages-hebdomadaires" class="section level4 unnumbered">
<h4>Tracer les comptages hebdomadaires</h4>
<p>Si vos données sont déjà des comptages de cas par semaine, elles peuvent ressembler à cet ensemble de données (appelé <code>count_data_weekly</code>) :</p>
<p>Les 50 premiéres lignes de <code>count_data_weekly</code> sont affichées ci-dessous. Vous pouvez voir que les comptes ont été agrégés en semaines. Chaque semaine est affichée par le premier jour de la semaine (lundi par défaut).</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e75ada2a550feca188af" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e75ada2a550feca188af">{"x":{"filter":"none","vertical":false,"data":[["Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)","St. Mark's Maternity Hospital (SMMH)"],["2014-05-04","2014-05-11","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-07-06","2014-07-13","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15","2015-03-22","2015-03-29","2015-04-05","2015-04-12","2015-04-19","2015-04-26","2014-04-13","2014-05-11","2014-05-18","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-06-22","2014-06-29","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15","2015-03-22","2015-03-29","2015-04-05","2015-04-12","2015-04-19","2015-04-26","2014-04-27","2014-05-04","2014-05-11","2014-05-18","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-06-22","2014-06-29","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15","2015-03-22","2015-03-29","2015-04-05","2015-04-12","2015-04-19","2015-04-26","2014-04-20","2014-04-27","2014-05-04","2014-05-11","2014-05-18","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-06-22","2014-06-29","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15","2015-03-22","2015-03-29","2015-04-05","2015-04-12","2015-04-19","2015-04-26","2014-04-20","2014-05-04","2014-05-18","2014-05-25","2014-06-01","2014-06-08","2014-06-15","2014-06-22","2014-06-29","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15","2015-03-22","2015-03-29","2015-04-05","2015-04-12","2015-04-19","2015-04-26","2014-05-04","2014-05-18","2014-05-25","2014-06-01","2014-06-15","2014-06-22","2014-07-06","2014-07-13","2014-07-20","2014-07-27","2014-08-03","2014-08-10","2014-08-17","2014-08-24","2014-08-31","2014-09-07","2014-09-14","2014-09-21","2014-09-28","2014-10-05","2014-10-12","2014-10-19","2014-10-26","2014-11-02","2014-11-09","2014-11-16","2014-11-23","2014-11-30","2014-12-07","2014-12-14","2014-12-21","2014-12-28","2015-01-04","2015-01-11","2015-01-18","2015-01-25","2015-02-01","2015-02-08","2015-02-15","2015-02-22","2015-03-01","2015-03-08","2015-03-15","2015-03-22","2015-03-29","2015-04-05","2015-04-12","2015-04-19","2015-04-26"],[2,1,2,1,2,1,3,7,5,6,6,13,9,15,12,23,24,23,25,26,23,19,25,19,14,9,10,9,8,12,5,10,5,6,6,4,8,9,8,2,5,3,4,5,6,3,6,5,1,6,3,4,2,3,3,2,3,4,6,13,11,17,18,16,18,31,33,46,44,43,42,39,36,39,51,22,15,31,27,23,24,12,15,22,22,20,17,16,8,13,9,15,13,6,10,4,5,4,5,4,2,1,4,2,5,8,5,9,11,7,12,8,10,12,27,21,34,40,48,53,75,79,85,84,80,77,54,43,41,31,33,37,26,39,30,31,24,33,20,21,21,22,19,20,23,10,13,19,18,10,12,12,8,1,1,1,3,3,3,2,4,2,5,3,8,10,8,11,16,11,15,25,23,39,46,50,49,40,53,44,38,29,29,23,26,26,19,17,19,14,18,16,15,14,17,6,6,9,11,8,11,12,5,5,7,6,3,1,4,3,8,6,3,9,9,9,11,14,15,21,25,22,37,59,53,70,93,107,103,87,64,77,74,75,59,56,58,49,46,34,40,24,20,27,27,28,24,22,15,28,24,18,23,13,22,11,10,12,13,2,3,1,3,1,2,5,3,6,5,7,4,8,7,12,20,27,19,22,23,15,18,13,16,20,10,17,6,13,8,8,8,9,1,8,7,6,6,8,6,4,13,5,2,3,5,2,3,2]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>hospital<\/th>\n      <th>epiweek<\/th>\n      <th>n_cases_weekly<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Maintenant, tracez le graphique de façon à ce que <code>x =</code> la colonne epiweek. N’oubliez pas d’ajouter <code>y =</code> la colonne des comptes à la mapping esthétique, et ajoutez <code>stat = "identity"</code> comme expliqué ci-dessus.</p>
<div class="sourceCode" id="cb1605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1605-1"><a href="epicurves.html#cb1605-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> count_data_weekly)<span class="sc">+</span></span>
<span id="cb1605-2"><a href="epicurves.html#cb1605-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1605-3"><a href="epicurves.html#cb1605-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1605-4"><a href="epicurves.html#cb1605-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1605-5"><a href="epicurves.html#cb1605-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> epiweek, <span class="co"># l&#39;axe des x est l&#39;epiweek (en tant que classe Date)</span></span>
<span id="cb1605-6"><a href="epicurves.html#cb1605-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> n_cases_weekly, <span class="co"># l&#39;axe des y est la hauteur du nombre de cas hebdomadaires</span></span>
<span id="cb1605-7"><a href="epicurves.html#cb1605-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> hospital, <span class="co"># nous regroupons les barres et les couleurs par hôpital</span></span>
<span id="cb1605-8"><a href="epicurves.html#cb1605-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> hospital),</span>
<span id="cb1605-9"><a href="epicurves.html#cb1605-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span> <span class="co"># ceci est également nécessaire lorsque l&#39;on trace des données de comptage</span></span>
<span id="cb1605-10"><a href="epicurves.html#cb1605-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1605-11"><a href="epicurves.html#cb1605-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes pour l&#39;axe des x</span></span>
<span id="cb1605-12"><a href="epicurves.html#cb1605-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1605-13"><a href="epicurves.html#cb1605-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;2 months&quot;</span>, <span class="co"># étiquettes tous les 2 mois </span></span>
<span id="cb1605-14"><a href="epicurves.html#cb1605-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;1 month&quot;</span>, <span class="co"># grilles tous les mois</span></span>
<span id="cb1605-15"><a href="epicurves.html#cb1605-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&#39;%b</span><span class="sc">\n</span><span class="st">%Y&#39;</span>)<span class="sc">+</span> <span class="co"># étiqueté par mois avec l&#39;année en dessous</span></span>
<span id="cb1605-16"><a href="epicurves.html#cb1605-16" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1605-17"><a href="epicurves.html#cb1605-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Choisissez la palette de couleurs (utilise le paquet RColorBrewer)</span></span>
<span id="cb1605-18"><a href="epicurves.html#cb1605-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Pastel2&quot;</span>)<span class="sc">+</span> </span>
<span id="cb1605-19"><a href="epicurves.html#cb1605-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1605-20"><a href="epicurves.html#cb1605-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb1605-21"><a href="epicurves.html#cb1605-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1605-22"><a href="epicurves.html#cb1605-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1605-23"><a href="epicurves.html#cb1605-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition&quot;</span>, </span>
<span id="cb1605-24"><a href="epicurves.html#cb1605-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Incidence hebdomadaire des cas&quot;</span>,</span>
<span id="cb1605-25"><a href="epicurves.html#cb1605-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Hospital&quot;</span>,</span>
<span id="cb1605-26"><a href="epicurves.html#cb1605-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas, à partir des données de comptage agrégées par hôpital&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1194-1.png" width="672" /></p>
</div>
</div>
<div id="moyennes-mobiles" class="section level3 unnumbered">
<h3>Moyennes mobiles</h3>
<p>Voir la page sur les <a href="moving_average.html#moving_average">Moyennes mobiles</a> pour une description détaillée et plusieurs options. Vous trouverez ci-dessous une option pour calculer des moyennes mobiles avec le package <strong>slider</strong>. Dans cette approche, <em>la moyenne mobile est calculée dans l’ensemble de données avant le tracé</em> :</p>
<ol style="list-style-type: decimal">
<li>Regroupez les données en comptes si nécessaire (quotidien, hebdomadaire, etc.) (voir la page sur <a href="grouping_data.html#grouping_data">groupage des données</a>).<br />
</li>
<li>créez une nouvelle colonne pour contenir la moyenne mobile, créée avec <code>slide_index()</code> du paquet <strong>slider</strong>.<br />
</li>
<li>Tracez la moyenne mobile comme une <code>geom_line()</code> au-dessus (aprés) l’histogramme épicurvien</li>
</ol>
<p>Voir l’utile <a href="https://cran.r-project.org/web/packages/slider/vignettes/slider.html">vignette pour le paquet <strong>slider</strong></a></p>
<div class="sourceCode" id="cb1606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1606-1"><a href="epicurves.html#cb1606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># charger le paquet</span></span>
<span id="cb1606-2"><a href="epicurves.html#cb1606-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(slider) <span class="co"># slider utilisé pour calculer les moyennes mobiles</span></span>
<span id="cb1606-3"><a href="epicurves.html#cb1606-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1606-4"><a href="epicurves.html#cb1606-4" aria-hidden="true" tabindex="-1"></a><span class="co"># créer un jeu de données de comptages quotidiens et de moyennes mobiles sur 7 jours</span></span>
<span id="cb1606-5"><a href="epicurves.html#cb1606-5" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb1606-6"><a href="epicurves.html#cb1606-6" aria-hidden="true" tabindex="-1"></a>ll_counts_7day <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> <span class="co"># commencer avec linelist</span></span>
<span id="cb1606-7"><a href="epicurves.html#cb1606-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1606-8"><a href="epicurves.html#cb1606-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## compter les cas par date</span></span>
<span id="cb1606-9"><a href="epicurves.html#cb1606-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date_onset, <span class="at">name =</span> <span class="st">&quot;new_cases&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># nommer une nouvelle colonne avec les comptages comme &quot;new_cases&quot;.</span></span>
<span id="cb1606-10"><a href="epicurves.html#cb1606-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(date_onset) <span class="sc">%&gt;%</span> <span class="co"># supprime les cas dont la date_onset est manquante</span></span>
<span id="cb1606-11"><a href="epicurves.html#cb1606-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1606-12"><a href="epicurves.html#cb1606-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## calculer le nombre moyen de cas dans la fenétre de 7 jours</span></span>
<span id="cb1606-13"><a href="epicurves.html#cb1606-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1606-14"><a href="epicurves.html#cb1606-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_7day =</span> slider<span class="sc">::</span><span class="fu">slide_index</span>( <span class="co"># créer une nouvelle colonne</span></span>
<span id="cb1606-15"><a href="epicurves.html#cb1606-15" aria-hidden="true" tabindex="-1"></a>      new_cases, <span class="co"># calcul basé sur la valeur de la colonne new_cases</span></span>
<span id="cb1606-16"><a href="epicurves.html#cb1606-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">.i =</span> date_onset, <span class="co"># l&#39;index est la colonne date_onset, donc les dates non présentes sont incluses dans la fenétre </span></span>
<span id="cb1606-17"><a href="epicurves.html#cb1606-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># La fonction est mean() avec les valeurs manquantes supprimées.</span></span>
<span id="cb1606-18"><a href="epicurves.html#cb1606-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="dv">6</span>, <span class="co"># la fenétre est le jour et les 6 jours précédents</span></span>
<span id="cb1606-19"><a href="epicurves.html#cb1606-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">.complete =</span> <span class="cn">FALSE</span>), <span class="co"># doit étre FALSE pour que unlist() fonctionne à l&#39;étape suivante</span></span>
<span id="cb1606-20"><a href="epicurves.html#cb1606-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_7day =</span> <span class="fu">unlist</span>(avg_7day)) <span class="co"># convertit la liste des classes en classes numériques</span></span>
<span id="cb1606-21"><a href="epicurves.html#cb1606-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1606-22"><a href="epicurves.html#cb1606-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1606-23"><a href="epicurves.html#cb1606-23" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer</span></span>
<span id="cb1606-24"><a href="epicurves.html#cb1606-24" aria-hidden="true" tabindex="-1"></a><span class="do">######</span></span>
<span id="cb1606-25"><a href="epicurves.html#cb1606-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ll_counts_7day) <span class="sc">+</span> <span class="co"># commencer avec le nouvel ensemble de données défini ci-dessus </span></span>
<span id="cb1606-26"><a href="epicurves.html#cb1606-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>( <span class="co"># crée un histogramme épicurve</span></span>
<span id="cb1606-27"><a href="epicurves.html#cb1606-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1606-28"><a href="epicurves.html#cb1606-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> date_onset, <span class="co"># colonne de date comme axe des x</span></span>
<span id="cb1606-29"><a href="epicurves.html#cb1606-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> new_cases), <span class="co"># la hauteur est le nombre de nouveaux cas quotidiens</span></span>
<span id="cb1606-30"><a href="epicurves.html#cb1606-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="co"># la hauteur est la valeur y</span></span>
<span id="cb1606-31"><a href="epicurves.html#cb1606-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill=</span><span class="st">&quot;#92a8d1&quot;</span>, <span class="co"># couleur froide pour les barres</span></span>
<span id="cb1606-32"><a href="epicurves.html#cb1606-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">&quot;#92a8d1&quot;</span>, <span class="co"># même couleur pour la bordure des barres</span></span>
<span id="cb1606-33"><a href="epicurves.html#cb1606-33" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span> </span>
<span id="cb1606-34"><a href="epicurves.html#cb1606-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>( <span class="co"># créer une ligne pour la moyenne mobile</span></span>
<span id="cb1606-35"><a href="epicurves.html#cb1606-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1606-36"><a href="epicurves.html#cb1606-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> date_onset, <span class="co"># colonne de date pour l&#39;axe des x</span></span>
<span id="cb1606-37"><a href="epicurves.html#cb1606-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> avg_7day, <span class="co"># valeur y définie dans la colonne de la moyenne mobile</span></span>
<span id="cb1606-38"><a href="epicurves.html#cb1606-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="st">&quot;7-day </span><span class="sc">\n</span><span class="st">rolling avg&quot;</span>), <span class="co"># nom de la ligne dans la légende</span></span>
<span id="cb1606-39"><a href="epicurves.html#cb1606-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="co"># couleur de la ligne</span></span>
<span id="cb1606-40"><a href="epicurves.html#cb1606-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># largeur de la ligne</span></span>
<span id="cb1606-41"><a href="epicurves.html#cb1606-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>( <span class="co"># échelle de date</span></span>
<span id="cb1606-42"><a href="epicurves.html#cb1606-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">date_breaks =</span> <span class="st">&quot;1 month&quot;</span>,</span>
<span id="cb1606-43"><a href="epicurves.html#cb1606-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">date_labels =</span> <span class="st">&#39;%d/%m&#39;</span>,</span>
<span id="cb1606-44"><a href="epicurves.html#cb1606-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1606-45"><a href="epicurves.html#cb1606-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>( <span class="co"># échelle de l&#39;axe des y</span></span>
<span id="cb1606-46"><a href="epicurves.html#cb1606-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1606-47"><a href="epicurves.html#cb1606-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span>       </span>
<span id="cb1606-48"><a href="epicurves.html#cb1606-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb1606-49"><a href="epicurves.html#cb1606-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb1606-50"><a href="epicurves.html#cb1606-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;Nombre de cas confirmés&quot;</span>,</span>
<span id="cb1606-51"><a href="epicurves.html#cb1606-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;Legende&quot;</span>)<span class="sc">+</span> </span>
<span id="cb1606-52"><a href="epicurves.html#cb1606-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb1606-53"><a href="epicurves.html#cb1606-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># supprime le titre de la légende</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1195-1.png" width="672" /></p>
</div>
<div id="facettespetits-multiples-1" class="section level3 unnumbered">
<h3>Facettes/petits-multiples</h3>
<p>Comme pour les autres ggplots, vous pouvez créer des graphiques à facettes (“petits multiples”). Comme expliqué dans la page <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a> de ce manuel, vous pouvez utiliser soit <code>facet_wrap()</code> soit <code>facet_grid()</code>. Ici, nous faisons une démonstration avec <code>facet_wrap()</code>. Pour les épicurves, <code>facet_wrap()</code> est typiquement plus facile car il est probable que vous n’ayez besoin de faire une facette que sur une seule colonne.</p>
<p>La syntaxe générale est <code>facet_wrap(rows ~ cols)</code>, où à gauche du tilde (~) est le nom d’une colonne à répartir sur les “rows” du graphique à facettes, et à droite du tilde est le nom d’une colonne à répartir sur les “columns” du graphique à facettes. Plus simplement, il suffit d’utiliser un seul nom de colonne, à droite du tilde : <code>facet_wrap(~age_cat)</code>.</p>
<p><strong>Axes libres</strong><br />
Vous devrez décider si les échelles des axes pour chaque facette sont “fixées” aux mêmes dimensions (par défaut), ou “libres” (ce qui signifie qu’elles changeront en fonction des données de la facette). Faites-le avec l’argument <code>scales =</code> dans <code>facet_wrap()</code> en spécifiant “free_x” ou “free_y”, ou “free”.</p>
<p><strong>Nombre de cols et de rangs de facettes</strong><br />
Cela peut étre spécifié avec <code>ncol =</code> et <code>nrow =</code> dans <code>facet_wrap()</code>.</p>
<p><strong>Ordre des facettes</strong><br />
Pour changer l’ordre d’apparition, changez l’ordre sous-jacent des niveaux de la colonne de facteurs utilisée pour créer les facettes.</p>
<p><strong>esthétique</strong><br />
La taille et le visage de la police, la couleur de la bande, etc. peuvent étre modifiés par <code>theme()</code> avec des arguments comme :</p>
<ul>
<li><code>strip.text = element_text()</code> (taille, couleur, face, angle…)</li>
<li><code>strip.background = element_rect()</code> (par exemple element_rect(fill=“grey”))<br />
</li>
<li><code>strip.position =</code> (position de la bande “bas”, “haut”, “gauche” ou “droite”)</li>
</ul>
<p><strong>Libellés des bandes</strong><br />
Les étiquettes des graphiques à facettes peuvent étre modifiées par les “étiquettes” de la colonne comme facteur, ou par l’utilisation d’un “labeller”.</p>
<p>Faites une étiquette comme celle-ci, en utilisant la fonction <code>as_labeller()</code> de <strong>ggplot2</strong>. Puis fournissez l’étiqueteuse à l’argument <code>labeller =</code> de <code>facet_wrap()</code> comme indiqué ci-dessous.</p>
<div class="sourceCode" id="cb1607"><pre class="sourceCode r fold-show"><code class="sourceCode r"><span id="cb1607-1"><a href="epicurves.html#cb1607-1" aria-hidden="true" tabindex="-1"></a>my_labels <span class="ot">&lt;-</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(</span>
<span id="cb1607-2"><a href="epicurves.html#cb1607-2" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;0-4&quot;</span> <span class="ot">=</span> <span class="st">&quot;0-4 ans&quot;</span>,</span>
<span id="cb1607-3"><a href="epicurves.html#cb1607-3" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;5-9&quot;</span> <span class="ot">=</span> <span class="st">&quot;5-9 ans&quot;</span>,</span>
<span id="cb1607-4"><a href="epicurves.html#cb1607-4" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;10-14&quot;</span> <span class="ot">=</span> <span class="st">&quot;10-14 ans&quot;</span>,</span>
<span id="cb1607-5"><a href="epicurves.html#cb1607-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;15-19&quot;</span> <span class="ot">=</span> <span class="st">&quot;15-19 ans&quot;</span>,</span>
<span id="cb1607-6"><a href="epicurves.html#cb1607-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;20-29&quot;</span> <span class="ot">=</span> <span class="st">&quot;20-29 ans&quot;</span>,</span>
<span id="cb1607-7"><a href="epicurves.html#cb1607-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;30-49&quot;</span> <span class="ot">=</span> <span class="st">&quot;30-49 ans&quot;</span>,</span>
<span id="cb1607-8"><a href="epicurves.html#cb1607-8" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;50-69&quot;</span> <span class="ot">=</span> <span class="st">&quot;50-69 ans&quot;</span>,</span>
<span id="cb1607-9"><a href="epicurves.html#cb1607-9" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;70+&quot;</span> <span class="ot">=</span> <span class="st">&quot;Plus de 70 ans&quot;</span>))</span></code></pre></div>
<p><strong>Un exemple de graphique à facettes</strong> - facetté par la colonne <code>age_cat</code>.</p>
<div class="sourceCode" id="cb1608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1608-1"><a href="epicurves.html#cb1608-1" aria-hidden="true" tabindex="-1"></a><span class="co"># faire le graphe</span></span>
<span id="cb1608-2"><a href="epicurves.html#cb1608-2" aria-hidden="true" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb1608-3"><a href="epicurves.html#cb1608-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span> </span>
<span id="cb1608-4"><a href="epicurves.html#cb1608-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1608-5"><a href="epicurves.html#cb1608-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1608-6"><a href="epicurves.html#cb1608-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1608-7"><a href="epicurves.html#cb1608-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> date_onset,</span>
<span id="cb1608-8"><a href="epicurves.html#cb1608-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> age_cat,</span>
<span id="cb1608-9"><a href="epicurves.html#cb1608-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> age_cat), <span class="co"># les arguments à l&#39;intérieur de aes() s&#39;appliquent par groupe</span></span>
<span id="cb1608-10"><a href="epicurves.html#cb1608-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1608-11"><a href="epicurves.html#cb1608-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># les arguments hors aes() s&#39;appliquent à toutes les données</span></span>
<span id="cb1608-12"><a href="epicurves.html#cb1608-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1608-13"><a href="epicurves.html#cb1608-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ruptures d&#39;histogramme</span></span>
<span id="cb1608-14"><a href="epicurves.html#cb1608-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central)<span class="sc">+</span> <span class="co"># vecteur de date prédéfini (voir plus haut dans cette page)</span></span>
<span id="cb1608-15"><a href="epicurves.html#cb1608-15" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb1608-16"><a href="epicurves.html#cb1608-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Les étiquettes sur l&#39;axe des x</span></span>
<span id="cb1608-17"><a href="epicurves.html#cb1608-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1608-18"><a href="epicurves.html#cb1608-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprimez l&#39;espace excédentaire sur l&#39;axe des x en dessous et aprés les barres de cas</span></span>
<span id="cb1608-19"><a href="epicurves.html#cb1608-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;2 months&quot;</span>, <span class="co"># les étiquettes apparaissent tous les 2 mois</span></span>
<span id="cb1608-20"><a href="epicurves.html#cb1608-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;1 month&quot;</span>, <span class="co"># les lignes verticales apparaissent tous les 1 mois </span></span>
<span id="cb1608-21"><a href="epicurves.html#cb1608-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes de date</span></span>
<span id="cb1608-22"><a href="epicurves.html#cb1608-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1608-23"><a href="epicurves.html#cb1608-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axe des y</span></span>
<span id="cb1608-24"><a href="epicurves.html#cb1608-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># supprime l&#39;espace excédentaire sur l&#39;axe des y entre le bas des barres et les étiquettes</span></span>
<span id="cb1608-25"><a href="epicurves.html#cb1608-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1608-26"><a href="epicurves.html#cb1608-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thèmes esthétiques</span></span>
<span id="cb1608-27"><a href="epicurves.html#cb1608-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># un ensemble de thèmes pour simplifier le graphique</span></span>
<span id="cb1608-28"><a href="epicurves.html#cb1608-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1608-29"><a href="epicurves.html#cb1608-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>), <span class="co"># légende à gauche en italique</span></span>
<span id="cb1608-30"><a href="epicurves.html#cb1608-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb1608-31"><a href="epicurves.html#cb1608-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb1608-32"><a href="epicurves.html#cb1608-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb1608-33"><a href="epicurves.html#cb1608-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>))<span class="sc">+</span> <span class="co"># titres des axes en gras</span></span>
<span id="cb1608-34"><a href="epicurves.html#cb1608-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1608-35"><a href="epicurves.html#cb1608-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># créer des facettes</span></span>
<span id="cb1608-36"><a href="epicurves.html#cb1608-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb1608-37"><a href="epicurves.html#cb1608-37" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>age_cat,</span>
<span id="cb1608-38"><a href="epicurves.html#cb1608-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb1608-39"><a href="epicurves.html#cb1608-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb1608-40"><a href="epicurves.html#cb1608-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> my_labels)<span class="sc">+</span>             </span>
<span id="cb1608-41"><a href="epicurves.html#cb1608-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1608-42"><a href="epicurves.html#cb1608-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes</span></span>
<span id="cb1608-43"><a href="epicurves.html#cb1608-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1608-44"><a href="epicurves.html#cb1608-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas, par catégorie d&#39;âge&quot;</span>,</span>
<span id="cb1608-45"><a href="epicurves.html#cb1608-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Sous-titre&quot;</span>,</span>
<span id="cb1608-46"><a href="epicurves.html#cb1608-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Catégorie d&#39;âge&quot;</span>, <span class="co"># fournir un nouveau titre pour la légende</span></span>
<span id="cb1608-47"><a href="epicurves.html#cb1608-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1608-48"><a href="epicurves.html#cb1608-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cas incidents hebdomadaires signalés&quot;</span>,</span>
<span id="cb1608-49"><a href="epicurves.html#cb1608-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">&quot;n = {nrow(central_data)} from Central Hospital ; Case onsets range from {format(min(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)} à {format(max(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)}{nrow(central_data %&gt;% filter(is.na(date_onset)))} cas dont la date d&#39;apparition est manquante et qui ne sont pas indiqués&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1197-1.png" width="672" /></p>
<p>Voir ce <a href="https://ggplot2.tidyverse.org/reference/labellers.html">lien</a> pour plus d’informations sur les étiqueteuses.</p>
<div id="épidémie-totale-dans-larriére-plan-de-la-facette" class="section level4 nonnumbered" number="33.3.1.1">
<h4><span class="header-section-number">33.3.1.1</span> Épidémie totale dans l’arriére-plan de la facette</h4>
<p>Pour afficher l’épidémie totale en arriére-plan de chaque facette, ajoutez la fonction <code>gghighlight()</code> avec des parenthôses vides au ggplot. Cette fonction provient du paquet <strong>gghighlight</strong>. Notez que le maximum de l’axe des y dans toutes les facettes est maintenant basé sur le pic de l’épidémie entiére. Il y a plus d’exemples de ce package dans la page <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a>.</p>
<div class="sourceCode" id="cb1609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1609-1"><a href="epicurves.html#cb1609-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span> </span>
<span id="cb1609-2"><a href="epicurves.html#cb1609-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-3"><a href="epicurves.html#cb1609-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Epicurves par groupe</span></span>
<span id="cb1609-4"><a href="epicurves.html#cb1609-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1609-5"><a href="epicurves.html#cb1609-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1609-6"><a href="epicurves.html#cb1609-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> date_onset,</span>
<span id="cb1609-7"><a href="epicurves.html#cb1609-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> age_cat,</span>
<span id="cb1609-8"><a href="epicurves.html#cb1609-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> age_cat), <span class="co"># les arguments à l&#39;intérieur de aes() s&#39;appliquent par groupe</span></span>
<span id="cb1609-9"><a href="epicurves.html#cb1609-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1609-10"><a href="epicurves.html#cb1609-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># les arguments hors aes() s&#39;appliquent à toutes les données</span></span>
<span id="cb1609-11"><a href="epicurves.html#cb1609-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1609-12"><a href="epicurves.html#cb1609-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ruptures d&#39;histogramme</span></span>
<span id="cb1609-13"><a href="epicurves.html#cb1609-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central)<span class="sc">+</span> <span class="co"># vecteur de dates prédéfini (voir en haut de la section ggplot)                </span></span>
<span id="cb1609-14"><a href="epicurves.html#cb1609-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-15"><a href="epicurves.html#cb1609-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajoute une épidémie grise en arriére-plan à chaque facette</span></span>
<span id="cb1609-16"><a href="epicurves.html#cb1609-16" aria-hidden="true" tabindex="-1"></a>  gghighlight<span class="sc">::</span><span class="fu">gghighlight</span>()<span class="sc">+</span></span>
<span id="cb1609-17"><a href="epicurves.html#cb1609-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-18"><a href="epicurves.html#cb1609-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes sur l&#39;axe des x</span></span>
<span id="cb1609-19"><a href="epicurves.html#cb1609-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1609-20"><a href="epicurves.html#cb1609-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># Suppression de l&#39;espace excédentaire sur l&#39;axe des x sous et aprés les barres de cas</span></span>
<span id="cb1609-21"><a href="epicurves.html#cb1609-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;2 months&quot;</span>, <span class="co"># les étiquettes apparaissent tous les 2 mois</span></span>
<span id="cb1609-22"><a href="epicurves.html#cb1609-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;1 month&quot;</span>, <span class="co"># les lignes verticales apparaissent tous les 1 mois </span></span>
<span id="cb1609-23"><a href="epicurves.html#cb1609-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes de date</span></span>
<span id="cb1609-24"><a href="epicurves.html#cb1609-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-25"><a href="epicurves.html#cb1609-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axe des y</span></span>
<span id="cb1609-26"><a href="epicurves.html#cb1609-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># supprime l&#39;espace excédentaire de l&#39;axe des y en dessous de 0</span></span>
<span id="cb1609-27"><a href="epicurves.html#cb1609-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-28"><a href="epicurves.html#cb1609-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thèmes esthétiques</span></span>
<span id="cb1609-29"><a href="epicurves.html#cb1609-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># un ensemble de thèmes pour simplifier le graphique</span></span>
<span id="cb1609-30"><a href="epicurves.html#cb1609-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1609-31"><a href="epicurves.html#cb1609-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>), <span class="co"># légende à gauche en italique</span></span>
<span id="cb1609-32"><a href="epicurves.html#cb1609-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb1609-33"><a href="epicurves.html#cb1609-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb1609-34"><a href="epicurves.html#cb1609-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb1609-35"><a href="epicurves.html#cb1609-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="sc">+</span> <span class="co"># titres des axes en gras</span></span>
<span id="cb1609-36"><a href="epicurves.html#cb1609-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-37"><a href="epicurves.html#cb1609-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># créer des facettes</span></span>
<span id="cb1609-38"><a href="epicurves.html#cb1609-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb1609-39"><a href="epicurves.html#cb1609-39" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>age_cat, <span class="co"># chaque facette est une valeur de age_cat</span></span>
<span id="cb1609-40"><a href="epicurves.html#cb1609-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">4</span>, <span class="co"># nombre de colonnes</span></span>
<span id="cb1609-41"><a href="epicurves.html#cb1609-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="co"># position du titre/strip de la facette</span></span>
<span id="cb1609-42"><a href="epicurves.html#cb1609-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> my_labels)<span class="sc">+</span> <span class="co"># labeller définit ci-dessus</span></span>
<span id="cb1609-43"><a href="epicurves.html#cb1609-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1609-44"><a href="epicurves.html#cb1609-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes</span></span>
<span id="cb1609-45"><a href="epicurves.html#cb1609-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1609-46"><a href="epicurves.html#cb1609-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas, par catégorie d&#39;âge&quot;</span>,</span>
<span id="cb1609-47"><a href="epicurves.html#cb1609-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Sous-titre&quot;</span>,</span>
<span id="cb1609-48"><a href="epicurves.html#cb1609-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Catégorie d&#39;âge&quot;</span>, <span class="co"># fournit un nouveau titre pour la légende</span></span>
<span id="cb1609-49"><a href="epicurves.html#cb1609-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1609-50"><a href="epicurves.html#cb1609-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cas incidents hebdomadaires signalés&quot;</span>,</span>
<span id="cb1609-51"><a href="epicurves.html#cb1609-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">&quot;n = {nrow(central_data)} from Central Hospital ; Case onsets range from {format(min(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)} à {format(max(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)}{nrow(central_data %&gt;% filter(is.na(date_onset)))} cas dont la date d&#39;apparition est manquante et qui ne sont pas indiqués&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1198-1.png" width="672" /></p>
</div>
<div id="une-facette-avec-des-données" class="section level4 unnumbered">
<h4>Une facette avec des données</h4>
<p>Si vous voulez avoir une seule boîte à facettes qui contient toutes les données, dupliquez l’ensemble des données et traitez les doublons comme une seule valeur de facette. La fonction “helper” <code>CreateAllFacet()</code> ci-dessous peut vous aider (gràce à cet <a href="https://stackoverflow.com/questions/18933575/easily-add-an-all-facet-to-facet-wrap-in-ggplot2">article de blog</a>). Quand elle est exécutée, le nombre de lignes double et il y aura une nouvelle colonne appelée <code>facet</code> dans laquelle les lignes dupliquées auront la valeur “all”, et les lignes originales auront la valeur originale de la colonne de facettes. Il ne vous reste plus qu’à effectuer la facette sur la colonne <code>facet</code>.</p>
<p>Voici la fonction d’aide. Exécutez-la pour qu’elle soit disponible pour vous.</p>
<div class="sourceCode" id="cb1610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1610-1"><a href="epicurves.html#cb1610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># définir la fonction d&#39;aide</span></span>
<span id="cb1610-2"><a href="epicurves.html#cb1610-2" aria-hidden="true" tabindex="-1"></a>CreateAllFacet <span class="ot">&lt;-</span> <span class="cf">function</span>(df, col){</span>
<span id="cb1610-3"><a href="epicurves.html#cb1610-3" aria-hidden="true" tabindex="-1"></a>     df<span class="sc">$</span>facet <span class="ot">&lt;-</span> df[[col]]</span>
<span id="cb1610-4"><a href="epicurves.html#cb1610-4" aria-hidden="true" tabindex="-1"></a>     temp <span class="ot">&lt;-</span> df</span>
<span id="cb1610-5"><a href="epicurves.html#cb1610-5" aria-hidden="true" tabindex="-1"></a>     temp<span class="sc">$</span>facet <span class="ot">&lt;-</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb1610-6"><a href="epicurves.html#cb1610-6" aria-hidden="true" tabindex="-1"></a>     merged <span class="ot">&lt;-</span><span class="fu">rbind</span>(temp, df)</span>
<span id="cb1610-7"><a href="epicurves.html#cb1610-7" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1610-8"><a href="epicurves.html#cb1610-8" aria-hidden="true" tabindex="-1"></a>     <span class="co"># s&#39;assurer que la valeur de la facette est un facteur</span></span>
<span id="cb1610-9"><a href="epicurves.html#cb1610-9" aria-hidden="true" tabindex="-1"></a>     merged[[col]] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(merged[[col]])</span>
<span id="cb1610-10"><a href="epicurves.html#cb1610-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1610-11"><a href="epicurves.html#cb1610-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(merged)</span>
<span id="cb1610-12"><a href="epicurves.html#cb1610-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Appliquez maintenant la fonction d’aide à l’ensemble de données, sur la colonne <code>age_cat</code> :</p>
<div class="sourceCode" id="cb1611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1611-1"><a href="epicurves.html#cb1611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un jeu de données dupliqué et avec une nouvelle colonne &quot;facet&quot; pour afficher &quot;toutes&quot; les catégories d&#39;âge comme autre niveau de facette.</span></span>
<span id="cb1611-2"><a href="epicurves.html#cb1611-2" aria-hidden="true" tabindex="-1"></a>central_data2 <span class="ot">&lt;-</span> <span class="fu">CreateAllFacet</span>(central_data, <span class="at">col =</span> <span class="st">&quot;age_cat&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1611-3"><a href="epicurves.html#cb1611-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1611-4"><a href="epicurves.html#cb1611-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># définir les niveaux de facteurs</span></span>
<span id="cb1611-5"><a href="epicurves.html#cb1611-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">facet =</span> <span class="fu">fct_relevel</span>(facet, <span class="st">&quot;all&quot;</span>, <span class="st">&quot;0-4&quot;</span>, <span class="st">&quot;5-9&quot;</span>,</span>
<span id="cb1611-6"><a href="epicurves.html#cb1611-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;10-14&quot;</span>, <span class="st">&quot;15-19&quot;</span>, <span class="st">&quot;20-29&quot;</span>,</span>
<span id="cb1611-7"><a href="epicurves.html#cb1611-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;30-49&quot;</span>, <span class="st">&quot;50-69&quot;</span>, <span class="st">&quot;70+&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `facet = fct_relevel(...)`.
## Caused by warning:
## ! 1 unknown level in `f`: 70+</code></pre>
<div class="sourceCode" id="cb1613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1613-1"><a href="epicurves.html#cb1613-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vérifier les niveaux</span></span>
<span id="cb1613-2"><a href="epicurves.html#cb1613-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(central_data2<span class="sc">$</span>facet, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   all   0-4   5-9 10-14 15-19 20-29 30-49 50-69  &lt;NA&gt; 
##   454    84    84    82    58    73    57     7     9</code></pre>
<p>Les changements notables de la commande <code>ggplot()</code> sont les suivants :</p>
<ul>
<li>Les données utilisées sont maintenant central_data2 (deux fois plus de lignes, avec une nouvelle colonne “facet”).</li>
<li>L’étiqueteuse devra étre mise à jour, si elle est utilisée.<br />
</li>
<li>Optionnel : pour obtenir des facettes empilées verticalement : la colonne facette est déplacée vers les lignes de l’équation et remplacée à droite par “.” (<code>facet_wrap(facet~.)</code>), et <code>ncol = 1</code>. Vous pouvez aussi avoir besoin d’ajuster la largeur et la hauteur de l’image du graphique en png (voir <code>ggsave()</code> dans <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a>).</li>
</ul>
<div class="sourceCode" id="cb1615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1615-1"><a href="epicurves.html#cb1615-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data2) <span class="sc">+</span> </span>
<span id="cb1615-2"><a href="epicurves.html#cb1615-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1615-3"><a href="epicurves.html#cb1615-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Epicurves réelles par groupe</span></span>
<span id="cb1615-4"><a href="epicurves.html#cb1615-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1615-5"><a href="epicurves.html#cb1615-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb1615-6"><a href="epicurves.html#cb1615-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> date_onset,</span>
<span id="cb1615-7"><a href="epicurves.html#cb1615-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">group =</span> age_cat,</span>
<span id="cb1615-8"><a href="epicurves.html#cb1615-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> age_cat), <span class="co"># les arguments à l&#39;intérieur de aes() s&#39;appliquent par groupe</span></span>
<span id="cb1615-9"><a href="epicurves.html#cb1615-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># les arguments hors aes() s&#39;appliquent à toutes les données</span></span>
<span id="cb1615-10"><a href="epicurves.html#cb1615-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1615-11"><a href="epicurves.html#cb1615-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ruptures d&#39;histogramme</span></span>
<span id="cb1615-12"><a href="epicurves.html#cb1615-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> weekly_breaks_central)<span class="sc">+</span> <span class="co"># vecteur de dates prédéfini (voir en haut de la section ggplot)</span></span>
<span id="cb1615-13"><a href="epicurves.html#cb1615-13" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb1615-14"><a href="epicurves.html#cb1615-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes sur l&#39;axe des x</span></span>
<span id="cb1615-15"><a href="epicurves.html#cb1615-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1615-16"><a href="epicurves.html#cb1615-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># supprime l&#39;espace excédentaire de l&#39;axe des x sous et aprés les barres de cas</span></span>
<span id="cb1615-17"><a href="epicurves.html#cb1615-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;2 months&quot;</span>, <span class="co"># les étiquettes apparaissent tous les 2 mois</span></span>
<span id="cb1615-18"><a href="epicurves.html#cb1615-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;1 month&quot;</span>, <span class="co"># les lignes verticales apparaissent tous les 1 mois </span></span>
<span id="cb1615-19"><a href="epicurves.html#cb1615-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes de date</span></span>
<span id="cb1615-20"><a href="epicurves.html#cb1615-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1615-21"><a href="epicurves.html#cb1615-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axe des y</span></span>
<span id="cb1615-22"><a href="epicurves.html#cb1615-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># supprime l&#39;espace excédentaire sur l&#39;axe des y entre le bas des barres et les étiquettes</span></span>
<span id="cb1615-23"><a href="epicurves.html#cb1615-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1615-24"><a href="epicurves.html#cb1615-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thèmes esthétiques</span></span>
<span id="cb1615-25"><a href="epicurves.html#cb1615-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># un ensemble de thèmes pour simplifier le graphique</span></span>
<span id="cb1615-26"><a href="epicurves.html#cb1615-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1615-27"><a href="epicurves.html#cb1615-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>), <span class="co"># légende à gauche en italique</span></span>
<span id="cb1615-28"><a href="epicurves.html#cb1615-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb1615-29"><a href="epicurves.html#cb1615-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span>               </span>
<span id="cb1615-30"><a href="epicurves.html#cb1615-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1615-31"><a href="epicurves.html#cb1615-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># créer des facettes</span></span>
<span id="cb1615-32"><a href="epicurves.html#cb1615-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(facet<span class="sc">~</span>. , <span class="co"># chaque parcelle est une valeur de la facette</span></span>
<span id="cb1615-33"><a href="epicurves.html#cb1615-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">1</span>)<span class="sc">+</span>            </span>
<span id="cb1615-34"><a href="epicurves.html#cb1615-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1615-35"><a href="epicurves.html#cb1615-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes</span></span>
<span id="cb1615-36"><a href="epicurves.html#cb1615-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Incidence hebdomadaire des cas, par catégorie d&#39;âge&quot;</span>,</span>
<span id="cb1615-37"><a href="epicurves.html#cb1615-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Sous-titre&quot;</span>,</span>
<span id="cb1615-38"><a href="epicurves.html#cb1615-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Catégorie d&#39;âge&quot;</span>, <span class="co"># fournit un nouveau titre pour la légende</span></span>
<span id="cb1615-39"><a href="epicurves.html#cb1615-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1615-40"><a href="epicurves.html#cb1615-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Cas incidents hebdomadaires signalés&quot;</span>,</span>
<span id="cb1615-41"><a href="epicurves.html#cb1615-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">&quot;n = {nrow(central_data)} from Central Hospital ; Case onsets range from</span></span>
<span id="cb1615-42"><a href="epicurves.html#cb1615-42" aria-hidden="true" tabindex="-1"></a><span class="st">                                   {format(min(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)} à</span></span>
<span id="cb1615-43"><a href="epicurves.html#cb1615-43" aria-hidden="true" tabindex="-1"></a><span class="st">                                   {format(max(central_data$date_onset, na.rm=T), format = &#39;%a %d %b %Y&#39;)}</span><span class="sc">\n</span><span class="st">{nrow(central_data %&gt;% filter(is.na(date_onset)))} cas dont la date d&#39;apparition est manquante et qui ne sont pas indiqués&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1201-1.png" width="480" /></p>
</div>
</div>
</div>
<div id="données-provisoires" class="section level2" number="33.4">
<h2><span class="header-section-number">33.4</span> Données provisoires</h2>
<p>Les données les plus récentes présentées dans les épicurves doivent souvent étre marquées comme provisoires, ou sujettes à des retards de déclaration. Ceci peut étre fait en ajoutant une ligne verticale et/ou un rectangle sur un nombre de jours spécifié. Voici deux options :</p>
<ol style="list-style-type: decimal">
<li>Utilisez <code>annotate()</code> :
<ul>
<li>Pour une ligne, utilisez <code>annotate(geom = "segment")</code>. Fournissez <code>x</code>, <code>xend</code>, <code>y</code>, et <code>yend</code>. Ajustez la taille, le type de ligne (<code>lty</code>) et la couleur.<br />
</li>
<li>Pour un rectangle, utilisez <code>annotate(geom = "rect")</code>. Fournissez xmin/xmax/ymin/ymax. Ajustez la couleur et l’alpha.<br />
</li>
</ul></li>
<li>Regroupez les données par statut provisoire et colorez ces barres différemment.</li>
</ol>
<p><span style="color : orange ;"><strong><em>CAUTION:</em></strong> Vous pourriez essayer <code>geom_rect()</code> pour dessiner un rectangle, mais l’ajustement de la transparence ne fonctionne pas dans un contexte de linelist. Cette fonction superpose un rectangle pour chaque observation/rangée ! Utilisez soit un alpha trés faible (par exemple 0,01), soit une autre approche. </span></p>
<div id="utilisation-de-annotate" class="section level3 unnumbered">
<h3>Utilisation de <code>annotate()</code></h3>
<ul>
<li>Dans <code>annotate(geom = "rect")</code>, les arguments <code>xmin</code> et <code>xmax</code> doivent recevoir des entrées de la classe Date.<br />
</li>
<li>Notez que, comme ces données sont agrégées en barres hebdomadaires et que la derniére barre s’étend jusqu’au lundi suivant le dernier point de données, la région ombrée peut sembler couvrir 4 semaines.<br />
</li>
<li>Voici un <code>annotate()</code> <a href="https://ggplot2.tidyverse.org/reference/annotate.html">exemple en ligne</a></li>
</ul>
<div class="sourceCode" id="cb1616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1616-1"><a href="epicurves.html#cb1616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_data) <span class="sc">+</span> </span>
<span id="cb1616-2"><a href="epicurves.html#cb1616-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1616-3"><a href="epicurves.html#cb1616-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># histogramme</span></span>
<span id="cb1616-4"><a href="epicurves.html#cb1616-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1616-5"><a href="epicurves.html#cb1616-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1616-6"><a href="epicurves.html#cb1616-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1616-7"><a href="epicurves.html#cb1616-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central, <span class="co"># vecteur de date prédéfini - voir en haut de la section ggplot</span></span>
<span id="cb1616-8"><a href="epicurves.html#cb1616-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1616-9"><a href="epicurves.html#cb1616-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb1616-10"><a href="epicurves.html#cb1616-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1616-11"><a href="epicurves.html#cb1616-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">closed =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb1616-12"><a href="epicurves.html#cb1616-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1616-13"><a href="epicurves.html#cb1616-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1616-14"><a href="epicurves.html#cb1616-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1616-15"><a href="epicurves.html#cb1616-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># échelles</span></span>
<span id="cb1616-16"><a href="epicurves.html#cb1616-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb1616-17"><a href="epicurves.html#cb1616-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1616-18"><a href="epicurves.html#cb1616-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># Suppression de l&#39;espace excédentaire sur l&#39;axe des x sous et aprés les barres de cas</span></span>
<span id="cb1616-19"><a href="epicurves.html#cb1616-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;1 month&quot;</span>, <span class="co"># 1er du mois</span></span>
<span id="cb1616-20"><a href="epicurves.html#cb1616-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;1 month&quot;</span>, <span class="co"># 1er du mois</span></span>
<span id="cb1616-21"><a href="epicurves.html#cb1616-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1616-22"><a href="epicurves.html#cb1616-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1616-23"><a href="epicurves.html#cb1616-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes et theme</span></span>
<span id="cb1616-24"><a href="epicurves.html#cb1616-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1616-25"><a href="epicurves.html#cb1616-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Utilisant annotate()</span><span class="sc">\n</span><span class="st">Rectangle et ligne montrant que les données des 21 derniers jours sont provisoires&quot;</span>,</span>
<span id="cb1616-26"><a href="epicurves.html#cb1616-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semaine d&#39;apparition des symptômes&quot;</span>,</span>
<span id="cb1616-27"><a href="epicurves.html#cb1616-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Indication hebdomadaire des cas&quot;</span>)<span class="sc">+</span> </span>
<span id="cb1616-28"><a href="epicurves.html#cb1616-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb1616-29"><a href="epicurves.html#cb1616-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1616-30"><a href="epicurves.html#cb1616-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajoute un rectangle rouge semi-transparent aux données provisoires</span></span>
<span id="cb1616-31"><a href="epicurves.html#cb1616-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb1616-32"><a href="epicurves.html#cb1616-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rect&quot;</span>,</span>
<span id="cb1616-33"><a href="epicurves.html#cb1616-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">21</span>), <span class="co"># la note doit étre enveloppée dans as.Date()</span></span>
<span id="cb1616-34"><a href="epicurves.html#cb1616-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">as.Date</span>(<span class="cn">Inf</span>), <span class="co"># la note doit étre enveloppée dans as.Date()</span></span>
<span id="cb1616-35"><a href="epicurves.html#cb1616-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb1616-36"><a href="epicurves.html#cb1616-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb1616-37"><a href="epicurves.html#cb1616-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="co"># alpha facile et intuitif à ajuster en utilisant annotate()</span></span>
<span id="cb1616-38"><a href="epicurves.html#cb1616-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb1616-39"><a href="epicurves.html#cb1616-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1616-40"><a href="epicurves.html#cb1616-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajoute une ligne verticale noire au-dessus des autres couches</span></span>
<span id="cb1616-41"><a href="epicurves.html#cb1616-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb1616-42"><a href="epicurves.html#cb1616-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;segment&quot;</span>,</span>
<span id="cb1616-43"><a href="epicurves.html#cb1616-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">21</span>, <span class="co"># 21 jours avant les derniéres données</span></span>
<span id="cb1616-44"><a href="epicurves.html#cb1616-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">21</span>, </span>
<span id="cb1616-45"><a href="epicurves.html#cb1616-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">0</span>, <span class="co"># la ligne commence à y = 0</span></span>
<span id="cb1616-46"><a href="epicurves.html#cb1616-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="cn">Inf</span>, <span class="co"># ligne jusqu&#39;au sommet du graphique</span></span>
<span id="cb1616-47"><a href="epicurves.html#cb1616-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="co"># taille de la ligne</span></span>
<span id="cb1616-48"><a href="epicurves.html#cb1616-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb1616-49"><a href="epicurves.html#cb1616-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="st">&quot;solid&quot;</span>)<span class="sc">+</span> <span class="co"># type de ligne, par exemple &quot;solid&quot;, &quot;dashed&quot;.</span></span>
<span id="cb1616-50"><a href="epicurves.html#cb1616-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1616-51"><a href="epicurves.html#cb1616-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajouter du texte dans le rectangle</span></span>
<span id="cb1616-52"><a href="epicurves.html#cb1616-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb1616-53"><a href="epicurves.html#cb1616-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1616-54"><a href="epicurves.html#cb1616-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">15</span>,</span>
<span id="cb1616-55"><a href="epicurves.html#cb1616-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">15</span>,</span>
<span id="cb1616-56"><a href="epicurves.html#cb1616-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;Sujet à des délais de déclaration&quot;</span>,</span>
<span id="cb1616-57"><a href="epicurves.html#cb1616-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">90</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1202-1.png" width="672" /></p>
<p>La même ligne verticale noire peut étre obtenue avec le code ci-dessous, mais en utilisant <code>geom_vline()</code> vous perdez la possibilité de contrôler la hauteur :</p>
<div class="sourceCode" id="cb1617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1617-1"><a href="epicurves.html#cb1617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">max</span>(central_data<span class="sc">$</span>date_onset, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="dv">21</span>,</span>
<span id="cb1617-2"><a href="epicurves.html#cb1617-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1617-3"><a href="epicurves.html#cb1617-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
</div>
<div id="couleur-des-barres" class="section level3 unnumbered">
<h3>Couleur des barres</h3>
<p>Une autre approche pourrait consister à ajuster la couleur ou l’affichage des barres de données provisoires elles-mêmes. Vous pouvez créer une nouvelle colonne dans l’étape de préparation des données et l’utiliser pour regrouper les données, de sorte que les ” aes(fill = )`” des données provisoires puissent avoir une couleur ou un alpha différent des autres barres.</p>
<div class="sourceCode" id="cb1618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1618-1"><a href="epicurves.html#cb1618-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ajouter une colonne</span></span>
<span id="cb1618-2"><a href="epicurves.html#cb1618-2" aria-hidden="true" tabindex="-1"></a><span class="do">############</span></span>
<span id="cb1618-3"><a href="epicurves.html#cb1618-3" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> central_data <span class="sc">%&gt;%</span> </span>
<span id="cb1618-4"><a href="epicurves.html#cb1618-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tentative =</span> <span class="fu">case_when</span>(</span>
<span id="cb1618-5"><a href="epicurves.html#cb1618-5" aria-hidden="true" tabindex="-1"></a>    date_onset <span class="sc">&gt;=</span> <span class="fu">max</span>(date_onset, <span class="at">na.rm=</span>T) <span class="sc">-</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">&quot;Tentative&quot;</span>, <span class="co"># tenative si dans les 7 derniers jours</span></span>
<span id="cb1618-6"><a href="epicurves.html#cb1618-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Reliable&quot;</span>)) <span class="co"># tout le reste est fiable</span></span>
<span id="cb1618-7"><a href="epicurves.html#cb1618-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1618-8"><a href="epicurves.html#cb1618-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tracé</span></span>
<span id="cb1618-9"><a href="epicurves.html#cb1618-9" aria-hidden="true" tabindex="-1"></a><span class="do">######</span></span>
<span id="cb1618-10"><a href="epicurves.html#cb1618-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> date_onset, <span class="at">fill =</span> tentative)) <span class="sc">+</span> </span>
<span id="cb1618-11"><a href="epicurves.html#cb1618-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1618-12"><a href="epicurves.html#cb1618-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># histogramme</span></span>
<span id="cb1618-13"><a href="epicurves.html#cb1618-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1618-14"><a href="epicurves.html#cb1618-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_central, <span class="co"># vecteur de données prédéfini, voir en haut de la page ggplot</span></span>
<span id="cb1618-15"><a href="epicurves.html#cb1618-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1618-16"><a href="epicurves.html#cb1618-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1618-17"><a href="epicurves.html#cb1618-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># échelles</span></span>
<span id="cb1618-18"><a href="epicurves.html#cb1618-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb1618-19"><a href="epicurves.html#cb1618-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;grey&quot;</span>))<span class="sc">+</span></span>
<span id="cb1618-20"><a href="epicurves.html#cb1618-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1618-21"><a href="epicurves.html#cb1618-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="co"># Supprimez l&#39;espace excédentaire de l&#39;axe des x sous et aprés les barres de cas</span></span>
<span id="cb1618-22"><a href="epicurves.html#cb1618-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">&quot;3 weeks&quot;</span>, <span class="co"># Lundi toutes les 3 semaines</span></span>
<span id="cb1618-23"><a href="epicurves.html#cb1618-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_minor_breaks =</span> <span class="st">&quot;week&quot;</span>, <span class="co"># lundi semaines </span></span>
<span id="cb1618-24"><a href="epicurves.html#cb1618-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">%b</span><span class="sc">\n</span><span class="st">&#39;%y&quot;</span>)<span class="sc">+</span> <span class="co"># format des étiquettes</span></span>
<span id="cb1618-25"><a href="epicurves.html#cb1618-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1618-26"><a href="epicurves.html#cb1618-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes et theme</span></span>
<span id="cb1618-27"><a href="epicurves.html#cb1618-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Afficher les jours de déclaration provisoire&quot;</span>,</span>
<span id="cb1618-28"><a href="epicurves.html#cb1618-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span> </span>
<span id="cb1618-29"><a href="epicurves.html#cb1618-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb1618-30"><a href="epicurves.html#cb1618-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="co"># supprimer le titre de la légende</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1204-1.png" width="672" /></p>
</div>
</div>
<div id="étiquettes-de-date-à-plusieurs-niveaux" class="section level2" number="33.5">
<h2><span class="header-section-number">33.5</span> Étiquettes de date à plusieurs niveaux</h2>
<p>Si vous voulez des étiquettes de date à plusieurs niveaux (par exemple, le mois et l’année) <em>sans dupliquer les niveaux d’étiquette inférieurs</em>, envisagez l’une des approches ci-dessous :</p>
<p>Rappelez-vous - vous pouvez utiliser des outils comme <code>\n</code> <em>avec</em> les arguments <code>date_labels</code> ou <code>labels</code> pour mettre des parties de chaque étiquette sur une nouvelle ligne en dessous. Cependant, le code ci-dessous vous aide à prendre les années ou les mois (par exemple) sur une ligne inférieure <em>et seulement une fois</em>. Quelques notes sur le code ci-dessous :</p>
<ul>
<li>Le nombre de cas est agrégé en semaines pour des raisons esthétiques. Voir la page Epicurves (onglet données agrégées) pour plus de détails.<br />
</li>
<li>Une ligne <code>geom_area()</code> est utilisée au lieu d’un histogramme, car l’approche par facettes ci-dessous ne fonctionne pas bien avec les histogrammes.</li>
</ul>
<p><strong>Aggréger en comptages hebdomadaires</strong></p>
<div class="sourceCode" id="cb1619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1619-1"><a href="epicurves.html#cb1619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># créez un ensemble de données sur le nombre de cas par semaine.</span></span>
<span id="cb1619-2"><a href="epicurves.html#cb1619-2" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################</span></span>
<span id="cb1619-3"><a href="epicurves.html#cb1619-3" aria-hidden="true" tabindex="-1"></a>central_weekly <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span></span>
<span id="cb1619-4"><a href="epicurves.html#cb1619-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hospital <span class="sc">==</span> <span class="st">&quot;Central Hospital&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># Filtrer linelist</span></span>
<span id="cb1619-5"><a href="epicurves.html#cb1619-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> lubridate<span class="sc">::</span><span class="fu">floor_date</span>(date_onset, <span class="at">unit =</span> <span class="st">&quot;weeks&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># count(week) %&gt;% # count(week)  </span></span>
<span id="cb1619-6"><a href="epicurves.html#cb1619-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(week) <span class="sc">%&gt;%</span> <span class="co"># résume le nombre de cas hebdomadaires</span></span>
<span id="cb1619-7"><a href="epicurves.html#cb1619-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(week) <span class="sc">%&gt;%</span> <span class="co"># Suppression des cas dont la date d&#39;apparition est manquante</span></span>
<span id="cb1619-8"><a href="epicurves.html#cb1619-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>( <span class="co"># remplir toutes les semaines où aucun cas n&#39;a été signalé</span></span>
<span id="cb1619-9"><a href="epicurves.html#cb1619-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">seq.Date</span>(</span>
<span id="cb1619-10"><a href="epicurves.html#cb1619-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="fu">min</span>(week),   </span>
<span id="cb1619-11"><a href="epicurves.html#cb1619-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">to =</span> <span class="fu">max</span>(week),</span>
<span id="cb1619-12"><a href="epicurves.html#cb1619-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">&quot;week&quot;</span>),</span>
<span id="cb1619-13"><a href="epicurves.html#cb1619-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>))                        <span class="co"># convertir les nouvelles valeurs NA en comptage 0</span></span></code></pre></div>
<p><strong>Faire des graphiques</strong></p>
<div class="sourceCode" id="cb1620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1620-1"><a href="epicurves.html#cb1620-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tracer avec une bordure de boîte sur l&#39;année</span></span>
<span id="cb1620-2"><a href="epicurves.html#cb1620-2" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb1620-3"><a href="epicurves.html#cb1620-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_weekly) <span class="sc">+</span></span>
<span id="cb1620-4"><a href="epicurves.html#cb1620-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> n), <span class="co"># faire une ligne, spécifier x et y</span></span>
<span id="cb1620-5"><a href="epicurves.html#cb1620-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> <span class="co"># car la hauteur de la ligne est un nombre compté</span></span>
<span id="cb1620-6"><a href="epicurves.html#cb1620-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels=</span><span class="st">&quot;%b&quot;</span>, <span class="co"># le format des étiquettes de date montre le mois </span></span>
<span id="cb1620-7"><a href="epicurves.html#cb1620-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks=</span><span class="st">&quot;month&quot;</span>, <span class="co"># étiquettes de date au 1er de chaque mois</span></span>
<span id="cb1620-8"><a href="epicurves.html#cb1620-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire à chaque extrémité</span></span>
<span id="cb1620-9"><a href="epicurves.html#cb1620-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1620-10"><a href="epicurves.html#cb1620-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># Suppression de l&#39;espace excédentaire sous l&#39;axe des x</span></span>
<span id="cb1620-11"><a href="epicurves.html#cb1620-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>lubridate<span class="sc">::</span><span class="fu">year</span>(week), <span class="co"># facette sur l&#39;année (de la colonne de la classe Date)</span></span>
<span id="cb1620-12"><a href="epicurves.html#cb1620-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">space=</span><span class="st">&quot;free_x&quot;</span>,                </span>
<span id="cb1620-13"><a href="epicurves.html#cb1620-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>, <span class="co"># les axes x s&#39;adaptent à la plage de données (pas &quot;fixe&quot;)</span></span>
<span id="cb1620-14"><a href="epicurves.html#cb1620-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">switch=</span><span class="st">&quot;x&quot;</span>) <span class="sc">+</span> <span class="co"># étiquettes des facettes (année) en bas de page</span></span>
<span id="cb1620-15"><a href="epicurves.html#cb1620-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1620-16"><a href="epicurves.html#cb1620-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>, <span class="co"># placement des étiquettes de facettes</span></span>
<span id="cb1620-17"><a href="epicurves.html#cb1620-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="co"># facet labels no fill grey border</span></span>
<span id="cb1620-18"><a href="epicurves.html#cb1620-18" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>),</span>
<span id="cb1620-19"><a href="epicurves.html#cb1620-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span> <span class="co"># pas d&#39;espace entre les panneaux de facettes</span></span>
<span id="cb1620-20"><a href="epicurves.html#cb1620-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Étiquettes d&#39;année imbriquées, bordure d&#39;étiquette grise&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1206-1.png" width="672" /></p>
<div class="sourceCode" id="cb1621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1621-1"><a href="epicurves.html#cb1621-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tracé sans bordure sur l&#39;année</span></span>
<span id="cb1621-2"><a href="epicurves.html#cb1621-2" aria-hidden="true" tabindex="-1"></a><span class="do">#################################</span></span>
<span id="cb1621-3"><a href="epicurves.html#cb1621-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(central_weekly,</span>
<span id="cb1621-4"><a href="epicurves.html#cb1621-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> n)) <span class="sc">+</span> <span class="co"># établir x et y pour tout le graphique</span></span>
<span id="cb1621-5"><a href="epicurves.html#cb1621-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="co"># créer une ligne, la hauteur de la ligne est le nombre de comptage</span></span>
<span id="cb1621-6"><a href="epicurves.html#cb1621-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;#69b3a2&quot;</span>) <span class="sc">+</span> <span class="co"># couleur de la ligne</span></span>
<span id="cb1621-7"><a href="epicurves.html#cb1621-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;#69b3a2&quot;</span>) <span class="sc">+</span> <span class="co"># faire des points aux points de données hebdomadaires</span></span>
<span id="cb1621-8"><a href="epicurves.html#cb1621-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;#69b3a2&quot;</span>, <span class="co"># zone de remplissage sous la ligne</span></span>
<span id="cb1621-9"><a href="epicurves.html#cb1621-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.4</span>)<span class="sc">+</span> <span class="co"># transparence du remplissage</span></span>
<span id="cb1621-10"><a href="epicurves.html#cb1621-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels=</span><span class="st">&quot;%b&quot;</span>, <span class="co"># format de l&#39;étiquette de la date pour montrer le mois </span></span>
<span id="cb1621-11"><a href="epicurves.html#cb1621-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks=</span><span class="st">&quot;month&quot;</span>, <span class="co"># étiquettes de date au 1er de chaque mois</span></span>
<span id="cb1621-12"><a href="epicurves.html#cb1621-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># supprimer l&#39;espace excédentaire</span></span>
<span id="cb1621-13"><a href="epicurves.html#cb1621-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1621-14"><a href="epicurves.html#cb1621-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span> <span class="co"># suppression de l&#39;espace excédentaire sous l&#39;axe des x</span></span>
<span id="cb1621-15"><a href="epicurves.html#cb1621-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>lubridate<span class="sc">::</span><span class="fu">year</span>(week), <span class="co"># facette sur l&#39;année (de la colonne de la classe Date)</span></span>
<span id="cb1621-16"><a href="epicurves.html#cb1621-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">space=</span><span class="st">&quot;free_x&quot;</span>,                </span>
<span id="cb1621-17"><a href="epicurves.html#cb1621-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>, <span class="co"># les axes x s&#39;adaptent à la plage de données (pas &quot;fixe&quot;)</span></span>
<span id="cb1621-18"><a href="epicurves.html#cb1621-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">switch=</span><span class="st">&quot;x&quot;</span>) <span class="sc">+</span> <span class="co"># étiquettes des facettes (année) en bas de page</span></span>
<span id="cb1621-19"><a href="epicurves.html#cb1621-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1621-20"><a href="epicurves.html#cb1621-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>, <span class="co"># placement des étiquettes de facettes</span></span>
<span id="cb1621-21"><a href="epicurves.html#cb1621-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="co"># pas de fond d&#39;étiquette de facette</span></span>
<span id="cb1621-22"><a href="epicurves.html#cb1621-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),          </span>
<span id="cb1621-23"><a href="epicurves.html#cb1621-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;grey40&quot;</span>), <span class="co"># bordure grise du PANEL de la facette</span></span>
<span id="cb1621-24"><a href="epicurves.html#cb1621-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.spacing=</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span> <span class="co"># Pas d&#39;espace entre les panneaux à facettes</span></span>
<span id="cb1621-25"><a href="epicurves.html#cb1621-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Étiquettes annuelles imbriquées - points, ombrées, pas de bordure d&#39;étiquette&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1206-2.png" width="672" /></p>
<p>Les techniques ci-dessus ont été adaptées de <a href="https://stackoverflow.com/questions/44616530/axis-labels-on-two-lines-with-nested-x-variables-year-below-months">this</a> et <a href="https://stackoverflow.com/questions/20571306/multi-row-x-axis-labels-in-ggplot-line-chart">this</a> post sur stackoverflow.com.</p>
<!-- ======================================================= -->
</div>
<div id="double-axe" class="section level2" number="33.6">
<h2><span class="header-section-number">33.6</span> Double axe</h2>
<p>Bien qu’il y ait des discussions acharnées sur la validité des doubles axes au sein de la communauté de visualisation des données, de nombreux superviseurs d’épi veulent toujours voir une épicurve ou un graphique similaire avec un pourcentage superposé à un deuxiéme axe. Ce sujet est abordé plus en détail dans la page <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a>, mais un exemple utilisant la méthode <strong>cowplot</strong> est présenté ci-dessous :</p>
<ul>
<li>Deux graphiques distincts sont créés, puis combinés avec le paquet <strong>cowplot</strong>.<br />
</li>
<li>Les graphiques doivent avoir exactement le même axe des x (limites définies), sinon les données et les étiquettes ne seront pas alignées.<br />
</li>
<li>Chacun utilise <code>theme_cowplot()</code> et l’un d’entre eux a l’axe des y déplacé sur le côte droit du graphique</li>
</ul>
<div class="sourceCode" id="cb1622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1622-1"><a href="epicurves.html#cb1622-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Chargez le paquet</span></span>
<span id="cb1622-2"><a href="epicurves.html#cb1622-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(cowplot)</span>
<span id="cb1622-3"><a href="epicurves.html#cb1622-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1622-4"><a href="epicurves.html#cb1622-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Faire le premier tracé de l&#39;histogramme épicurve</span></span>
<span id="cb1622-5"><a href="epicurves.html#cb1622-5" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################</span></span>
<span id="cb1622-6"><a href="epicurves.html#cb1622-6" aria-hidden="true" tabindex="-1"></a>plot_cases <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1622-7"><a href="epicurves.html#cb1622-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-8"><a href="epicurves.html#cb1622-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tracer les cas par semaine</span></span>
<span id="cb1622-9"><a href="epicurves.html#cb1622-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1622-10"><a href="epicurves.html#cb1622-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-11"><a href="epicurves.html#cb1622-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># créer un histogramme  </span></span>
<span id="cb1622-12"><a href="epicurves.html#cb1622-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb1622-13"><a href="epicurves.html#cb1622-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1622-14"><a href="epicurves.html#cb1622-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1622-15"><a href="epicurves.html#cb1622-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1622-16"><a href="epicurves.html#cb1622-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bin breaks chaque semaine en commençant le lundi avant le premier cas, jusqu&#39;au lundi aprés le dernier cas</span></span>
<span id="cb1622-17"><a href="epicurves.html#cb1622-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> weekly_breaks_all)<span class="sc">+</span> <span class="co"># vecteur prédéfini de dates hebdomadaires (voir en haut de la section ggplot)</span></span>
<span id="cb1622-18"><a href="epicurves.html#cb1622-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1622-19"><a href="epicurves.html#cb1622-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spécifier le début et la fin de l&#39;axe des dates pour l&#39;aligner avec les autres graphiques</span></span>
<span id="cb1622-20"><a href="epicurves.html#cb1622-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1622-21"><a href="epicurves.html#cb1622-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(weekly_breaks_all), <span class="fu">max</span>(weekly_breaks_all)))<span class="sc">+</span> <span class="co"># min/max des pauses hebdomadaires prédéfinies de l&#39;histogramme</span></span>
<span id="cb1622-22"><a href="epicurves.html#cb1622-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-23"><a href="epicurves.html#cb1622-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquettes</span></span>
<span id="cb1622-24"><a href="epicurves.html#cb1622-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1622-25"><a href="epicurves.html#cb1622-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;Cas quotidiens&quot;</span>,</span>
<span id="cb1622-26"><a href="epicurves.html#cb1622-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;Date d&#39;apparition des symptômes&quot;</span></span>
<span id="cb1622-27"><a href="epicurves.html#cb1622-27" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb1622-28"><a href="epicurves.html#cb1622-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb1622-29"><a href="epicurves.html#cb1622-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1622-30"><a href="epicurves.html#cb1622-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1622-31"><a href="epicurves.html#cb1622-31" aria-hidden="true" tabindex="-1"></a><span class="co"># faire un second tracé du pourcentage de décés par semaine</span></span>
<span id="cb1622-32"><a href="epicurves.html#cb1622-32" aria-hidden="true" tabindex="-1"></a><span class="do">###########################################</span></span>
<span id="cb1622-33"><a href="epicurves.html#cb1622-33" aria-hidden="true" tabindex="-1"></a>plot_deaths <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> <span class="co"># commence avec linelist</span></span>
<span id="cb1622-34"><a href="epicurves.html#cb1622-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">week =</span> <span class="fu">floor_date</span>(date_onset, <span class="st">&quot;week&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># créer une colonne semaine</span></span>
<span id="cb1622-35"><a href="epicurves.html#cb1622-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-36"><a href="epicurves.html#cb1622-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># résumer pour obtenir le pourcentage hebdomadaire de cas décédés</span></span>
<span id="cb1622-37"><a href="epicurves.html#cb1622-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_cases =</span> <span class="fu">n</span>(),</span>
<span id="cb1622-38"><a href="epicurves.html#cb1622-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">died =</span> <span class="fu">sum</span>(outcome <span class="sc">==</span> <span class="st">&quot;Death&quot;</span>, <span class="at">na.rm=</span>T),</span>
<span id="cb1622-39"><a href="epicurves.html#cb1622-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">pct_died =</span> <span class="dv">100</span><span class="sc">*</span>died<span class="sc">/</span>n_cases) <span class="sc">%&gt;%</span> </span>
<span id="cb1622-40"><a href="epicurves.html#cb1622-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-41"><a href="epicurves.html#cb1622-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># commencer le tracé</span></span>
<span id="cb1622-42"><a href="epicurves.html#cb1622-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1622-43"><a href="epicurves.html#cb1622-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-44"><a href="epicurves.html#cb1622-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ligne du pourcentage hebdomadaire de décés</span></span>
<span id="cb1622-45"><a href="epicurves.html#cb1622-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="co"># créer une ligne de pourcentage de décés</span></span>
<span id="cb1622-46"><a href="epicurves.html#cb1622-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> pct_died), <span class="co"># spécifie la hauteur des y comme colonne pct_died</span></span>
<span id="cb1622-47"><a href="epicurves.html#cb1622-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="co"># fixer la hauteur de la ligne à la valeur de la colonne pct_death, et non au nombre de lignes (par défaut)</span></span>
<span id="cb1622-48"><a href="epicurves.html#cb1622-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1622-49"><a href="epicurves.html#cb1622-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb1622-50"><a href="epicurves.html#cb1622-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-51"><a href="epicurves.html#cb1622-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mêmes limites de l&#39;axe des dates que l&#39;autre graphique - alignement parfait</span></span>
<span id="cb1622-52"><a href="epicurves.html#cb1622-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb1622-53"><a href="epicurves.html#cb1622-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(weekly_breaks_all), <span class="fu">max</span>(weekly_breaks_all)))<span class="sc">+</span> <span class="co"># min/max des pauses hebdomadaires prédéfinies de l&#39;histogramme</span></span>
<span id="cb1622-54"><a href="epicurves.html#cb1622-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-55"><a href="epicurves.html#cb1622-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-56"><a href="epicurves.html#cb1622-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ajustements de l&#39;axe des y</span></span>
<span id="cb1622-57"><a href="epicurves.html#cb1622-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>( <span class="co"># ajuster l&#39;axe des y</span></span>
<span id="cb1622-58"><a href="epicurves.html#cb1622-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>, <span class="dv">10</span>), <span class="co"># définit les intervalles de rupture de l&#39;axe des pourcentages</span></span>
<span id="cb1622-59"><a href="epicurves.html#cb1622-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="co"># définit l&#39;étendue de l&#39;axe des pourcentages</span></span>
<span id="cb1622-60"><a href="epicurves.html#cb1622-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">&quot;right&quot;</span>)<span class="sc">+</span> <span class="co"># déplace l&#39;axe des pourcentages vers la droite</span></span>
<span id="cb1622-61"><a href="epicurves.html#cb1622-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-62"><a href="epicurves.html#cb1622-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># étiquette pour l&#39;axe des Y, pas d&#39;étiquette pour l&#39;axe des X</span></span>
<span id="cb1622-63"><a href="epicurves.html#cb1622-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb1622-64"><a href="epicurves.html#cb1622-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Pourcentage décédé&quot;</span>) <span class="sc">+</span>  <span class="co"># étiquette de l&#39;axe des pourcentages</span></span>
<span id="cb1622-65"><a href="epicurves.html#cb1622-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1622-66"><a href="epicurves.html#cb1622-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="co"># ajoutez ceci pour que les deux graphiques fusionnent bien ensemble</span></span></code></pre></div>
<p>Utilisez maintenant <strong>cowplot</strong> pour superposer les deux graphiques. Une attention particuliére a été portée à l’alignement de l’axe des x, au côte de l’axe des y et à l’utilisation de <code>theme_cowplot()</code>.</p>
<div class="sourceCode" id="cb1623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1623-1"><a href="epicurves.html#cb1623-1" aria-hidden="true" tabindex="-1"></a>aligned_plots <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">align_plots</span>(plot_cases, plot_deaths, <span class="at">align=</span><span class="st">&quot;hv&quot;</span>, <span class="at">axis=</span><span class="st">&quot;tblr&quot;</span>)</span>
<span id="cb1623-2"><a href="epicurves.html#cb1623-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1623-3"><a href="epicurves.html#cb1623-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdraw</span>(aligned_plots[[<span class="dv">1</span>]]) <span class="sc">+</span> <span class="fu">draw_plot</span>(aligned_plots[[<span class="dv">2</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1208-1.png" width="672" /></p>
</div>
<div id="incidence-cumulée-1" class="section level2" number="33.7">
<h2><span class="header-section-number">33.7</span> Incidence cumulée</h2>
<p>Note : Si vous utilisez <strong>incidence2</strong>, consultez la section sur la façon dont vous pouvez produire l’incidence cumulée avec une fonction simple. Cette page traitera de la façon de calculer l’incidence cumulée et de la tracer avec <code>ggplot()</code>.</p>
<p>Si vous commencez avec une liste de cas, créez une nouvelle colonne contenant le nombre cumulé de cas par jour dans une épidémie en utilisant <code>cumsum()</code> de <strong>base</strong> R :</p>
<div class="sourceCode" id="cb1624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1624-1"><a href="epicurves.html#cb1624-1" aria-hidden="true" tabindex="-1"></a>cumulative_case_counts <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1624-2"><a href="epicurves.html#cb1624-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date_onset) <span class="sc">%&gt;%</span> <span class="co"># nombre de lignes par jour (retourné dans la colonne &quot;n&quot;)   </span></span>
<span id="cb1624-3"><a href="epicurves.html#cb1624-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(                         </span>
<span id="cb1624-4"><a href="epicurves.html#cb1624-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_cases =</span> <span class="fu">cumsum</span>(n) <span class="co"># nouvelle colonne du nombre cumulé de lignes à chaque date</span></span>
<span id="cb1624-5"><a href="epicurves.html#cb1624-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>Les 10 premiéres lignes sont affichôes ci-dessous :</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e8f9d65cbf814e76d782" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e8f9d65cbf814e76d782">{"x":{"filter":"none","vertical":false,"data":[["2014-04-07","2014-04-15","2014-04-21","2014-04-25","2014-04-26","2014-04-27","2014-05-01","2014-05-03","2014-05-04","2014-05-05"],[1,1,2,1,1,1,2,1,1,1],[1,2,4,5,6,7,9,10,11,12]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>date_onset<\/th>\n      <th>n<\/th>\n      <th>cumulative_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Cette colonne cumulative peut ensuite étre tracée en fonction de la <code>date_onset</code>, en utilisant `geom_line()`` :</p>
<div class="sourceCode" id="cb1625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1625-1"><a href="epicurves.html#cb1625-1" aria-hidden="true" tabindex="-1"></a>plot_cumulative <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1625-2"><a href="epicurves.html#cb1625-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb1625-3"><a href="epicurves.html#cb1625-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> cumulative_case_counts,</span>
<span id="cb1625-4"><a href="epicurves.html#cb1625-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date_onset, <span class="at">y =</span> cumulative_cases),</span>
<span id="cb1625-5"><a href="epicurves.html#cb1625-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1625-6"><a href="epicurves.html#cb1625-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1625-7"><a href="epicurves.html#cb1625-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1625-8"><a href="epicurves.html#cb1625-8" aria-hidden="true" tabindex="-1"></a>plot_cumulative</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1211-1.png" width="672" /></p>
<p>On peut aussi le superposer à l’épicurve, avec un double axe en utilisant la méthode <strong>cowplot</strong> décrite ci-dessus et dans la page <a href="ggplot_tips.html#ggplot_tips">ggplot tips</a> :</p>
<div class="sourceCode" id="cb1626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1626-1"><a href="epicurves.html#cb1626-1" aria-hidden="true" tabindex="-1"></a><span class="co">#charger le paquet</span></span>
<span id="cb1626-2"><a href="epicurves.html#cb1626-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1626-3"><a href="epicurves.html#cb1626-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(cowplot)</span>
<span id="cb1626-4"><a href="epicurves.html#cb1626-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1626-5"><a href="epicurves.html#cb1626-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1626-6"><a href="epicurves.html#cb1626-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Faire le premier tracé de l&#39;histogramme épicurve</span></span>
<span id="cb1626-7"><a href="epicurves.html#cb1626-7" aria-hidden="true" tabindex="-1"></a>plot_cases <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1626-8"><a href="epicurves.html#cb1626-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(          </span>
<span id="cb1626-9"><a href="epicurves.html#cb1626-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> linelist,</span>
<span id="cb1626-10"><a href="epicurves.html#cb1626-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date_onset),</span>
<span id="cb1626-11"><a href="epicurves.html#cb1626-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb1626-12"><a href="epicurves.html#cb1626-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1626-13"><a href="epicurves.html#cb1626-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cas quotidiens&quot;</span>,</span>
<span id="cb1626-14"><a href="epicurves.html#cb1626-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Date d&#39;apparition des symptômes&quot;</span></span>
<span id="cb1626-15"><a href="epicurves.html#cb1626-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1626-16"><a href="epicurves.html#cb1626-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb1626-17"><a href="epicurves.html#cb1626-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1626-18"><a href="epicurves.html#cb1626-18" aria-hidden="true" tabindex="-1"></a><span class="co"># créer un second tracé de la ligne des cas cumulés</span></span>
<span id="cb1626-19"><a href="epicurves.html#cb1626-19" aria-hidden="true" tabindex="-1"></a>plot_cumulative <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1626-20"><a href="epicurves.html#cb1626-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb1626-21"><a href="epicurves.html#cb1626-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> cumulative_case_counts,</span>
<span id="cb1626-22"><a href="epicurves.html#cb1626-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> date_onset, <span class="at">y =</span> cumulative_cases),</span>
<span id="cb1626-23"><a href="epicurves.html#cb1626-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1626-24"><a href="epicurves.html#cb1626-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb1626-25"><a href="epicurves.html#cb1626-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1626-26"><a href="epicurves.html#cb1626-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">&quot;right&quot;</span>)<span class="sc">+</span></span>
<span id="cb1626-27"><a href="epicurves.html#cb1626-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb1626-28"><a href="epicurves.html#cb1626-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Cas cumulés&quot;</span>)<span class="sc">+</span></span>
<span id="cb1626-29"><a href="epicurves.html#cb1626-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()<span class="sc">+</span></span>
<span id="cb1626-30"><a href="epicurves.html#cb1626-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1626-31"><a href="epicurves.html#cb1626-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1626-32"><a href="epicurves.html#cb1626-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1626-33"><a href="epicurves.html#cb1626-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1626-34"><a href="epicurves.html#cb1626-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Utilisez maintenant <strong>cowplot</strong> pour superposer les deux graphiques. Une attention particuliére a été portée à l’alignement de l’axe des x, au côte de l’axe des y et à l’utilisation de <code>theme_cowplot()</code>.</p>
<div class="sourceCode" id="cb1627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1627-1"><a href="epicurves.html#cb1627-1" aria-hidden="true" tabindex="-1"></a>aligned_plots <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">align_plots</span>(plot_cases, plot_cumulative, <span class="at">align=</span><span class="st">&quot;hv&quot;</span>, <span class="at">axis=</span><span class="st">&quot;tblr&quot;</span>)</span>
<span id="cb1627-2"><a href="epicurves.html#cb1627-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1627-3"><a href="epicurves.html#cb1627-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdraw</span>(aligned_plots[[<span class="dv">1</span>]]) <span class="sc">+</span> <span class="fu">draw_plot</span>(aligned_plots[[<span class="dv">2</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1213-1.png" width="672" /></p>
<!-- ======================================================= -->
</div>
<div id="ressources-19" class="section level2" number="33.8">
<h2><span class="header-section-number">33.8</span> Ressources</h2>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2023-05-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
